2025-12-12 21:37:14,635 | INFO | === Expanding step: train_to_2023-05__test_2023-06 ===
2025-12-12 21:37:14,635 | INFO | Step out_dir: results/dh_ret/call-all/IBMCTINTERACTIONS/monthly/2023-06
2025-12-12 21:37:14,635 | INFO | train_end=2023-05 | test_month=2023-06
2025-12-12 21:37:14,635 | INFO | Split sizes: train=2609 | val=344 | test=579
2025-12-12 21:37:14,638 | INFO | [guardrails] transform=none
2025-12-12 21:37:14,639 | INFO | [guardrails] winsor z: lower_q=0.0100 (-1.58647), upper_q=0.9900 (5.67226)
2025-12-12 21:37:14,871 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-12 21:37:16,258 | INFO | [keep] ridge#1 score=-0.58094 params={'max_iter': np.int64(10000), 'alpha': 0.2628063327422689}
2025-12-12 21:37:16,262 | INFO | [keep] ridge#2 score=-0.58194 params={'max_iter': np.int64(10000), 'alpha': 0.2799608198487091}
2025-12-12 21:37:36,598 | INFO | [keep] lasso#1 score=0.00615 params={'max_iter': np.int64(10000), 'alpha': 0.6053082080079019}
2025-12-12 21:37:36,602 | INFO | [keep] lasso#2 score=0.00615 params={'max_iter': np.int64(10000), 'alpha': 0.35775015430826956}
2025-12-12 21:37:59,156 | INFO | [keep] elasticnet#1 score=0.01260 params={'max_iter': np.int64(10000), 'alpha': 0.8516144627787162, 'l1_ratio': 0.10204481074802807}
2025-12-12 21:37:59,160 | INFO | [keep] elasticnet#2 score=0.00615 params={'max_iter': np.int64(10000), 'alpha': 0.6053082080079019, 'l1_ratio': 0.3834415188257777}
2025-12-12 21:37:59,584 | INFO | [keep] pcr#1 score=-0.00413 params={'pca__n_components': 1, 'ridge__alpha': 1.0}
2025-12-12 21:37:59,590 | INFO | [keep] pcr#2 score=-0.00413 params={'pca__n_components': 1, 'ridge__alpha': 0.1}
2025-12-12 21:37:59,652 | INFO | [keep] pls#1 score=-0.16077 params={'n_components': 2}
2025-12-12 21:37:59,656 | INFO | [keep] pls#2 score=-0.26114 params={'n_components': 1}
2025-12-12 21:37:59,656 | INFO | Training FFN: ['ffn']
2025-12-12 21:40:55,239 | INFO | [keep] ffn#1 score=0.01738 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(512), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(0.5), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(20), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(0.5), 'ffn__dropout': 0.2428094914467595, 'ffn__weight_decay': 0.0001340004881783983}
2025-12-12 21:40:56,451 | INFO | [keep] ffn#2 score=0.01710 params={'ffn__activation': np.str_('gelu'), 'ffn__batch_size': np.int64(1024), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(0.5), 'ffn__learning_rate': np.float64(0.0003), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(0.5), 'ffn__dropout': 0.22894950226268457, 'ffn__weight_decay': 8.599203080926289e-06}
2025-12-12 21:40:56,451 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-12 21:45:23,809 | INFO | [keep] rf#1 score=0.02551 params={'bootstrap': True, 'max_depth': 12, 'max_features': 'log2', 'max_samples': 0.5, 'min_samples_leaf': 20, 'min_samples_split': 10, 'n_estimators': 600}
2025-12-12 21:45:24,320 | INFO | [keep] rf#2 score=0.02482 params={'bootstrap': True, 'max_depth': 12, 'max_features': 'sqrt', 'max_samples': 0.5, 'min_samples_leaf': 20, 'min_samples_split': 2, 'n_estimators': 600}
2025-12-12 21:45:34,588 | INFO | [keep] lgbm_gbdt#1 score=0.03273 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.01), 'max_bin': np.int64(127), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(800), 'num_leaves': np.int64(127), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 0.042444613236089244, 'reg_lambda': 0.0012073863726279688} | n_estimators(refit)=75
2025-12-12 21:45:34,897 | INFO | [keep] lgbm_gbdt#2 score=0.03105 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(1.0), 'learning_rate': np.float64(0.003), 'max_bin': np.int64(127), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(3000), 'num_leaves': np.int64(127), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 0.020030597244341114, 'reg_lambda': 3.0923976246969617e-06} | n_estimators(refit)=248
2025-12-12 21:51:07,969 | INFO | [keep] lgbm_dart#1 score=0.02140 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.1), 'learning_rate': np.float64(0.003), 'max_bin': np.int64(127), 'max_depth': np.int64(3), 'max_drop': np.int64(10), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.1), 'min_split_gain': np.float64(0.0), 'n_estimators': np.int64(800), 'num_leaves': np.int64(31), 'skip_drop': np.float64(0.5), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 0.3483976898071592, 'reg_lambda': 0.005038072794440212}
2025-12-12 21:51:08,750 | INFO | [keep] lgbm_dart#2 score=0.02083 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.15), 'learning_rate': np.float64(0.003), 'max_bin': np.int64(127), 'max_depth': np.int64(3), 'max_drop': np.int64(50), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.001), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(1200), 'num_leaves': np.int64(127), 'skip_drop': np.float64(0.5), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 5.610854171574414e-06, 'reg_lambda': 0.013423416359865182}
