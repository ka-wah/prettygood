2025-12-12 21:09:45,958 | INFO | === Expanding step: train_to_2023-03__test_2023-04 ===
2025-12-12 21:09:45,958 | INFO | Step out_dir: results/dh_ret/put-all/IBMCTINTERACTIONS/monthly/2023-04
2025-12-12 21:09:45,958 | INFO | train_end=2023-03 | test_month=2023-04
2025-12-12 21:09:45,958 | INFO | Split sizes: train=2239 | val=446 | test=441
2025-12-12 21:09:45,961 | INFO | [guardrails] transform=none
2025-12-12 21:09:45,961 | INFO | [guardrails] winsor z: lower_q=0.0100 (-1.48547), upper_q=0.9900 (6.41397)
2025-12-12 21:09:46,183 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-12 21:09:47,254 | INFO | [keep] ridge#1 score=-0.38469 params={'max_iter': np.int64(10000), 'alpha': 8.291189979207587}
2025-12-12 21:09:47,258 | INFO | [keep] ridge#2 score=-0.39563 params={'max_iter': np.int64(10000), 'alpha': 7.08481306320402}
2025-12-12 21:10:00,143 | INFO | [keep] lasso#1 score=0.01162 params={'max_iter': np.int64(10000), 'alpha': 0.16598654663071272}
2025-12-12 21:10:00,147 | INFO | [keep] lasso#2 score=0.01161 params={'max_iter': np.int64(10000), 'alpha': 0.22420123713724424}
2025-12-12 21:10:14,815 | INFO | [keep] elasticnet#1 score=0.01182 params={'max_iter': np.int64(10000), 'alpha': 0.8750516426087294, 'l1_ratio': 0.21689698439847394}
2025-12-12 21:10:14,819 | INFO | [keep] elasticnet#2 score=0.01166 params={'max_iter': np.int64(10000), 'alpha': 0.40298045932583026, 'l1_ratio': 0.613965955965896}
2025-12-12 21:10:15,214 | INFO | [keep] pcr#1 score=0.00984 params={'pca__n_components': 5, 'ridge__alpha': 1.0}
2025-12-12 21:10:15,223 | INFO | [keep] pcr#2 score=0.00983 params={'pca__n_components': 5, 'ridge__alpha': 0.1}
2025-12-12 21:10:15,283 | INFO | [keep] pls#1 score=0.01135 params={'n_components': 1}
2025-12-12 21:10:15,288 | INFO | [keep] pls#2 score=-0.00222 params={'n_components': 2}
2025-12-12 21:10:15,288 | INFO | Training FFN: ['ffn']
2025-12-12 21:12:18,924 | INFO | [keep] ffn#1 score=0.02335 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(1024), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(2.0), 'ffn__learning_rate': np.float64(0.001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(2), 'ffn__patience': np.int64(20), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(0.5), 'ffn__dropout': 0.25471149252855324, 'ffn__weight_decay': 1.2586757923192073e-06}
2025-12-12 21:12:20,353 | INFO | [keep] ffn#2 score=0.02261 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(512), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(128), 'ffn__huber_delta': np.float64(2.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(1.0), 'ffn__dropout': 0.26414276677577864, 'ffn__weight_decay': 0.0005684684928527873}
2025-12-12 21:12:20,353 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-12 21:16:22,538 | INFO | [keep] rf#1 score=0.02319 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'log2', 'max_samples': 0.7, 'min_samples_leaf': 20, 'min_samples_split': 5, 'n_estimators': 600}
2025-12-12 21:16:22,980 | INFO | [keep] rf#2 score=0.02310 params={'bootstrap': True, 'max_depth': 12, 'max_features': 'log2', 'max_samples': 0.7, 'min_samples_leaf': 20, 'min_samples_split': 2, 'n_estimators': 600}
2025-12-12 21:16:33,088 | INFO | [keep] lgbm_gbdt#1 score=0.02738 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(2000), 'num_leaves': np.int64(63), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 4.266367845929973e-05, 'reg_lambda': 0.0033418888058123737} | n_estimators(refit)=123
2025-12-12 21:16:33,128 | INFO | [keep] lgbm_gbdt#2 score=0.02567 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(63), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(800), 'num_leaves': np.int64(63), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 0.01985005396378788, 'reg_lambda': 0.005616032613563234} | n_estimators(refit)=45
2025-12-12 21:20:56,494 | INFO | [keep] lgbm_dart#1 score=0.01748 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.15), 'learning_rate': np.float64(0.01), 'max_bin': np.int64(63), 'max_depth': np.int64(4), 'max_drop': np.int64(50), 'min_child_samples': np.int64(400), 'min_child_weight': np.float64(0.1), 'min_split_gain': np.float64(0.0), 'n_estimators': np.int64(3000), 'num_leaves': np.int64(63), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.0009294494253199153, 'reg_lambda': 6.468274888037312e-05}
2025-12-12 21:21:02,093 | INFO | [keep] lgbm_dart#2 score=0.01726 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.2), 'learning_rate': np.float64(0.005), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'max_drop': np.int64(10), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.001), 'min_split_gain': np.float64(0.0), 'n_estimators': np.int64(3000), 'num_leaves': np.int64(127), 'skip_drop': np.float64(0.1), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.06927184499120616, 'reg_lambda': 5.785303828922974e-06}
