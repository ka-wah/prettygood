2025-12-16 00:03:34,692 | INFO | Loaded data: 21203 rows, 157 cols
2025-12-16 00:03:34,727 | INFO | After contract filters: 11845 rows
2025-12-16 00:03:34,742 | INFO | [expanding] enabled=True | freq=M | min_train_months=38 | months_total=44
2025-12-16 00:03:34,742 | INFO | [weighting] Sample weights enabled. Column='mid_t', Clip=[10, 5000.0]
2025-12-16 00:03:34,756 | INFO | === Expanding step: train_to_2023-02__test_2023-03 ===
2025-12-16 00:03:34,762 | INFO | [guardrails] transform=none
2025-12-16 00:03:34,763 | INFO | [guardrails] winsor z: lower_q=0.0050 (-1.59898), upper_q=0.9950 (14.2388)
2025-12-16 00:03:35,244 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-16 00:03:37,402 | INFO | [keep] ridge#1 score=-0.15528 params={'max_iter': np.int64(10000), 'alpha': 92.28295957427436}
2025-12-16 00:03:37,413 | INFO | [keep] ridge#2 score=-0.16715 params={'max_iter': np.int64(10000), 'alpha': 86.26905220714896}
2025-12-16 00:03:44,665 | INFO | [keep] lasso#1 score=0.05300 params={'max_iter': np.int64(10000), 'alpha': 0.07126995609048578}
2025-12-16 00:03:44,677 | INFO | [keep] lasso#2 score=0.05298 params={'max_iter': np.int64(10000), 'alpha': 0.07092543214735832}
2025-12-16 00:03:53,546 | INFO | [keep] elasticnet#1 score=0.05439 params={'max_iter': np.int64(10000), 'alpha': 0.24048783359009335, 'l1_ratio': 0.2791397504483041}
2025-12-16 00:03:53,561 | INFO | [keep] elasticnet#2 score=0.05396 params={'max_iter': np.int64(10000), 'alpha': 0.14144221329282095, 'l1_ratio': 0.416847762245835}
2025-12-16 00:03:54,280 | INFO | [keep] pcr#1 score=0.05759 params={'pca__n_components': 5, 'ridge__alpha': 0.0001}
2025-12-16 00:03:54,293 | INFO | [keep] pcr#2 score=0.05759 params={'pca__n_components': 5, 'ridge__alpha': 0.001}
2025-12-16 00:03:54,417 | INFO | [keep] pls#1 score=0.07610 params={'n_components': 1}
2025-12-16 00:03:54,427 | INFO | [keep] pls#2 score=0.02875 params={'n_components': 2}
2025-12-16 00:03:54,428 | INFO | Training FFN: ['ffn']
2025-12-16 00:15:51,519 | INFO | [keep] ffn#1 score=0.07314 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(128), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.3312761633788077, 'ffn__weight_decay': 0.060749960734256966}
2025-12-16 00:15:56,598 | INFO | [keep] ffn#2 score=0.07314 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(128), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.3361090533668136, 'ffn__weight_decay': 0.011834731850968479}
2025-12-16 00:15:56,598 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-16 00:16:44,187 | INFO | [keep] rf#1 score=0.09021 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.8, 'min_samples_leaf': 20, 'n_estimators': 300}
2025-12-16 00:16:44,709 | INFO | [keep] rf#2 score=0.09001 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.6, 'min_samples_leaf': 50, 'n_estimators': 300}
2025-12-16 00:16:54,789 | INFO | [keep] lgbm_gbdt#1 score=0.10858 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'learning_rate': np.float64(0.05), 'max_bin': np.int64(63), 'max_depth': np.int64(4), 'min_child_samples': np.int64(100), 'n_estimators': np.int64(200), 'num_leaves': np.int64(7), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 6.074996073425697, 'reg_lambda': 8.459126528049378} | n_estimators(refit)=39
2025-12-16 00:16:54,822 | INFO | [keep] lgbm_gbdt#2 score=0.10597 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'learning_rate': np.float64(0.1), 'max_bin': np.int64(127), 'max_depth': np.int64(4), 'min_child_samples': np.int64(100), 'n_estimators': np.int64(200), 'num_leaves': np.int64(15), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.26593836708988355, 'reg_lambda': 0.2785392800820963} | n_estimators(refit)=18
2025-12-16 00:17:15,457 | INFO | [keep] lgbm_dart#1 score=0.10887 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'drop_rate': np.float64(0.3), 'learning_rate': np.float64(0.05), 'max_bin': np.int64(127), 'max_depth': np.int64(6), 'max_drop': np.int64(20), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.1), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'skip_drop': np.float64(0.3), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.11331543612010862, 'reg_lambda': 5.912295566997817}
2025-12-16 00:17:15,608 | INFO | [keep] lgbm_dart#2 score=0.10835 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'drop_rate': np.float64(0.3), 'learning_rate': np.float64(0.1), 'max_bin': np.int64(63), 'max_depth': np.int64(4), 'max_drop': np.int64(10), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.1), 'min_split_gain': np.float64(0.05), 'n_estimators': np.int64(200), 'num_leaves': np.int64(7), 'skip_drop': np.float64(0.3), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.3995287520709348, 'reg_lambda': 3.4846841139324187}
2025-12-16 00:17:15,608 | INFO | [pred] ridge#1: n=359 R2_OS=0.09483 mse=9.5675 mse0=10.5698 | y mean=0.809 std=3.15 | yhat mean=0.127 std=0.588 p1=-0.882 p99=1.62
2025-12-16 00:17:15,609 | INFO | [pred] ridge#1: |err| q99=17.0829  tail_n=4/359  tail_share_SSE=46.31%
2025-12-16 00:17:15,611 | INFO | [pred] ridge#1: per-day mse days=20 p50=0.545984 p90=42.247 p99=85.2523 max=88.8496
2025-12-16 00:17:15,611 | INFO | [pred] ridge#2: n=359 R2_OS=0.09618 mse=9.55324 mse0=10.5698 | y mean=0.809 std=3.15 | yhat mean=0.131 std=0.595 p1=-0.885 p99=1.64
2025-12-16 00:17:15,612 | INFO | [pred] ridge#2: |err| q99=17.0728  tail_n=4/359  tail_share_SSE=46.32%
2025-12-16 00:17:15,613 | INFO | [pred] ridge#2: per-day mse days=20 p50=0.555912 p90=42.1526 p99=85.2308 max=88.8579
2025-12-16 00:17:15,614 | INFO | [pred] lasso#1: n=359 R2_OS=0.05419 mse=9.99701 mse0=10.5698 | y mean=0.809 std=3.15 | yhat mean=0.194 std=0.165 p1=-0.121 p99=0.547
2025-12-16 00:17:15,614 | INFO | [pred] lasso#1: |err| q99=17.2478  tail_n=4/359  tail_share_SSE=47.57%
2025-12-16 00:17:15,616 | INFO | [pred] lasso#1: per-day mse days=20 p50=0.459924 p90=44.3816 p99=86.609 max=88.2824
2025-12-16 00:17:15,616 | INFO | [pred] lasso#2: n=359 R2_OS=0.05432 mse=9.99563 mse0=10.5698 | y mean=0.809 std=3.15 | yhat mean=0.194 std=0.166 p1=-0.122 p99=0.549
2025-12-16 00:17:15,616 | INFO | [pred] lasso#2: |err| q99=17.2465  tail_n=4/359  tail_share_SSE=47.57%
2025-12-16 00:17:15,618 | INFO | [pred] lasso#2: per-day mse days=20 p50=0.460036 p90=44.3735 p99=86.5945 max=88.2679
2025-12-16 00:17:15,619 | INFO | [pred] elasticnet#1: n=359 R2_OS=0.05163 mse=10.0241 mse0=10.5698 | y mean=0.809 std=3.15 | yhat mean=0.184 std=0.159 p1=-0.109 p99=0.536
2025-12-16 00:17:15,619 | INFO | [pred] elasticnet#1: |err| q99=17.266  tail_n=4/359  tail_share_SSE=47.54%
2025-12-16 00:17:15,620 | INFO | [pred] elasticnet#1: per-day mse days=20 p50=0.472003 p90=44.5161 p99=86.8102 max=88.4814
2025-12-16 00:17:15,621 | INFO | [pred] elasticnet#2: n=359 R2_OS=0.05599 mse=9.97797 mse0=10.5698 | y mean=0.809 std=3.15 | yhat mean=0.205 std=0.184 p1=-0.132 p99=0.636
2025-12-16 00:17:15,621 | INFO | [pred] elasticnet#2: |err| q99=17.2249  tail_n=4/359  tail_share_SSE=47.51%
2025-12-16 00:17:15,623 | INFO | [pred] elasticnet#2: per-day mse days=20 p50=0.474494 p90=44.2655 p99=86.2943 max=87.9713
2025-12-16 00:17:15,624 | INFO | [pred] pcr#1: n=359 R2_OS=0.07007 mse=9.82918 mse0=10.5698 | y mean=0.809 std=3.15 | yhat mean=0.24 std=0.265 p1=-0.333 p99=0.849
2025-12-16 00:17:15,624 | INFO | [pred] pcr#1: |err| q99=17.1969  tail_n=4/359  tail_share_SSE=47.62%
2025-12-16 00:17:15,625 | INFO | [pred] pcr#1: per-day mse days=20 p50=0.480779 p90=43.3313 p99=87.2515 max=89.6319
2025-12-16 00:17:15,626 | INFO | [pred] pcr#2: n=359 R2_OS=0.07007 mse=9.82918 mse0=10.5698 | y mean=0.809 std=3.15 | yhat mean=0.24 std=0.265 p1=-0.333 p99=0.849
2025-12-16 00:17:15,626 | INFO | [pred] pcr#2: |err| q99=17.1969  tail_n=4/359  tail_share_SSE=47.62%
2025-12-16 00:17:15,628 | INFO | [pred] pcr#2: per-day mse days=20 p50=0.480779 p90=43.3313 p99=87.2515 max=89.6319
2025-12-16 00:17:15,628 | INFO | [pred] pls#1: n=359 R2_OS=0.15133 mse=8.97029 mse0=10.5698 | y mean=0.809 std=3.15 | yhat mean=0.57 std=0.579 p1=-0.467 p99=1.91
2025-12-16 00:17:15,629 | INFO | [pred] pls#1: |err| q99=16.4282  tail_n=4/359  tail_share_SSE=47.58%
2025-12-16 00:17:15,630 | INFO | [pred] pls#1: per-day mse days=20 p50=0.801158 p90=37.9521 p99=80.3717 max=83.3519
2025-12-16 00:17:15,631 | INFO | [pred] pls#2: n=359 R2_OS=0.16794 mse=8.79469 mse0=10.5698 | y mean=0.809 std=3.15 | yhat mean=0.527 std=0.687 p1=-0.691 p99=2.11
2025-12-16 00:17:15,631 | INFO | [pred] pls#2: |err| q99=16.3272  tail_n=4/359  tail_share_SSE=47.56%
2025-12-16 00:17:15,633 | INFO | [pred] pls#2: per-day mse days=20 p50=0.871983 p90=37.1891 p99=79.3516 max=82.6448
2025-12-16 00:17:15,634 | INFO | [pred] L-En: n=359 R2_OS=0.09381 mse=9.57827 mse0=10.5698 | y mean=0.809 std=3.15 | yhat mean=0.261 std=0.35 p1=-0.301 p99=1.08
2025-12-16 00:17:15,634 | INFO | [pred] L-En: |err| q99=17.029  tail_n=4/359  tail_share_SSE=47.67%
2025-12-16 00:17:15,636 | INFO | [pred] L-En: per-day mse days=20 p50=0.45229 p90=42.2894 p99=85.0444 max=87.5732
2025-12-16 00:17:15,639 | INFO | [pred] ffn#1: n=359 R2_OS=0.15866 mse=8.89279 mse0=10.5698 | y mean=0.809 std=3.15 | yhat mean=0.541 std=0.73 p1=-0.583 p99=2.3
2025-12-16 00:17:15,639 | INFO | [pred] ffn#1: |err| q99=16.4297  tail_n=4/359  tail_share_SSE=46.39%
2025-12-16 00:17:15,641 | INFO | [pred] ffn#1: per-day mse days=20 p50=1.0745 p90=38.0504 p99=78.5707 max=81.9773
2025-12-16 00:17:15,643 | INFO | [pred] ffn#2: n=359 R2_OS=0.15833 mse=8.89632 mse0=10.5698 | y mean=0.809 std=3.15 | yhat mean=0.543 std=0.731 p1=-0.586 p99=2.3
2025-12-16 00:17:15,643 | INFO | [pred] ffn#2: |err| q99=16.4288  tail_n=4/359  tail_share_SSE=46.37%
2025-12-16 00:17:15,645 | INFO | [pred] ffn#2: per-day mse days=20 p50=1.08112 p90=38.0508 p99=78.5621 max=81.9627
2025-12-16 00:17:15,679 | INFO | [pred] rf#1: n=359 R2_OS=0.16659 mse=8.80897 mse0=10.5698 | y mean=0.809 std=3.15 | yhat mean=0.588 std=0.678 p1=-0.128 p99=2.2
2025-12-16 00:17:15,679 | INFO | [pred] rf#1: |err| q99=15.9938  tail_n=4/359  tail_share_SSE=47.83%
2025-12-16 00:17:15,681 | INFO | [pred] rf#1: per-day mse days=20 p50=1.14558 p90=35.5089 p99=80.1445 max=82.9024
2025-12-16 00:17:15,714 | INFO | [pred] rf#2: n=359 R2_OS=0.15193 mse=8.96394 mse0=10.5698 | y mean=0.809 std=3.15 | yhat mean=0.5 std=0.532 p1=-0.141 p99=1.86
2025-12-16 00:17:15,714 | INFO | [pred] rf#2: |err| q99=16.4617  tail_n=4/359  tail_share_SSE=47.66%
2025-12-16 00:17:15,717 | INFO | [pred] rf#2: per-day mse days=20 p50=0.757157 p90=38.0313 p99=82.112 max=85.1562
2025-12-16 00:17:15,718 | INFO | [pred] lgbm_gbdt#1: n=359 R2_OS=0.12415 mse=9.25757 mse0=10.5698 | y mean=0.809 std=3.15 | yhat mean=0.356 std=0.485 p1=-0.138 p99=1.58
2025-12-16 00:17:15,718 | INFO | [pred] lgbm_gbdt#1: |err| q99=16.6611  tail_n=4/359  tail_share_SSE=47.51%
2025-12-16 00:17:15,720 | INFO | [pred] lgbm_gbdt#1: per-day mse days=20 p50=0.580936 p90=40.8186 p99=81.8471 max=84.2465
2025-12-16 00:17:15,721 | INFO | [pred] lgbm_gbdt#2: n=359 R2_OS=0.13661 mse=9.12583 mse0=10.5698 | y mean=0.809 std=3.15 | yhat mean=0.402 std=0.628 p1=-0.156 p99=2.37
2025-12-16 00:17:15,721 | INFO | [pred] lgbm_gbdt#2: |err| q99=16.7582  tail_n=4/359  tail_share_SSE=45.77%
2025-12-16 00:17:15,723 | INFO | [pred] lgbm_gbdt#2: per-day mse days=20 p50=0.825105 p90=40.9541 p99=82.2265 max=85.8414
2025-12-16 00:17:15,725 | INFO | [pred] lgbm_dart#1: n=359 R2_OS=0.15343 mse=8.94809 mse0=10.5698 | y mean=0.809 std=3.15 | yhat mean=0.429 std=0.53 p1=-0.154 p99=1.95
2025-12-16 00:17:15,725 | INFO | [pred] lgbm_dart#1: |err| q99=16.4509  tail_n=4/359  tail_share_SSE=48.04%
2025-12-16 00:17:15,727 | INFO | [pred] lgbm_dart#1: per-day mse days=20 p50=0.64388 p90=38.5677 p99=81.3338 max=84.2231
2025-12-16 00:17:15,728 | INFO | [pred] lgbm_dart#2: n=359 R2_OS=0.16820 mse=8.79194 mse0=10.5698 | y mean=0.809 std=3.15 | yhat mean=0.399 std=0.595 p1=-0.263 p99=2.34
2025-12-16 00:17:15,728 | INFO | [pred] lgbm_dart#2: |err| q99=16.0847  tail_n=4/359  tail_share_SSE=47.63%
2025-12-16 00:17:15,730 | INFO | [pred] lgbm_dart#2: per-day mse days=20 p50=0.816621 p90=36.9696 p99=79.5916 max=82.5729
2025-12-16 00:17:33,721 | INFO | === Expanding step: train_to_2023-03__test_2023-04 ===
2025-12-16 00:17:33,727 | INFO | [guardrails] transform=none
2025-12-16 00:17:33,728 | INFO | [guardrails] winsor z: lower_q=0.0050 (-1.65553), upper_q=0.9950 (14.1301)
2025-12-16 00:17:34,215 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-16 00:17:36,602 | INFO | [keep] ridge#1 score=-0.01800 params={'max_iter': np.int64(10000), 'alpha': 92.28295957427436}
2025-12-16 00:17:36,613 | INFO | [keep] ridge#2 score=-0.02072 params={'max_iter': np.int64(10000), 'alpha': 86.26905220714896}
2025-12-16 00:17:44,327 | INFO | [keep] lasso#1 score=0.03833 params={'max_iter': np.int64(10000), 'alpha': 0.09310837957239837}
2025-12-16 00:17:44,339 | INFO | [keep] lasso#2 score=0.03831 params={'max_iter': np.int64(10000), 'alpha': 0.09105944026265275}
2025-12-16 00:17:53,481 | INFO | [keep] elasticnet#1 score=0.04156 params={'max_iter': np.int64(10000), 'alpha': 0.24048783359009335, 'l1_ratio': 0.2791397504483041}
2025-12-16 00:17:53,491 | INFO | [keep] elasticnet#2 score=0.04047 params={'max_iter': np.int64(10000), 'alpha': 0.3904512502173691, 'l1_ratio': 0.19402548476962647}
2025-12-16 00:17:54,179 | INFO | [keep] pcr#1 score=0.05050 params={'pca__n_components': 5, 'ridge__alpha': 1.0}
2025-12-16 00:17:54,192 | INFO | [keep] pcr#2 score=0.05049 params={'pca__n_components': 5, 'ridge__alpha': 0.1}
2025-12-16 00:17:54,322 | INFO | [keep] pls#1 score=-0.02314 params={'n_components': 1}
2025-12-16 00:17:54,333 | INFO | [keep] pls#2 score=-0.02579 params={'n_components': 2}
2025-12-16 00:17:54,333 | INFO | Training FFN: ['ffn']
2025-12-16 00:40:49,302 | INFO | [keep] ffn#1 score=0.07718 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(128), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(32), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.468615765286463, 'ffn__weight_decay': 0.08621629256846254}
2025-12-16 00:40:53,713 | INFO | [keep] ffn#2 score=0.07670 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(64), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(32), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.4444899438110742, 'ffn__weight_decay': 0.09353687477155576}
2025-12-16 00:40:53,713 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-16 00:41:40,998 | INFO | [keep] rf#1 score=0.07045 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'log2', 'max_samples': 0.6, 'min_samples_leaf': 50, 'n_estimators': 200}
2025-12-16 00:41:41,311 | INFO | [keep] rf#2 score=0.07015 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'log2', 'max_samples': 0.8, 'min_samples_leaf': 100, 'n_estimators': 200}
2025-12-16 00:41:51,331 | INFO | [keep] lgbm_gbdt#1 score=0.10721 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'learning_rate': np.float64(0.1), 'max_bin': np.int64(127), 'max_depth': np.int64(4), 'min_child_samples': np.int64(100), 'n_estimators': np.int64(200), 'num_leaves': np.int64(15), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.26593836708988355, 'reg_lambda': 0.2785392800820963} | n_estimators(refit)=11
2025-12-16 00:41:51,396 | INFO | [keep] lgbm_gbdt#2 score=0.10641 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(127), 'max_depth': np.int64(4), 'min_child_samples': np.int64(100), 'n_estimators': np.int64(100), 'num_leaves': np.int64(15), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.19782524938981258, 'reg_lambda': 9.197266687466417} | n_estimators(refit)=76
2025-12-16 00:42:12,834 | INFO | [keep] lgbm_dart#1 score=0.10373 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'drop_rate': np.float64(0.2), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(127), 'max_depth': np.int64(6), 'max_drop': np.int64(10), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.01), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 1.994638447276318, 'reg_lambda': 18.54898207761947}
2025-12-16 00:42:13,010 | INFO | [keep] lgbm_dart#2 score=0.10105 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'drop_rate': np.float64(0.5), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(127), 'max_depth': np.int64(4), 'max_drop': np.int64(10), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.01), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(200), 'num_leaves': np.int64(15), 'skip_drop': np.float64(0.3), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.2060078009532491, 'reg_lambda': 1.110268368861318}
2025-12-16 00:42:13,011 | INFO | [pred] ridge#1: n=261 R2_OS=0.09714 mse=6.17169 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.0731 std=0.455 p1=-0.679 p99=1.31
2025-12-16 00:42:13,011 | INFO | [pred] ridge#1: |err| q99=12.8747  tail_n=3/261  tail_share_SSE=58.05%
2025-12-16 00:42:13,013 | INFO | [pred] ridge#1: per-day mse days=19 p50=0.410528 p90=16.4621 p99=50.0415 max=56.0131
2025-12-16 00:42:13,014 | INFO | [pred] ridge#2: n=261 R2_OS=0.09820 mse=6.1644 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.0741 std=0.461 p1=-0.684 p99=1.33
2025-12-16 00:42:13,014 | INFO | [pred] ridge#2: |err| q99=12.8703  tail_n=3/261  tail_share_SSE=58.05%
2025-12-16 00:42:13,016 | INFO | [pred] ridge#2: per-day mse days=19 p50=0.419251 p90=16.4285 p99=50.0426 max=56.0318
2025-12-16 00:42:13,016 | INFO | [pred] lasso#1: n=261 R2_OS=0.04055 mse=6.5585 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.138 std=0.115 p1=-0.0833 p99=0.37
2025-12-16 00:42:13,016 | INFO | [pred] lasso#1: |err| q99=13.2967  tail_n=3/261  tail_share_SSE=56.71%
2025-12-16 00:42:13,018 | INFO | [pred] lasso#1: per-day mse days=19 p50=0.562385 p90=18.18 p99=49.2264 max=54.3927
2025-12-16 00:42:13,018 | INFO | [pred] lasso#2: n=261 R2_OS=0.04164 mse=6.55105 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.142 std=0.119 p1=-0.0848 p99=0.381
2025-12-16 00:42:13,019 | INFO | [pred] lasso#2: |err| q99=13.2874  tail_n=3/261  tail_share_SSE=56.73%
2025-12-16 00:42:13,020 | INFO | [pred] lasso#2: per-day mse days=19 p50=0.571605 p90=18.153 p99=49.1728 max=54.3344
2025-12-16 00:42:13,021 | INFO | [pred] elasticnet#1: n=261 R2_OS=0.04903 mse=6.50052 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.166 std=0.142 p1=-0.0968 p99=0.441
2025-12-16 00:42:13,021 | INFO | [pred] elasticnet#1: |err| q99=13.2284  tail_n=3/261  tail_share_SSE=56.87%
2025-12-16 00:42:13,023 | INFO | [pred] elasticnet#1: per-day mse days=19 p50=0.627436 p90=17.9507 p99=48.8995 max=54.0388
2025-12-16 00:42:13,023 | INFO | [pred] elasticnet#2: n=261 R2_OS=0.04274 mse=6.54355 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.145 std=0.12 p1=-0.0772 p99=0.392
2025-12-16 00:42:13,023 | INFO | [pred] elasticnet#2: |err| q99=13.2767  tail_n=3/261  tail_share_SSE=56.76%
2025-12-16 00:42:13,025 | INFO | [pred] elasticnet#2: per-day mse days=19 p50=0.583541 p90=18.1124 p99=49.2063 max=54.3832
2025-12-16 00:42:13,026 | INFO | [pred] pcr#1: n=261 R2_OS=0.06314 mse=6.40405 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.198 std=0.217 p1=-0.259 p99=0.745
2025-12-16 00:42:13,026 | INFO | [pred] pcr#1: |err| q99=13.008  tail_n=3/261  tail_share_SSE=56.81%
2025-12-16 00:42:13,027 | INFO | [pred] pcr#1: per-day mse days=19 p50=0.548086 p90=17.3016 p99=48.6344 max=53.8654
2025-12-16 00:42:13,028 | INFO | [pred] pcr#2: n=261 R2_OS=0.06315 mse=6.40404 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.198 std=0.217 p1=-0.259 p99=0.745
2025-12-16 00:42:13,028 | INFO | [pred] pcr#2: |err| q99=13.008  tail_n=3/261  tail_share_SSE=56.81%
2025-12-16 00:42:13,030 | INFO | [pred] pcr#2: per-day mse days=19 p50=0.548083 p90=17.3015 p99=48.6343 max=53.8653
2025-12-16 00:42:13,030 | INFO | [pred] pls#1: n=261 R2_OS=0.10274 mse=6.13337 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.511 std=0.526 p1=-0.549 p99=1.72
2025-12-16 00:42:13,031 | INFO | [pred] pls#1: |err| q99=12.5034  tail_n=3/261  tail_share_SSE=55.74%
2025-12-16 00:42:13,032 | INFO | [pred] pls#1: per-day mse days=19 p50=1.28753 p90=17.536 p99=44.7111 max=49.6166
2025-12-16 00:42:13,033 | INFO | [pred] pls#2: n=261 R2_OS=0.10332 mse=6.1294 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.389 std=0.618 p1=-0.822 p99=1.77
2025-12-16 00:42:13,033 | INFO | [pred] pls#2: |err| q99=12.4705  tail_n=3/261  tail_share_SSE=56.49%
2025-12-16 00:42:13,034 | INFO | [pred] pls#2: per-day mse days=19 p50=1.27945 p90=17.8301 p99=46.0224 max=51.1777
2025-12-16 00:42:13,036 | INFO | [pred] L-En: n=261 R2_OS=0.07884 mse=6.29678 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.203 std=0.286 p1=-0.347 p99=0.872
2025-12-16 00:42:13,036 | INFO | [pred] L-En: |err| q99=12.9093  tail_n=3/261  tail_share_SSE=57.42%
2025-12-16 00:42:13,038 | INFO | [pred] L-En: per-day mse days=19 p50=0.385962 p90=17.0715 p99=48.4042 max=53.7168
2025-12-16 00:42:13,040 | INFO | [pred] ffn#1: n=261 R2_OS=0.08288 mse=6.26912 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.289 std=0.488 p1=-0.381 p99=1.64
2025-12-16 00:42:13,040 | INFO | [pred] ffn#1: |err| q99=12.7885  tail_n=3/261  tail_share_SSE=56.75%
2025-12-16 00:42:13,042 | INFO | [pred] ffn#1: per-day mse days=19 p50=0.979659 p90=17.5937 p99=46.9347 max=51.9417
2025-12-16 00:42:13,045 | INFO | [pred] ffn#2: n=261 R2_OS=0.05150 mse=6.48362 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.151 std=0.295 p1=-0.271 p99=1
2025-12-16 00:42:13,045 | INFO | [pred] ffn#2: |err| q99=13.2085  tail_n=3/261  tail_share_SSE=56.81%
2025-12-16 00:42:13,047 | INFO | [pred] ffn#2: per-day mse days=19 p50=0.477616 p90=17.6967 p99=47.9756 max=52.8971
2025-12-16 00:42:13,070 | INFO | [pred] rf#1: n=261 R2_OS=0.09863 mse=6.16145 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.436 std=0.533 p1=-0.149 p99=1.84
2025-12-16 00:42:13,070 | INFO | [pred] rf#1: |err| q99=12.4024  tail_n=3/261  tail_share_SSE=56.02%
2025-12-16 00:42:13,072 | INFO | [pred] rf#1: per-day mse days=19 p50=1.40136 p90=17.2539 p99=47.1268 max=52.5676
2025-12-16 00:42:13,095 | INFO | [pred] rf#2: n=261 R2_OS=0.09619 mse=6.17818 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.36 std=0.446 p1=-0.145 p99=1.45
2025-12-16 00:42:13,095 | INFO | [pred] rf#2: |err| q99=12.5708  tail_n=3/261  tail_share_SSE=56.67%
2025-12-16 00:42:13,097 | INFO | [pred] rf#2: per-day mse days=19 p50=1.00696 p90=16.4298 p99=47.1541 max=52.3598
2025-12-16 00:42:13,098 | INFO | [pred] lgbm_gbdt#1: n=261 R2_OS=0.08395 mse=6.2618 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.385 std=0.608 p1=-0.0638 p99=2.25
2025-12-16 00:42:13,098 | INFO | [pred] lgbm_gbdt#1: |err| q99=12.4958  tail_n=3/261  tail_share_SSE=56.00%
2025-12-16 00:42:13,100 | INFO | [pred] lgbm_gbdt#1: per-day mse days=19 p50=1.29261 p90=19.2831 p99=46.5415 max=51.5841
2025-12-16 00:42:13,101 | INFO | [pred] lgbm_gbdt#2: n=261 R2_OS=0.09503 mse=6.18608 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.335 std=0.539 p1=-0.113 p99=2.1
2025-12-16 00:42:13,101 | INFO | [pred] lgbm_gbdt#2: |err| q99=12.6518  tail_n=3/261  tail_share_SSE=57.04%
2025-12-16 00:42:13,103 | INFO | [pred] lgbm_gbdt#2: per-day mse days=19 p50=0.989486 p90=16.4999 p99=46.5089 max=51.3598
2025-12-16 00:42:13,104 | INFO | [pred] lgbm_dart#1: n=261 R2_OS=0.09358 mse=6.19602 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.276 std=0.446 p1=-0.179 p99=1.49
2025-12-16 00:42:13,104 | INFO | [pred] lgbm_dart#1: |err| q99=12.7238  tail_n=3/261  tail_share_SSE=57.41%
2025-12-16 00:42:13,106 | INFO | [pred] lgbm_dart#1: per-day mse days=19 p50=0.962686 p90=16.8358 p99=47.5286 max=52.5969
2025-12-16 00:42:13,107 | INFO | [pred] lgbm_dart#2: n=261 R2_OS=0.10922 mse=6.08907 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.344 std=0.542 p1=-0.0759 p99=1.99
2025-12-16 00:42:13,107 | INFO | [pred] lgbm_dart#2: |err| q99=12.3853  tail_n=3/261  tail_share_SSE=56.71%
2025-12-16 00:42:13,109 | INFO | [pred] lgbm_dart#2: per-day mse days=19 p50=0.940728 p90=18.219 p99=46.6823 max=51.6671
2025-12-16 00:42:23,942 | INFO | === Expanding step: train_to_2023-04__test_2023-05 ===
2025-12-16 00:42:23,947 | INFO | [guardrails] transform=none
2025-12-16 00:42:23,947 | INFO | [guardrails] winsor z: lower_q=0.0050 (-1.66574), upper_q=0.9950 (14.0048)
2025-12-16 00:42:24,453 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-16 00:42:27,226 | INFO | [keep] ridge#1 score=0.00705 params={'max_iter': np.int64(10000), 'alpha': 92.28295957427436}
2025-12-16 00:42:27,237 | INFO | [keep] ridge#2 score=0.00596 params={'max_iter': np.int64(10000), 'alpha': 86.26905220714896}
2025-12-16 00:42:35,538 | INFO | [keep] lasso#1 score=0.04660 params={'max_iter': np.int64(10000), 'alpha': 0.044303752452182654}
2025-12-16 00:42:35,551 | INFO | [keep] lasso#2 score=0.04611 params={'max_iter': np.int64(10000), 'alpha': 0.0431171005868549}
2025-12-16 00:42:45,692 | INFO | [keep] elasticnet#1 score=0.04934 params={'max_iter': np.int64(10000), 'alpha': 0.2903886846508793, 'l1_ratio': 0.17768102063444902}
2025-12-16 00:42:45,707 | INFO | [keep] elasticnet#2 score=0.04925 params={'max_iter': np.int64(10000), 'alpha': 0.1550122744363175, 'l1_ratio': 0.3495559963836815}
2025-12-16 00:42:46,430 | INFO | [keep] pcr#1 score=0.06884 params={'pca__n_components': 5, 'ridge__alpha': 0.0001}
2025-12-16 00:42:46,443 | INFO | [keep] pcr#2 score=0.06884 params={'pca__n_components': 5, 'ridge__alpha': 0.001}
2025-12-16 00:42:46,580 | INFO | [keep] pls#1 score=0.04126 params={'n_components': 1}
2025-12-16 00:42:46,591 | INFO | [keep] pls#2 score=0.00816 params={'n_components': 2}
2025-12-16 00:42:46,591 | INFO | Training FFN: ['ffn']
2025-12-16 01:03:34,420 | INFO | [keep] ffn#1 score=0.09453 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(128), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(32), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.468615765286463, 'ffn__weight_decay': 0.08621629256846254}
2025-12-16 01:03:53,844 | INFO | [keep] ffn#2 score=0.09351 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(64), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(32), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.49651215141776783, 'ffn__weight_decay': 0.0015998881492631496}
2025-12-16 01:03:53,844 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-16 01:04:41,836 | INFO | [keep] rf#1 score=0.10614 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.8, 'min_samples_leaf': 20, 'n_estimators': 100}
2025-12-16 01:04:42,258 | INFO | [keep] rf#2 score=0.10216 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'log2', 'max_samples': 0.6, 'min_samples_leaf': 20, 'n_estimators': 200}
2025-12-16 01:04:52,629 | INFO | [keep] lgbm_gbdt#1 score=0.12007 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(63), 'max_depth': np.int64(4), 'min_child_samples': np.int64(100), 'n_estimators': np.int64(200), 'num_leaves': np.int64(15), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.14811230193442643, 'reg_lambda': 0.12966915042890778} | n_estimators(refit)=109
2025-12-16 01:04:52,712 | INFO | [keep] lgbm_gbdt#2 score=0.11871 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(63), 'max_depth': np.int64(6), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 1.2753898599202926, 'reg_lambda': 0.213737596049905} | n_estimators(refit)=71
2025-12-16 01:05:14,261 | INFO | [keep] lgbm_dart#1 score=0.11988 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'drop_rate': np.float64(0.2), 'learning_rate': np.float64(0.05), 'max_bin': np.int64(63), 'max_depth': np.int64(4), 'max_drop': np.int64(10), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.1), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(200), 'num_leaves': np.int64(7), 'skip_drop': np.float64(0.3), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 2.9412232239026928, 'reg_lambda': 47.268087682464916}
2025-12-16 01:05:14,584 | INFO | [keep] lgbm_dart#2 score=0.11946 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'drop_rate': np.float64(0.3), 'learning_rate': np.float64(0.05), 'max_bin': np.int64(127), 'max_depth': np.int64(6), 'max_drop': np.int64(20), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.1), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'skip_drop': np.float64(0.3), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.11331543612010862, 'reg_lambda': 5.912295566997817}
2025-12-16 01:05:14,585 | INFO | [pred] ridge#1: n=283 R2_OS=0.04720 mse=6.07565 mse0=6.37665 | y mean=0.476 std=2.48 | yhat mean=0.168 std=0.576 p1=-0.632 p99=1.84
2025-12-16 01:05:14,585 | INFO | [pred] ridge#1: |err| q99=13.5811  tail_n=3/283  tail_share_SSE=44.90%
2025-12-16 01:05:14,587 | INFO | [pred] ridge#1: per-day mse days=19 p50=0.54748 p90=30.7122 p99=83.703 max=84.385
2025-12-16 01:05:14,587 | INFO | [pred] ridge#2: n=283 R2_OS=0.04733 mse=6.07483 mse0=6.37665 | y mean=0.476 std=2.48 | yhat mean=0.172 std=0.584 p1=-0.635 p99=1.87
2025-12-16 01:05:14,588 | INFO | [pred] ridge#2: |err| q99=13.5719  tail_n=3/283  tail_share_SSE=44.88%
2025-12-16 01:05:14,589 | INFO | [pred] ridge#2: per-day mse days=19 p50=0.562834 p90=30.6644 p99=83.6132 max=84.2632
2025-12-16 01:05:14,590 | INFO | [pred] lasso#1: n=283 R2_OS=0.06188 mse=5.98205 mse0=6.37665 | y mean=0.476 std=2.48 | yhat mean=0.266 std=0.219 p1=-0.127 p99=0.645
2025-12-16 01:05:14,590 | INFO | [pred] lasso#1: |err| q99=13.7669  tail_n=3/283  tail_share_SSE=45.40%
2025-12-16 01:05:14,592 | INFO | [pred] lasso#1: per-day mse days=19 p50=0.435395 p90=31.1793 p99=83.7137 max=85.2501
2025-12-16 01:05:14,592 | INFO | [pred] lasso#2: n=283 R2_OS=0.06224 mse=5.97977 mse0=6.37665 | y mean=0.476 std=2.48 | yhat mean=0.268 std=0.222 p1=-0.13 p99=0.654
2025-12-16 01:05:14,592 | INFO | [pred] lasso#2: |err| q99=13.7638  tail_n=3/283  tail_share_SSE=45.40%
2025-12-16 01:05:14,594 | INFO | [pred] lasso#2: per-day mse days=19 p50=0.435044 p90=31.1568 p99=83.6717 max=85.2033
2025-12-16 01:05:14,594 | INFO | [pred] elasticnet#1: n=283 R2_OS=0.05394 mse=6.0327 mse0=6.37665 | y mean=0.476 std=2.48 | yhat mean=0.218 std=0.178 p1=-0.0907 p99=0.541
2025-12-16 01:05:14,594 | INFO | [pred] elasticnet#1: |err| q99=13.8264  tail_n=3/283  tail_share_SSE=45.54%
2025-12-16 01:05:14,596 | INFO | [pred] elasticnet#1: per-day mse days=19 p50=0.437167 p90=31.6224 p99=84.9269 max=86.5155
2025-12-16 01:05:14,596 | INFO | [pred] elasticnet#2: n=283 R2_OS=0.05603 mse=6.01937 mse0=6.37665 | y mean=0.476 std=2.48 | yhat mean=0.232 std=0.185 p1=-0.0931 p99=0.553
2025-12-16 01:05:14,597 | INFO | [pred] elasticnet#2: |err| q99=13.812  tail_n=3/283  tail_share_SSE=45.49%
2025-12-16 01:05:14,598 | INFO | [pred] elasticnet#2: per-day mse days=19 p50=0.437591 p90=31.5143 p99=84.5615 max=86.1441
2025-12-16 01:05:14,599 | INFO | [pred] pcr#1: n=283 R2_OS=0.07262 mse=5.91355 mse0=6.37665 | y mean=0.476 std=2.48 | yhat mean=0.275 std=0.241 p1=-0.145 p99=0.833
2025-12-16 01:05:14,599 | INFO | [pred] pcr#1: |err| q99=13.7459  tail_n=3/283  tail_share_SSE=45.42%
2025-12-16 01:05:14,601 | INFO | [pred] pcr#1: per-day mse days=19 p50=0.430698 p90=30.4512 p99=84.6051 max=86.2942
2025-12-16 01:05:14,601 | INFO | [pred] pcr#2: n=283 R2_OS=0.07262 mse=5.91355 mse0=6.37665 | y mean=0.476 std=2.48 | yhat mean=0.275 std=0.241 p1=-0.145 p99=0.833
2025-12-16 01:05:14,601 | INFO | [pred] pcr#2: |err| q99=13.7459  tail_n=3/283  tail_share_SSE=45.42%
2025-12-16 01:05:14,603 | INFO | [pred] pcr#2: per-day mse days=19 p50=0.430698 p90=30.4512 p99=84.6051 max=86.2942
2025-12-16 01:05:14,604 | INFO | [pred] pls#1: n=283 R2_OS=0.12072 mse=5.60686 mse0=6.37665 | y mean=0.476 std=2.48 | yhat mean=0.619 std=0.543 p1=-0.35 p99=1.73
2025-12-16 01:05:14,604 | INFO | [pred] pls#1: |err| q99=12.7855  tail_n=3/283  tail_share_SSE=43.69%
2025-12-16 01:05:14,605 | INFO | [pred] pls#1: per-day mse days=19 p50=0.936498 p90=27.1719 p99=72.4332 max=72.7513
2025-12-16 01:05:14,606 | INFO | [pred] pls#2: n=283 R2_OS=0.11745 mse=5.62768 mse0=6.37665 | y mean=0.476 std=2.48 | yhat mean=0.472 std=0.626 p1=-0.576 p99=1.63
2025-12-16 01:05:14,606 | INFO | [pred] pls#2: |err| q99=12.7481  tail_n=3/283  tail_share_SSE=44.25%
2025-12-16 01:05:14,608 | INFO | [pred] pls#2: per-day mse days=19 p50=0.916629 p90=27.7696 p99=72.5234 max=72.6672
2025-12-16 01:05:14,609 | INFO | [pred] L-En: n=283 R2_OS=0.08108 mse=5.85962 mse0=6.37665 | y mean=0.476 std=2.48 | yhat mean=0.297 std=0.345 p1=-0.281 p99=1.11
2025-12-16 01:05:14,609 | INFO | [pred] L-En: |err| q99=13.5347  tail_n=3/283  tail_share_SSE=45.51%
2025-12-16 01:05:14,611 | INFO | [pred] L-En: per-day mse days=19 p50=0.408371 p90=30.1833 p99=81.7388 max=82.8789
2025-12-16 01:05:14,613 | INFO | [pred] ffn#1: n=283 R2_OS=0.11113 mse=5.668 mse0=6.37665 | y mean=0.476 std=2.48 | yhat mean=0.513 std=0.689 p1=-0.332 p99=2.18
2025-12-16 01:05:14,614 | INFO | [pred] ffn#1: |err| q99=12.6079  tail_n=3/283  tail_share_SSE=43.67%
2025-12-16 01:05:14,615 | INFO | [pred] ffn#1: per-day mse days=19 p50=1.06453 p90=26.9401 p99=72.9996 max=73.1767
2025-12-16 01:05:14,618 | INFO | [pred] ffn#2: n=283 R2_OS=0.10401 mse=5.71339 mse0=6.37665 | y mean=0.476 std=2.48 | yhat mean=0.558 std=0.761 p1=-0.325 p99=2.42
2025-12-16 01:05:14,618 | INFO | [pred] ffn#2: |err| q99=12.4299  tail_n=3/283  tail_share_SSE=43.06%
2025-12-16 01:05:14,620 | INFO | [pred] ffn#2: per-day mse days=19 p50=1.21077 p90=26.2552 p99=72.7319 max=73.2743
2025-12-16 01:05:14,632 | INFO | [pred] rf#1: n=283 R2_OS=0.15852 mse=5.36584 mse0=6.37665 | y mean=0.476 std=2.48 | yhat mean=0.612 std=0.775 p1=-0.148 p99=2.4
2025-12-16 01:05:14,632 | INFO | [pred] rf#1: |err| q99=12.1314  tail_n=3/283  tail_share_SSE=43.75%
2025-12-16 01:05:14,634 | INFO | [pred] rf#1: per-day mse days=19 p50=1.07494 p90=24.0601 p99=69.5393 max=70.8375
2025-12-16 01:05:14,657 | INFO | [pred] rf#2: n=283 R2_OS=0.14387 mse=5.45927 mse0=6.37665 | y mean=0.476 std=2.48 | yhat mean=0.581 std=0.696 p1=-0.098 p99=2.05
2025-12-16 01:05:14,657 | INFO | [pred] rf#2: |err| q99=12.3243  tail_n=3/283  tail_share_SSE=43.35%
2025-12-16 01:05:14,659 | INFO | [pred] rf#2: per-day mse days=19 p50=0.873389 p90=25.8986 p99=69.28 max=69.4687
2025-12-16 01:05:14,660 | INFO | [pred] lgbm_gbdt#1: n=283 R2_OS=0.17720 mse=5.24668 mse0=6.37665 | y mean=0.476 std=2.48 | yhat mean=0.602 std=0.785 p1=-0.144 p99=2.6
2025-12-16 01:05:14,660 | INFO | [pred] lgbm_gbdt#1: |err| q99=11.7833  tail_n=3/283  tail_share_SSE=44.04%
2025-12-16 01:05:14,661 | INFO | [pred] lgbm_gbdt#1: per-day mse days=19 p50=1.20788 p90=23.7954 p99=65.5286 max=67.1145
2025-12-16 01:05:14,662 | INFO | [pred] lgbm_gbdt#2: n=283 R2_OS=0.15491 mse=5.38887 mse0=6.37665 | y mean=0.476 std=2.48 | yhat mean=0.552 std=0.78 p1=-0.175 p99=2.59
2025-12-16 01:05:14,662 | INFO | [pred] lgbm_gbdt#2: |err| q99=11.7933  tail_n=3/283  tail_share_SSE=44.44%
2025-12-16 01:05:14,664 | INFO | [pred] lgbm_gbdt#2: per-day mse days=19 p50=1.11442 p90=24.6605 p99=67.9967 max=69.7013
2025-12-16 01:05:14,665 | INFO | [pred] lgbm_dart#1: n=283 R2_OS=0.15049 mse=5.41704 mse0=6.37665 | y mean=0.476 std=2.48 | yhat mean=0.46 std=0.568 p1=-0.113 p99=1.62
2025-12-16 01:05:14,665 | INFO | [pred] lgbm_dart#1: |err| q99=12.6838  tail_n=3/283  tail_share_SSE=45.34%
2025-12-16 01:05:14,667 | INFO | [pred] lgbm_dart#1: per-day mse days=19 p50=0.770176 p90=27.4694 p99=70.2163 max=70.3127
2025-12-16 01:05:14,668 | INFO | [pred] lgbm_dart#2: n=283 R2_OS=0.16274 mse=5.33889 mse0=6.37665 | y mean=0.476 std=2.48 | yhat mean=0.563 std=0.71 p1=-0.149 p99=2.43
2025-12-16 01:05:14,668 | INFO | [pred] lgbm_dart#2: |err| q99=11.9651  tail_n=3/283  tail_share_SSE=44.75%
2025-12-16 01:05:14,670 | INFO | [pred] lgbm_dart#2: per-day mse days=19 p50=0.944484 p90=24.8477 p99=67.5222 max=69.1144
2025-12-16 01:05:25,341 | INFO | === Expanding step: train_to_2023-05__test_2023-06 ===
2025-12-16 01:05:25,346 | INFO | [guardrails] transform=none
2025-12-16 01:05:25,346 | INFO | [guardrails] winsor z: lower_q=0.0050 (-1.66977), upper_q=0.9950 (13.7347)
2025-12-16 01:05:25,859 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-16 01:05:28,296 | INFO | [keep] ridge#1 score=-0.00231 params={'max_iter': np.int64(10000), 'alpha': 92.28295957427436}
2025-12-16 01:05:28,307 | INFO | [keep] ridge#2 score=-0.00353 params={'max_iter': np.int64(10000), 'alpha': 86.26905220714896}
2025-12-16 01:05:36,419 | INFO | [keep] lasso#1 score=0.06243 params={'max_iter': np.int64(10000), 'alpha': 0.025465581928924362}
2025-12-16 01:05:36,436 | INFO | [keep] lasso#2 score=0.06207 params={'max_iter': np.int64(10000), 'alpha': 0.02505718725747767}
2025-12-16 01:05:46,518 | INFO | [keep] elasticnet#1 score=0.06592 params={'max_iter': np.int64(10000), 'alpha': 0.16511660035531794, 'l1_ratio': 0.13135023380345656}
2025-12-16 01:05:46,537 | INFO | [keep] elasticnet#2 score=0.06399 params={'max_iter': np.int64(10000), 'alpha': 0.09105944026265275, 'l1_ratio': 0.3026332820318257}
2025-12-16 01:05:47,229 | INFO | [keep] pcr#1 score=0.06893 params={'pca__n_components': 5, 'ridge__alpha': 0.0001}
2025-12-16 01:05:47,242 | INFO | [keep] pcr#2 score=0.06893 params={'pca__n_components': 5, 'ridge__alpha': 0.001}
2025-12-16 01:05:47,374 | INFO | [keep] pls#1 score=0.07569 params={'n_components': 1}
2025-12-16 01:05:47,384 | INFO | [keep] pls#2 score=0.06313 params={'n_components': 2}
2025-12-16 01:05:47,384 | INFO | Training FFN: ['ffn']
2025-12-16 01:27:48,015 | INFO | [keep] ffn#1 score=0.09964 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(64), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(32), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.49651215141776783, 'ffn__weight_decay': 0.0015998881492631496}
2025-12-16 01:28:07,909 | INFO | [keep] ffn#2 score=0.09607 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(64), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(32), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.4311742245508329, 'ffn__weight_decay': 0.0019674028256453594}
2025-12-16 01:28:07,909 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-16 01:28:55,328 | INFO | [keep] rf#1 score=0.12648 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.8, 'min_samples_leaf': 20, 'n_estimators': 100}
2025-12-16 01:28:55,532 | INFO | [keep] rf#2 score=0.12646 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.6, 'min_samples_leaf': 20, 'n_estimators': 100}
2025-12-16 01:29:06,691 | INFO | [keep] lgbm_gbdt#1 score=0.13666 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(63), 'max_depth': np.int64(6), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 1.2753898599202926, 'reg_lambda': 0.213737596049905} | n_estimators(refit)=79
2025-12-16 01:29:06,732 | INFO | [keep] lgbm_gbdt#2 score=0.13383 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.1), 'max_bin': np.int64(127), 'max_depth': np.int64(6), 'min_child_samples': np.int64(100), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 6.637246930843269, 'reg_lambda': 5.71459224805273} | n_estimators(refit)=23
2025-12-16 01:29:32,137 | INFO | [keep] lgbm_dart#1 score=0.13014 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'drop_rate': np.float64(0.5), 'learning_rate': np.float64(0.05), 'max_bin': np.int64(127), 'max_depth': np.int64(6), 'max_drop': np.int64(20), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.01), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(200), 'num_leaves': np.int64(15), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 0.8301335256974502, 'reg_lambda': 92.5224254754638}
2025-12-16 01:29:32,410 | INFO | [keep] lgbm_dart#2 score=0.12987 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'drop_rate': np.float64(0.2), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(63), 'max_depth': np.int64(6), 'max_drop': np.int64(10), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.01), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 5.2520858151667795, 'reg_lambda': 2.372669804709427}
2025-12-16 01:29:32,410 | INFO | [pred] ridge#1: n=253 R2_OS=0.10191 mse=8.75243 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=-0.0986 std=0.522 p1=-0.882 p99=1.37
2025-12-16 01:29:32,411 | INFO | [pred] ridge#1: |err| q99=16.6899  tail_n=3/253  tail_share_SSE=48.48%
2025-12-16 01:29:32,413 | INFO | [pred] ridge#1: per-day mse days=19 p50=0.56085 p90=25.3 p99=56.8907 max=63.1537
2025-12-16 01:29:32,413 | INFO | [pred] ridge#2: n=253 R2_OS=0.10332 mse=8.73872 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=-0.0965 std=0.529 p1=-0.885 p99=1.4
2025-12-16 01:29:32,413 | INFO | [pred] ridge#2: |err| q99=16.6836  tail_n=3/253  tail_share_SSE=48.49%
2025-12-16 01:29:32,415 | INFO | [pred] ridge#2: per-day mse days=19 p50=0.562726 p90=25.2856 p99=56.8459 max=63.1059
2025-12-16 01:29:32,416 | INFO | [pred] lasso#1: n=253 R2_OS=0.08780 mse=8.88998 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.226 std=0.254 p1=-0.219 p99=0.898
2025-12-16 01:29:32,416 | INFO | [pred] lasso#1: |err| q99=16.6481  tail_n=3/253  tail_share_SSE=48.94%
2025-12-16 01:29:32,417 | INFO | [pred] lasso#1: per-day mse days=19 p50=0.606575 p90=24.1867 p99=57.6252 max=64.2231
2025-12-16 01:29:32,418 | INFO | [pred] lasso#2: n=253 R2_OS=0.08809 mse=8.8872 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.226 std=0.256 p1=-0.223 p99=0.899
2025-12-16 01:29:32,418 | INFO | [pred] lasso#2: |err| q99=16.6482  tail_n=3/253  tail_share_SSE=48.94%
2025-12-16 01:29:32,420 | INFO | [pred] lasso#2: per-day mse days=19 p50=0.603934 p90=24.1771 p99=57.6022 max=64.1954
2025-12-16 01:29:32,420 | INFO | [pred] elasticnet#1: n=253 R2_OS=0.08868 mse=8.88145 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.227 std=0.267 p1=-0.236 p99=0.888
2025-12-16 01:29:32,420 | INFO | [pred] elasticnet#1: |err| q99=16.6515  tail_n=3/253  tail_share_SSE=48.92%
2025-12-16 01:29:32,422 | INFO | [pred] elasticnet#1: per-day mse days=19 p50=0.663082 p90=24.3599 p99=57.787 max=64.3815
2025-12-16 01:29:32,422 | INFO | [pred] elasticnet#2: n=253 R2_OS=0.08553 mse=8.9121 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.235 std=0.246 p1=-0.193 p99=0.863
2025-12-16 01:29:32,422 | INFO | [pred] elasticnet#2: |err| q99=16.6507  tail_n=3/253  tail_share_SSE=48.93%
2025-12-16 01:29:32,424 | INFO | [pred] elasticnet#2: per-day mse days=19 p50=0.664439 p90=24.3693 p99=57.9523 max=64.586
2025-12-16 01:29:32,425 | INFO | [pred] pcr#1: n=253 R2_OS=0.08180 mse=8.94845 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.231 std=0.247 p1=-0.213 p99=0.895
2025-12-16 01:29:32,425 | INFO | [pred] pcr#1: |err| q99=16.6901  tail_n=3/253  tail_share_SSE=48.94%
2025-12-16 01:29:32,426 | INFO | [pred] pcr#1: per-day mse days=19 p50=0.703335 p90=24.8619 p99=58.4905 max=65.0802
2025-12-16 01:29:32,427 | INFO | [pred] pcr#2: n=253 R2_OS=0.08180 mse=8.94845 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.231 std=0.247 p1=-0.213 p99=0.895
2025-12-16 01:29:32,427 | INFO | [pred] pcr#2: |err| q99=16.6901  tail_n=3/253  tail_share_SSE=48.94%
2025-12-16 01:29:32,429 | INFO | [pred] pcr#2: per-day mse days=19 p50=0.703335 p90=24.8619 p99=58.4905 max=65.0802
2025-12-16 01:29:32,429 | INFO | [pred] pls#1: n=253 R2_OS=0.15759 mse=8.20986 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.628 std=0.565 p1=-0.369 p99=2.08
2025-12-16 01:29:32,429 | INFO | [pred] pls#1: |err| q99=15.8379  tail_n=3/253  tail_share_SSE=49.36%
2025-12-16 01:29:32,431 | INFO | [pred] pls#1: per-day mse days=19 p50=1.6129 p90=21.7856 p99=54.0661 max=60.3244
2025-12-16 01:29:32,432 | INFO | [pred] pls#2: n=253 R2_OS=0.16271 mse=8.15995 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.542 std=0.647 p1=-0.627 p99=2.17
2025-12-16 01:29:32,432 | INFO | [pred] pls#2: |err| q99=15.8037  tail_n=3/253  tail_share_SSE=49.74%
2025-12-16 01:29:32,433 | INFO | [pred] pls#2: per-day mse days=19 p50=1.41998 p90=22.1595 p99=54.6583 max=61.0956
2025-12-16 01:29:32,435 | INFO | [pred] L-En: n=253 R2_OS=0.11200 mse=8.6541 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.235 std=0.368 p1=-0.386 p99=1.19
2025-12-16 01:29:32,435 | INFO | [pred] L-En: |err| q99=16.4994  tail_n=3/253  tail_share_SSE=49.39%
2025-12-16 01:29:32,436 | INFO | [pred] L-En: per-day mse days=19 p50=0.794056 p90=24.0755 p99=56.9997 max=63.4859
2025-12-16 01:29:32,439 | INFO | [pred] ffn#1: n=253 R2_OS=0.19071 mse=7.88702 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.236 std=0.761 p1=-0.669 p99=2.53
2025-12-16 01:29:32,439 | INFO | [pred] ffn#1: |err| q99=16.1548  tail_n=3/253  tail_share_SSE=49.81%
2025-12-16 01:29:32,441 | INFO | [pred] ffn#1: per-day mse days=19 p50=0.839664 p90=22.3334 p99=53.6733 max=59.8984
2025-12-16 01:29:32,443 | INFO | [pred] ffn#2: n=253 R2_OS=0.19204 mse=7.87409 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.223 std=0.776 p1=-0.722 p99=2.57
2025-12-16 01:29:32,443 | INFO | [pred] ffn#2: |err| q99=16.1129  tail_n=3/253  tail_share_SSE=49.74%
2025-12-16 01:29:32,445 | INFO | [pred] ffn#2: per-day mse days=19 p50=0.860775 p90=22.2911 p99=53.5204 max=59.7385
2025-12-16 01:29:32,457 | INFO | [pred] rf#1: n=253 R2_OS=0.20581 mse=7.73991 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.599 std=0.784 p1=-0.155 p99=2.72
2025-12-16 01:29:32,458 | INFO | [pred] rf#1: |err| q99=15.535  tail_n=3/253  tail_share_SSE=47.40%
2025-12-16 01:29:32,459 | INFO | [pred] rf#1: per-day mse days=19 p50=1.25027 p90=20.4054 p99=49.2935 max=55.4151
2025-12-16 01:29:32,472 | INFO | [pred] rf#2: n=253 R2_OS=0.19850 mse=7.81118 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.595 std=0.764 p1=-0.177 p99=2.7
2025-12-16 01:29:32,472 | INFO | [pred] rf#2: |err| q99=15.6545  tail_n=3/253  tail_share_SSE=48.92%
2025-12-16 01:29:32,474 | INFO | [pred] rf#2: per-day mse days=19 p50=1.42801 p90=20.8402 p99=50.8778 max=57.2504
2025-12-16 01:29:32,475 | INFO | [pred] lgbm_gbdt#1: n=253 R2_OS=0.21626 mse=7.63805 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.593 std=0.855 p1=-0.229 p99=2.99
2025-12-16 01:29:32,475 | INFO | [pred] lgbm_gbdt#1: |err| q99=15.1159  tail_n=3/253  tail_share_SSE=48.41%
2025-12-16 01:29:32,477 | INFO | [pred] lgbm_gbdt#1: per-day mse days=19 p50=1.38717 p90=21.2184 p99=49.5118 max=55.1608
2025-12-16 01:29:32,477 | INFO | [pred] lgbm_gbdt#2: n=253 R2_OS=0.18460 mse=7.94658 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.481 std=0.705 p1=-0.312 p99=2.03
2025-12-16 01:29:32,478 | INFO | [pred] lgbm_gbdt#2: |err| q99=15.3655  tail_n=3/253  tail_share_SSE=48.31%
2025-12-16 01:29:32,479 | INFO | [pred] lgbm_gbdt#2: per-day mse days=19 p50=1.42482 p90=20.0368 p99=51.1977 max=57.0339
2025-12-16 01:29:32,480 | INFO | [pred] lgbm_dart#1: n=253 R2_OS=0.15388 mse=8.246 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.345 std=0.502 p1=-0.287 p99=1.67
2025-12-16 01:29:32,481 | INFO | [pred] lgbm_dart#1: |err| q99=15.8315  tail_n=3/253  tail_share_SSE=48.10%
2025-12-16 01:29:32,482 | INFO | [pred] lgbm_dart#1: per-day mse days=19 p50=0.826744 p90=21.0938 p99=52.3392 max=58.0576
2025-12-16 01:29:32,483 | INFO | [pred] lgbm_dart#2: n=253 R2_OS=0.16644 mse=8.12354 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.391 std=0.546 p1=-0.205 p99=1.78
2025-12-16 01:29:32,483 | INFO | [pred] lgbm_dart#2: |err| q99=15.7967  tail_n=3/253  tail_share_SSE=49.33%
2025-12-16 01:29:32,485 | INFO | [pred] lgbm_dart#2: per-day mse days=19 p50=1.1264 p90=21.835 p99=52.5266 max=58.8105
2025-12-16 01:29:43,088 | INFO | === Expanding step: train_to_2023-06__test_2023-07 ===
2025-12-16 01:29:43,093 | INFO | [guardrails] transform=none
2025-12-16 01:29:43,093 | INFO | [guardrails] winsor z: lower_q=0.0050 (-1.6655), upper_q=0.9950 (13.7518)
2025-12-16 01:29:43,624 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-16 01:29:46,284 | INFO | [keep] ridge#1 score=-0.00880 params={'max_iter': np.int64(10000), 'alpha': 92.28295957427436}
2025-12-16 01:29:46,295 | INFO | [keep] ridge#2 score=-0.00985 params={'max_iter': np.int64(10000), 'alpha': 86.26905220714896}
2025-12-16 01:29:54,928 | INFO | [keep] lasso#1 score=0.06553 params={'max_iter': np.int64(10000), 'alpha': 0.03860866271460544}
2025-12-16 01:29:54,945 | INFO | [keep] lasso#2 score=0.06515 params={'max_iter': np.int64(10000), 'alpha': 0.03713164249534621}
2025-12-16 01:30:05,524 | INFO | [keep] elasticnet#1 score=0.06507 params={'max_iter': np.int64(10000), 'alpha': 0.06859416411328696, 'l1_ratio': 0.5935471974998056}
2025-12-16 01:30:05,570 | INFO | [keep] elasticnet#2 score=0.06493 params={'max_iter': np.int64(10000), 'alpha': 0.05059803874660431, 'l1_ratio': 0.8404773106341289}
2025-12-16 01:30:06,295 | INFO | [keep] pcr#1 score=0.06809 params={'pca__n_components': 5, 'ridge__alpha': 0.0001}
2025-12-16 01:30:06,308 | INFO | [keep] pcr#2 score=0.06809 params={'pca__n_components': 5, 'ridge__alpha': 0.001}
2025-12-16 01:30:06,447 | INFO | [keep] pls#1 score=0.07394 params={'n_components': 1}
2025-12-16 01:30:06,459 | INFO | [keep] pls#2 score=0.06730 params={'n_components': 2}
2025-12-16 01:30:06,459 | INFO | Training FFN: ['ffn']
2025-12-16 01:51:42,154 | INFO | [keep] ffn#1 score=0.08211 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(128), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(32), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.36310341614842856, 'ffn__weight_decay': 0.0036762014489601746}
2025-12-16 01:51:51,205 | INFO | [keep] ffn#2 score=0.08177 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(64), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.4731634167180391, 'ffn__weight_decay': 0.0014653571755444989}
2025-12-16 01:51:51,206 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-16 01:52:40,558 | INFO | [keep] rf#1 score=0.12341 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.8, 'min_samples_leaf': 20, 'n_estimators': 100}
2025-12-16 01:52:41,094 | INFO | [keep] rf#2 score=0.12091 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.6, 'min_samples_leaf': 20, 'n_estimators': 300}
2025-12-16 01:52:51,795 | INFO | [keep] lgbm_gbdt#1 score=0.13234 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.1), 'max_bin': np.int64(63), 'max_depth': np.int64(4), 'min_child_samples': np.int64(100), 'n_estimators': np.int64(200), 'num_leaves': np.int64(15), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 0.15665251706864214, 'reg_lambda': 1.7512856194508308} | n_estimators(refit)=43
2025-12-16 01:52:51,902 | INFO | [keep] lgbm_gbdt#2 score=0.13106 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(63), 'max_depth': np.int64(6), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 1.2753898599202926, 'reg_lambda': 0.213737596049905} | n_estimators(refit)=102
2025-12-16 01:53:13,320 | INFO | [keep] lgbm_dart#1 score=0.12615 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'drop_rate': np.float64(0.3), 'learning_rate': np.float64(0.1), 'max_bin': np.int64(63), 'max_depth': np.int64(6), 'max_drop': np.int64(10), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.1), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(50), 'num_leaves': np.int64(15), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 94.55205830884037, 'reg_lambda': 1.3496582100654222}
2025-12-16 01:53:13,465 | INFO | [keep] lgbm_dart#2 score=0.12542 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'drop_rate': np.float64(0.3), 'learning_rate': np.float64(0.1), 'max_bin': np.int64(63), 'max_depth': np.int64(4), 'max_drop': np.int64(10), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.1), 'min_split_gain': np.float64(0.05), 'n_estimators': np.int64(200), 'num_leaves': np.int64(7), 'skip_drop': np.float64(0.3), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.3995287520709348, 'reg_lambda': 3.4846841139324187}
2025-12-16 01:53:13,465 | INFO | [pred] ridge#1: n=208 R2_OS=0.08096 mse=13.8417 mse0=15.0611 | y mean=0.857 std=3.79 | yhat mean=-0.134 std=0.474 p1=-1.05 p99=1.27
2025-12-16 01:53:13,465 | INFO | [pred] ridge#1: |err| q99=19.7926  tail_n=3/208  tail_share_SSE=50.20%
2025-12-16 01:53:13,467 | INFO | [pred] ridge#1: per-day mse days=19 p50=0.238911 p90=39.1576 p99=77.5949 max=78.7452
2025-12-16 01:53:13,468 | INFO | [pred] ridge#2: n=208 R2_OS=0.08224 mse=13.8225 mse0=15.0611 | y mean=0.857 std=3.79 | yhat mean=-0.132 std=0.479 p1=-1.06 p99=1.29
2025-12-16 01:53:13,468 | INFO | [pred] ridge#2: |err| q99=19.7726  tail_n=3/208  tail_share_SSE=50.22%
2025-12-16 01:53:13,470 | INFO | [pred] ridge#2: per-day mse days=19 p50=0.245186 p90=39.0997 p99=77.5515 max=78.7258
2025-12-16 01:53:13,470 | INFO | [pred] lasso#1: n=208 R2_OS=0.05849 mse=14.1802 mse0=15.0611 | y mean=0.857 std=3.79 | yhat mean=0.157 std=0.193 p1=-0.189 p99=0.724
2025-12-16 01:53:13,470 | INFO | [pred] lasso#1: |err| q99=20.4371  tail_n=3/208  tail_share_SSE=49.17%
2025-12-16 01:53:13,472 | INFO | [pred] lasso#1: per-day mse days=19 p50=0.425394 p90=39.9744 p99=76.8811 max=77.3769
2025-12-16 01:53:13,472 | INFO | [pred] lasso#2: n=208 R2_OS=0.05907 mse=14.1714 mse0=15.0611 | y mean=0.857 std=3.79 | yhat mean=0.156 std=0.196 p1=-0.196 p99=0.735
2025-12-16 01:53:13,472 | INFO | [pred] lasso#2: |err| q99=20.4264  tail_n=3/208  tail_share_SSE=49.20%
2025-12-16 01:53:13,474 | INFO | [pred] lasso#2: per-day mse days=19 p50=0.421957 p90=39.9897 p99=76.7977 max=77.2691
2025-12-16 01:53:13,474 | INFO | [pred] elasticnet#1: n=208 R2_OS=0.05759 mse=14.1938 mse0=15.0611 | y mean=0.857 std=3.79 | yhat mean=0.154 std=0.185 p1=-0.18 p99=0.699
2025-12-16 01:53:13,475 | INFO | [pred] elasticnet#1: |err| q99=20.4577  tail_n=3/208  tail_share_SSE=49.14%
2025-12-16 01:53:13,476 | INFO | [pred] elasticnet#1: per-day mse days=19 p50=0.426612 p90=39.9561 p99=77.0735 max=77.6206
2025-12-16 01:53:13,477 | INFO | [pred] elasticnet#2: n=208 R2_OS=0.05733 mse=14.1977 mse0=15.0611 | y mean=0.857 std=3.79 | yhat mean=0.156 std=0.184 p1=-0.176 p99=0.695
2025-12-16 01:53:13,477 | INFO | [pred] elasticnet#2: |err| q99=20.4631  tail_n=3/208  tail_share_SSE=49.12%
2025-12-16 01:53:13,478 | INFO | [pred] elasticnet#2: per-day mse days=19 p50=0.425487 p90=39.9384 p99=77.103 max=77.664
2025-12-16 01:53:13,479 | INFO | [pred] pcr#1: n=208 R2_OS=0.05601 mse=14.2175 mse0=15.0611 | y mean=0.857 std=3.79 | yhat mean=0.131 std=0.184 p1=-0.309 p99=0.691
2025-12-16 01:53:13,479 | INFO | [pred] pcr#1: |err| q99=20.4821  tail_n=3/208  tail_share_SSE=48.93%
2025-12-16 01:53:13,481 | INFO | [pred] pcr#1: per-day mse days=19 p50=0.290033 p90=39.6533 p99=77.5843 max=78.1946
2025-12-16 01:53:13,481 | INFO | [pred] pcr#2: n=208 R2_OS=0.05601 mse=14.2175 mse0=15.0611 | y mean=0.857 std=3.79 | yhat mean=0.131 std=0.184 p1=-0.309 p99=0.691
2025-12-16 01:53:13,481 | INFO | [pred] pcr#2: |err| q99=20.4821  tail_n=3/208  tail_share_SSE=48.93%
2025-12-16 01:53:13,483 | INFO | [pred] pcr#2: per-day mse days=19 p50=0.290033 p90=39.6533 p99=77.5843 max=78.1946
2025-12-16 01:53:13,484 | INFO | [pred] pls#1: n=208 R2_OS=0.13533 mse=13.0229 mse0=15.0611 | y mean=0.857 std=3.79 | yhat mean=0.369 std=0.477 p1=-0.486 p99=1.67
2025-12-16 01:53:13,484 | INFO | [pred] pls#1: |err| q99=19.4988  tail_n=3/208  tail_share_SSE=49.63%
2025-12-16 01:53:13,485 | INFO | [pred] pls#1: per-day mse days=19 p50=0.758271 p90=36.9525 p99=71.3122 max=71.6133
2025-12-16 01:53:13,486 | INFO | [pred] pls#2: n=208 R2_OS=0.13634 mse=13.0077 mse0=15.0611 | y mean=0.857 std=3.79 | yhat mean=0.253 std=0.553 p1=-0.633 p99=1.7
2025-12-16 01:53:13,486 | INFO | [pred] pls#2: |err| q99=19.4854  tail_n=3/208  tail_share_SSE=49.79%
2025-12-16 01:53:13,487 | INFO | [pred] pls#2: per-day mse days=19 p50=0.776411 p90=36.9426 p99=71.8627 max=72.1885
2025-12-16 01:53:13,489 | INFO | [pred] L-En: n=208 R2_OS=0.08174 mse=13.83 mse0=15.0611 | y mean=0.857 std=3.79 | yhat mean=0.124 std=0.289 p1=-0.404 p99=1.02
2025-12-16 01:53:13,489 | INFO | [pred] L-En: |err| q99=20.1286  tail_n=3/208  tail_share_SSE=49.61%
2025-12-16 01:53:13,490 | INFO | [pred] L-En: per-day mse days=19 p50=0.266635 p90=39.404 p99=75.0155 max=75.0571
2025-12-16 01:53:13,493 | INFO | [pred] ffn#1: n=208 R2_OS=0.16140 mse=12.6302 mse0=15.0611 | y mean=0.857 std=3.79 | yhat mean=0.0423 std=0.615 p1=-0.6 p99=2.44
2025-12-16 01:53:13,493 | INFO | [pred] ffn#1: |err| q99=18.6934  tail_n=3/208  tail_share_SSE=51.43%
2025-12-16 01:53:13,495 | INFO | [pred] ffn#1: per-day mse days=19 p50=0.528829 p90=36.1717 p99=73.2978 max=75.3046
2025-12-16 01:53:13,497 | INFO | [pred] ffn#2: n=208 R2_OS=0.15513 mse=12.7247 mse0=15.0611 | y mean=0.857 std=3.79 | yhat mean=0.0902 std=0.559 p1=-0.553 p99=2.22
2025-12-16 01:53:13,497 | INFO | [pred] ffn#2: |err| q99=18.8381  tail_n=3/208  tail_share_SSE=51.29%
2025-12-16 01:53:13,499 | INFO | [pred] ffn#2: per-day mse days=19 p50=0.343262 p90=36.4297 p99=73.3587 max=75.1661
2025-12-16 01:53:13,511 | INFO | [pred] rf#1: n=208 R2_OS=0.16843 mse=12.5244 mse0=15.0611 | y mean=0.857 std=3.79 | yhat mean=0.412 std=0.614 p1=-0.218 p99=2.14
2025-12-16 01:53:13,512 | INFO | [pred] rf#1: |err| q99=18.6674  tail_n=3/208  tail_share_SSE=48.44%
2025-12-16 01:53:13,513 | INFO | [pred] rf#1: per-day mse days=19 p50=0.878536 p90=34.0832 p99=68.2926 max=68.294
2025-12-16 01:53:13,536 | INFO | [pred] rf#2: n=208 R2_OS=0.16762 mse=12.5365 mse0=15.0611 | y mean=0.857 std=3.79 | yhat mean=0.406 std=0.614 p1=-0.168 p99=2.04
2025-12-16 01:53:13,537 | INFO | [pred] rf#2: |err| q99=19.0077  tail_n=3/208  tail_share_SSE=48.88%
2025-12-16 01:53:13,538 | INFO | [pred] rf#2: per-day mse days=19 p50=0.954345 p90=34.7297 p99=68.2552 max=68.3122
2025-12-16 01:53:13,539 | INFO | [pred] lgbm_gbdt#1: n=208 R2_OS=0.14989 mse=12.8035 mse0=15.0611 | y mean=0.857 std=3.79 | yhat mean=0.425 std=0.689 p1=-0.303 p99=2.36
2025-12-16 01:53:13,540 | INFO | [pred] lgbm_gbdt#1: |err| q99=19.2013  tail_n=3/208  tail_share_SSE=48.72%
2025-12-16 01:53:13,541 | INFO | [pred] lgbm_gbdt#1: per-day mse days=19 p50=1.19639 p90=35.8647 p99=68.3306 max=68.4146
2025-12-16 01:53:13,542 | INFO | [pred] lgbm_gbdt#2: n=208 R2_OS=0.17693 mse=12.3964 mse0=15.0611 | y mean=0.857 std=3.79 | yhat mean=0.364 std=0.735 p1=-0.343 p99=2.54
2025-12-16 01:53:13,542 | INFO | [pred] lgbm_gbdt#2: |err| q99=19.0745  tail_n=3/208  tail_share_SSE=48.94%
2025-12-16 01:53:13,544 | INFO | [pred] lgbm_gbdt#2: per-day mse days=19 p50=0.79375 p90=34.4091 p99=66.7614 max=66.913
2025-12-16 01:53:13,545 | INFO | [pred] lgbm_dart#1: n=208 R2_OS=0.04770 mse=14.3426 mse0=15.0611 | y mean=0.857 std=3.79 | yhat mean=0.104 std=0.206 p1=-0.195 p99=0.786
2025-12-16 01:53:13,545 | INFO | [pred] lgbm_dart#1: |err| q99=20.4328  tail_n=3/208  tail_share_SSE=49.18%
2025-12-16 01:53:13,546 | INFO | [pred] lgbm_dart#1: per-day mse days=19 p50=0.446229 p90=40.6063 p99=77.0065 max=77.2629
2025-12-16 01:53:13,547 | INFO | [pred] lgbm_dart#2: n=208 R2_OS=0.14052 mse=12.9447 mse0=15.0611 | y mean=0.857 std=3.79 | yhat mean=0.375 std=0.643 p1=-0.267 p99=2.22
2025-12-16 01:53:13,548 | INFO | [pred] lgbm_dart#2: |err| q99=19.5104  tail_n=3/208  tail_share_SSE=48.67%
2025-12-16 01:53:13,549 | INFO | [pred] lgbm_dart#2: per-day mse days=19 p50=1.15316 p90=36.0823 p99=69.3335 max=69.4601
2025-12-16 01:53:22,086 | INFO | === Expanding step: train_to_2023-07__test_2023-08 ===
2025-12-16 01:53:22,092 | INFO | [guardrails] transform=none
2025-12-16 01:53:22,092 | INFO | [guardrails] winsor z: lower_q=0.0050 (-1.65707), upper_q=0.9950 (13.569)
2025-12-16 01:53:22,600 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-16 01:53:25,197 | INFO | [keep] ridge#1 score=0.00447 params={'max_iter': np.int64(10000), 'alpha': 92.28295957427436}
2025-12-16 01:53:25,207 | INFO | [keep] ridge#2 score=0.00397 params={'max_iter': np.int64(10000), 'alpha': 86.26905220714896}
2025-12-16 01:53:33,677 | INFO | [keep] lasso#1 score=0.06495 params={'max_iter': np.int64(10000), 'alpha': 0.03860866271460544}
2025-12-16 01:53:33,693 | INFO | [keep] lasso#2 score=0.06465 params={'max_iter': np.int64(10000), 'alpha': 0.03713164249534621}
2025-12-16 01:53:44,120 | INFO | [keep] elasticnet#1 score=0.06528 params={'max_iter': np.int64(10000), 'alpha': 0.15487156510304176, 'l1_ratio': 0.23730374180915242}
2025-12-16 01:53:44,132 | INFO | [keep] elasticnet#2 score=0.06495 params={'max_iter': np.int64(10000), 'alpha': 0.3067750867937877, 'l1_ratio': 0.10375638095403766}
2025-12-16 01:53:44,838 | INFO | [keep] pcr#1 score=0.06925 params={'pca__n_components': 5, 'ridge__alpha': 0.0001}
2025-12-16 01:53:44,852 | INFO | [keep] pcr#2 score=0.06925 params={'pca__n_components': 5, 'ridge__alpha': 0.001}
2025-12-16 01:53:44,988 | INFO | [keep] pls#1 score=0.07577 params={'n_components': 1}
2025-12-16 01:53:44,999 | INFO | [keep] pls#2 score=0.07056 params={'n_components': 2}
2025-12-16 01:53:44,999 | INFO | Training FFN: ['ffn']
2025-12-16 02:12:12,489 | INFO | [keep] ffn#1 score=0.07465 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(64), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.4731634167180391, 'ffn__weight_decay': 0.0014653571755444989}
2025-12-16 02:12:21,089 | INFO | [keep] ffn#2 score=0.07457 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(64), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.47878885927286424, 'ffn__weight_decay': 0.004336485563242767}
2025-12-16 02:12:21,089 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-16 02:13:12,353 | INFO | [keep] rf#1 score=0.12397 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'log2', 'max_samples': 0.6, 'min_samples_leaf': 20, 'n_estimators': 100}
2025-12-16 02:13:12,660 | INFO | [keep] rf#2 score=0.12333 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'log2', 'max_samples': 0.6, 'min_samples_leaf': 20, 'n_estimators': 200}
2025-12-16 02:13:22,885 | INFO | [keep] lgbm_gbdt#1 score=0.12827 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'learning_rate': np.float64(0.05), 'max_bin': np.int64(63), 'max_depth': np.int64(6), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(100), 'num_leaves': np.int64(15), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.13869861245357323, 'reg_lambda': 0.1493683554419846} | n_estimators(refit)=28
2025-12-16 02:13:22,953 | INFO | [keep] lgbm_gbdt#2 score=0.12395 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(127), 'max_depth': np.int64(6), 'min_child_samples': np.int64(100), 'n_estimators': np.int64(100), 'num_leaves': np.int64(15), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 0.18895826938026009, 'reg_lambda': 0.24726618219776433} | n_estimators(refit)=84
2025-12-16 02:13:45,025 | INFO | [keep] lgbm_dart#1 score=0.13437 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'drop_rate': np.float64(0.3), 'learning_rate': np.float64(0.1), 'max_bin': np.int64(63), 'max_depth': np.int64(6), 'max_drop': np.int64(10), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.1), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(50), 'num_leaves': np.int64(15), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 94.55205830884037, 'reg_lambda': 1.3496582100654222}
2025-12-16 02:13:45,284 | INFO | [keep] lgbm_dart#2 score=0.12654 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'drop_rate': np.float64(0.5), 'learning_rate': np.float64(0.05), 'max_bin': np.int64(127), 'max_depth': np.int64(6), 'max_drop': np.int64(20), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.01), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(200), 'num_leaves': np.int64(15), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 0.8301335256974502, 'reg_lambda': 92.5224254754638}
2025-12-16 02:13:45,284 | INFO | [pred] ridge#1: n=194 R2_OS=0.06683 mse=3.38764 mse0=3.63024 | y mean=0.289 std=1.89 | yhat mean=-0.378 std=0.404 p1=-1.03 p99=0.621
2025-12-16 02:13:45,284 | INFO | [pred] ridge#1: |err| q99=9.58772  tail_n=2/194  tail_share_SSE=44.11%
2025-12-16 02:13:45,286 | INFO | [pred] ridge#1: per-day mse days=20 p50=0.517651 p90=10.0954 p99=34.8161 max=38.2853
2025-12-16 02:13:45,287 | INFO | [pred] ridge#2: n=194 R2_OS=0.06740 mse=3.38557 mse0=3.63024 | y mean=0.289 std=1.89 | yhat mean=-0.378 std=0.408 p1=-1.03 p99=0.628
2025-12-16 02:13:45,287 | INFO | [pred] ridge#2: |err| q99=9.5754  tail_n=2/194  tail_share_SSE=44.11%
2025-12-16 02:13:45,289 | INFO | [pred] ridge#2: per-day mse days=20 p50=0.521815 p90=10.0649 p99=34.7936 max=38.2584
2025-12-16 02:13:45,289 | INFO | [pred] lasso#1: n=194 R2_OS=0.07990 mse=3.34017 mse0=3.63024 | y mean=0.289 std=1.89 | yhat mean=0.0837 std=0.185 p1=-0.229 p99=0.489
2025-12-16 02:13:45,289 | INFO | [pred] lasso#1: |err| q99=9.66812  tail_n=2/194  tail_share_SSE=45.34%
2025-12-16 02:13:45,291 | INFO | [pred] lasso#1: per-day mse days=20 p50=0.23904 p90=10.6331 p99=35.5735 max=38.5795
2025-12-16 02:13:45,291 | INFO | [pred] lasso#2: n=194 R2_OS=0.08128 mse=3.33519 mse0=3.63024 | y mean=0.289 std=1.89 | yhat mean=0.0833 std=0.188 p1=-0.235 p99=0.497
2025-12-16 02:13:45,291 | INFO | [pred] lasso#2: |err| q99=9.66644  tail_n=2/194  tail_share_SSE=45.34%
2025-12-16 02:13:45,293 | INFO | [pred] lasso#2: per-day mse days=20 p50=0.239113 p90=10.623 p99=35.5039 max=38.5094
2025-12-16 02:13:45,293 | INFO | [pred] elasticnet#1: n=194 R2_OS=0.07678 mse=3.35151 mse0=3.63024 | y mean=0.289 std=1.89 | yhat mean=0.0729 std=0.179 p1=-0.236 p99=0.459
2025-12-16 02:13:45,293 | INFO | [pred] elasticnet#1: |err| q99=9.67142  tail_n=2/194  tail_share_SSE=45.43%
2025-12-16 02:13:45,295 | INFO | [pred] elasticnet#1: per-day mse days=20 p50=0.240938 p90=10.649 p99=35.8162 max=38.8176
2025-12-16 02:13:45,295 | INFO | [pred] elasticnet#2: n=194 R2_OS=0.07524 mse=3.35712 mse0=3.63024 | y mean=0.289 std=1.89 | yhat mean=0.0607 std=0.176 p1=-0.257 p99=0.44
2025-12-16 02:13:45,296 | INFO | [pred] elasticnet#2: |err| q99=9.6787  tail_n=2/194  tail_share_SSE=45.48%
2025-12-16 02:13:45,297 | INFO | [pred] elasticnet#2: per-day mse days=20 p50=0.241856 p90=10.6764 p99=35.9387 max=38.9624
2025-12-16 02:13:45,298 | INFO | [pred] pcr#1: n=194 R2_OS=0.06923 mse=3.3789 mse0=3.63024 | y mean=0.289 std=1.89 | yhat mean=0.0421 std=0.179 p1=-0.314 p99=0.469
2025-12-16 02:13:45,298 | INFO | [pred] pcr#1: |err| q99=9.66052  tail_n=2/194  tail_share_SSE=46.00%
2025-12-16 02:13:45,300 | INFO | [pred] pcr#1: per-day mse days=20 p50=0.229365 p90=10.607 p99=36.4657 max=39.695
2025-12-16 02:13:45,300 | INFO | [pred] pcr#2: n=194 R2_OS=0.06923 mse=3.3789 mse0=3.63024 | y mean=0.289 std=1.89 | yhat mean=0.0421 std=0.179 p1=-0.314 p99=0.469
2025-12-16 02:13:45,300 | INFO | [pred] pcr#2: |err| q99=9.66052  tail_n=2/194  tail_share_SSE=46.00%
2025-12-16 02:13:45,302 | INFO | [pred] pcr#2: per-day mse days=20 p50=0.229365 p90=10.607 p99=36.4657 max=39.695
2025-12-16 02:13:45,302 | INFO | [pred] pls#1: n=194 R2_OS=0.15005 mse=3.08554 mse0=3.63024 | y mean=0.289 std=1.89 | yhat mean=0.254 std=0.422 p1=-0.419 p99=1.16
2025-12-16 02:13:45,303 | INFO | [pred] pls#1: |err| q99=9.20768  tail_n=2/194  tail_share_SSE=43.83%
2025-12-16 02:13:45,304 | INFO | [pred] pls#1: per-day mse days=20 p50=0.484584 p90=9.29812 p99=31.0012 max=33.398
2025-12-16 02:13:45,305 | INFO | [pred] pls#2: n=194 R2_OS=0.14381 mse=3.10817 mse0=3.63024 | y mean=0.289 std=1.89 | yhat mean=0.134 std=0.498 p1=-0.724 p99=1.26
2025-12-16 02:13:45,305 | INFO | [pred] pls#2: |err| q99=9.45917  tail_n=2/194  tail_share_SSE=43.02%
2025-12-16 02:13:45,306 | INFO | [pred] pls#2: per-day mse days=20 p50=0.466346 p90=9.51594 p99=30.872 max=32.9102
2025-12-16 02:13:45,308 | INFO | [pred] L-En: n=194 R2_OS=0.10624 mse=3.24456 mse0=3.63024 | y mean=0.289 std=1.89 | yhat mean=0.0017 std=0.261 p1=-0.395 p99=0.629
2025-12-16 02:13:45,308 | INFO | [pred] L-En: |err| q99=9.55114  tail_n=2/194  tail_share_SSE=45.77%
2025-12-16 02:13:45,309 | INFO | [pred] L-En: per-day mse days=20 p50=0.202761 p90=10.2376 p99=34.6549 max=37.639
2025-12-16 02:13:45,312 | INFO | [pred] ffn#1: n=194 R2_OS=0.16457 mse=3.03281 mse0=3.63024 | y mean=0.289 std=1.89 | yhat mean=-0.0797 std=0.424 p1=-0.67 p99=1.14
2025-12-16 02:13:45,312 | INFO | [pred] ffn#1: |err| q99=9.43662  tail_n=2/194  tail_share_SSE=43.90%
2025-12-16 02:13:45,314 | INFO | [pred] ffn#1: per-day mse days=20 p50=0.299539 p90=9.83379 p99=30.4914 max=32.9249
2025-12-16 02:13:45,316 | INFO | [pred] ffn#2: n=194 R2_OS=0.16339 mse=3.03709 mse0=3.63024 | y mean=0.289 std=1.89 | yhat mean=-0.0834 std=0.424 p1=-0.668 p99=1.14
2025-12-16 02:13:45,316 | INFO | [pred] ffn#2: |err| q99=9.43279  tail_n=2/194  tail_share_SSE=43.90%
2025-12-16 02:13:45,318 | INFO | [pred] ffn#2: per-day mse days=20 p50=0.303259 p90=9.82254 p99=30.5247 max=32.9687
2025-12-16 02:13:45,330 | INFO | [pred] rf#1: n=194 R2_OS=0.15974 mse=3.05033 mse0=3.63024 | y mean=0.289 std=1.89 | yhat mean=0.28 std=0.418 p1=-0.0897 p99=1.61
2025-12-16 02:13:45,330 | INFO | [pred] rf#1: |err| q99=9.31423  tail_n=2/194  tail_share_SSE=43.66%
2025-12-16 02:13:45,332 | INFO | [pred] rf#1: per-day mse days=20 p50=0.33518 p90=8.93303 p99=30.6667 max=32.864
2025-12-16 02:13:45,354 | INFO | [pred] rf#2: n=194 R2_OS=0.15081 mse=3.08276 mse0=3.63024 | y mean=0.289 std=1.89 | yhat mean=0.261 std=0.41 p1=-0.117 p99=1.52
2025-12-16 02:13:45,355 | INFO | [pred] rf#2: |err| q99=9.37396  tail_n=2/194  tail_share_SSE=43.90%
2025-12-16 02:13:45,356 | INFO | [pred] rf#2: per-day mse days=20 p50=0.332024 p90=9.03636 p99=31.2824 max=33.5515
2025-12-16 02:13:45,357 | INFO | [pred] lgbm_gbdt#1: n=194 R2_OS=0.23133 mse=2.79045 mse0=3.63024 | y mean=0.289 std=1.89 | yhat mean=0.235 std=0.605 p1=-0.247 p99=2.68
2025-12-16 02:13:45,357 | INFO | [pred] lgbm_gbdt#1: |err| q99=9.08469  tail_n=2/194  tail_share_SSE=38.57%
2025-12-16 02:13:45,359 | INFO | [pred] lgbm_gbdt#1: per-day mse days=20 p50=0.472423 p90=9.08617 p99=24.4924 max=25.8704
2025-12-16 02:13:45,360 | INFO | [pred] lgbm_gbdt#2: n=194 R2_OS=0.19230 mse=2.93214 mse0=3.63024 | y mean=0.289 std=1.89 | yhat mean=0.205 std=0.499 p1=-0.235 p99=1.91
2025-12-16 02:13:45,360 | INFO | [pred] lgbm_gbdt#2: |err| q99=9.31074  tail_n=2/194  tail_share_SSE=42.19%
2025-12-16 02:13:45,362 | INFO | [pred] lgbm_gbdt#2: per-day mse days=20 p50=0.46542 p90=9.26136 p99=27.8938 max=30.0897
2025-12-16 02:13:45,362 | INFO | [pred] lgbm_dart#1: n=194 R2_OS=0.08808 mse=3.31047 mse0=3.63024 | y mean=0.289 std=1.89 | yhat mean=0.0142 std=0.142 p1=-0.177 p99=0.682
2025-12-16 02:13:45,363 | INFO | [pred] lgbm_dart#1: |err| q99=9.88172  tail_n=2/194  tail_share_SSE=43.91%
2025-12-16 02:13:45,364 | INFO | [pred] lgbm_dart#1: per-day mse days=20 p50=0.203194 p90=11.3265 p99=34.3219 max=36.8933
2025-12-16 02:13:45,365 | INFO | [pred] lgbm_dart#2: n=194 R2_OS=0.16936 mse=3.01543 mse0=3.63024 | y mean=0.289 std=1.89 | yhat mean=0.11 std=0.377 p1=-0.349 p99=1.2
2025-12-16 02:13:45,365 | INFO | [pred] lgbm_dart#2: |err| q99=9.42975  tail_n=2/194  tail_share_SSE=42.81%
2025-12-16 02:13:45,367 | INFO | [pred] lgbm_dart#2: per-day mse days=20 p50=0.25111 p90=9.9435 p99=30.2903 max=32.241
2025-12-16 02:13:54,050 | INFO | Wrote expanding predictions: results/dh_ret/put-all/IBMCTINTERACTIONS/predictions_expanding.csv
2025-12-16 02:13:54,050 | INFO | [Selection] Choosing best model variant per family based on Aggregate R2_OS:
2025-12-16 02:13:54,050 | INFO |   > Family L-En: Winner=L-En (R2=0.0913)
2025-12-16 02:13:54,051 | INFO |   > Family N-En: Winner=N-En (R2=0.1549)
2025-12-16 02:13:54,051 | INFO |   > Family elasticnet: Winner=elasticnet#1 (R2=0.0609) | Dropped=['elasticnet#2']
2025-12-16 02:13:54,051 | INFO |   > Family ffn: Winner=ffn#1 (R2=0.1492) | Dropped=['ffn#2']
2025-12-16 02:13:54,051 | INFO |   > Family lasso: Winner=lasso#2 (R2=0.0623) | Dropped=['lasso#1']
2025-12-16 02:13:54,051 | INFO |   > Family lgbm_dart: Winner=lgbm_dart#2 (R2=0.1532) | Dropped=['lgbm_dart#1']
2025-12-16 02:13:54,051 | INFO |   > Family lgbm_gbdt: Winner=lgbm_gbdt#2 (R2=0.1543) | Dropped=['lgbm_gbdt#1']
2025-12-16 02:13:54,051 | INFO |   > Family pcr: Winner=pcr#2 (R2=0.0684) | Dropped=['pcr#1']
2025-12-16 02:13:54,051 | INFO |   > Family pls: Winner=pls#2 (R2=0.1434) | Dropped=['pls#1']
2025-12-16 02:13:54,051 | INFO |   > Family rf: Winner=rf#1 (R2=0.1638) | Dropped=['rf#2']
2025-12-16 02:13:54,051 | INFO |   > Family ridge: Winner=ridge#2 (R2=0.0866) | Dropped=['ridge#1']
2025-12-16 02:14:00,518 | INFO | [SHAP] Generating plots for subset: all (n=194)
2025-12-16 02:14:22,485 | INFO | [SHAP] Generating plots for subset: dte_1_7 (n=37)
2025-12-16 02:14:40,117 | INFO | [SHAP] Generating plots for subset: dte_8_31 (n=157)
2025-12-16 02:15:00,694 | INFO | [SHAP] Skipping subset itm (n=8 too small)
2025-12-16 02:15:00,694 | INFO | [SHAP] Generating plots for subset: atm (n=111)
2025-12-16 02:15:18,227 | INFO | [SHAP] Generating plots for subset: otm (n=75)
2025-12-16 02:15:34,820 | INFO | Variant complete (expanding monthly). Yay! :)
