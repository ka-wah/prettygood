2025-12-16 00:17:33,721 | INFO | === Expanding step: train_to_2023-03__test_2023-04 ===
2025-12-16 00:17:33,727 | INFO | [guardrails] transform=none
2025-12-16 00:17:33,728 | INFO | [guardrails] winsor z: lower_q=0.0050 (-1.65553), upper_q=0.9950 (14.1301)
2025-12-16 00:17:34,215 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-16 00:17:36,602 | INFO | [keep] ridge#1 score=-0.01800 params={'max_iter': np.int64(10000), 'alpha': 92.28295957427436}
2025-12-16 00:17:36,613 | INFO | [keep] ridge#2 score=-0.02072 params={'max_iter': np.int64(10000), 'alpha': 86.26905220714896}
2025-12-16 00:17:44,327 | INFO | [keep] lasso#1 score=0.03833 params={'max_iter': np.int64(10000), 'alpha': 0.09310837957239837}
2025-12-16 00:17:44,339 | INFO | [keep] lasso#2 score=0.03831 params={'max_iter': np.int64(10000), 'alpha': 0.09105944026265275}
2025-12-16 00:17:53,481 | INFO | [keep] elasticnet#1 score=0.04156 params={'max_iter': np.int64(10000), 'alpha': 0.24048783359009335, 'l1_ratio': 0.2791397504483041}
2025-12-16 00:17:53,491 | INFO | [keep] elasticnet#2 score=0.04047 params={'max_iter': np.int64(10000), 'alpha': 0.3904512502173691, 'l1_ratio': 0.19402548476962647}
2025-12-16 00:17:54,179 | INFO | [keep] pcr#1 score=0.05050 params={'pca__n_components': 5, 'ridge__alpha': 1.0}
2025-12-16 00:17:54,192 | INFO | [keep] pcr#2 score=0.05049 params={'pca__n_components': 5, 'ridge__alpha': 0.1}
2025-12-16 00:17:54,322 | INFO | [keep] pls#1 score=-0.02314 params={'n_components': 1}
2025-12-16 00:17:54,333 | INFO | [keep] pls#2 score=-0.02579 params={'n_components': 2}
2025-12-16 00:17:54,333 | INFO | Training FFN: ['ffn']
2025-12-16 00:40:49,302 | INFO | [keep] ffn#1 score=0.07718 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(128), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(32), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.468615765286463, 'ffn__weight_decay': 0.08621629256846254}
2025-12-16 00:40:53,713 | INFO | [keep] ffn#2 score=0.07670 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(64), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(32), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.4444899438110742, 'ffn__weight_decay': 0.09353687477155576}
2025-12-16 00:40:53,713 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-16 00:41:40,998 | INFO | [keep] rf#1 score=0.07045 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'log2', 'max_samples': 0.6, 'min_samples_leaf': 50, 'n_estimators': 200}
2025-12-16 00:41:41,311 | INFO | [keep] rf#2 score=0.07015 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'log2', 'max_samples': 0.8, 'min_samples_leaf': 100, 'n_estimators': 200}
2025-12-16 00:41:51,331 | INFO | [keep] lgbm_gbdt#1 score=0.10721 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'learning_rate': np.float64(0.1), 'max_bin': np.int64(127), 'max_depth': np.int64(4), 'min_child_samples': np.int64(100), 'n_estimators': np.int64(200), 'num_leaves': np.int64(15), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.26593836708988355, 'reg_lambda': 0.2785392800820963} | n_estimators(refit)=11
2025-12-16 00:41:51,396 | INFO | [keep] lgbm_gbdt#2 score=0.10641 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(127), 'max_depth': np.int64(4), 'min_child_samples': np.int64(100), 'n_estimators': np.int64(100), 'num_leaves': np.int64(15), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.19782524938981258, 'reg_lambda': 9.197266687466417} | n_estimators(refit)=76
2025-12-16 00:42:12,834 | INFO | [keep] lgbm_dart#1 score=0.10373 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'drop_rate': np.float64(0.2), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(127), 'max_depth': np.int64(6), 'max_drop': np.int64(10), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.01), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 1.994638447276318, 'reg_lambda': 18.54898207761947}
2025-12-16 00:42:13,010 | INFO | [keep] lgbm_dart#2 score=0.10105 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'drop_rate': np.float64(0.5), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(127), 'max_depth': np.int64(4), 'max_drop': np.int64(10), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.01), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(200), 'num_leaves': np.int64(15), 'skip_drop': np.float64(0.3), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.2060078009532491, 'reg_lambda': 1.110268368861318}
2025-12-16 00:42:13,011 | INFO | [pred] ridge#1: n=261 R2_OS=0.09714 mse=6.17169 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.0731 std=0.455 p1=-0.679 p99=1.31
2025-12-16 00:42:13,011 | INFO | [pred] ridge#1: |err| q99=12.8747  tail_n=3/261  tail_share_SSE=58.05%
2025-12-16 00:42:13,013 | INFO | [pred] ridge#1: per-day mse days=19 p50=0.410528 p90=16.4621 p99=50.0415 max=56.0131
2025-12-16 00:42:13,014 | INFO | [pred] ridge#2: n=261 R2_OS=0.09820 mse=6.1644 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.0741 std=0.461 p1=-0.684 p99=1.33
2025-12-16 00:42:13,014 | INFO | [pred] ridge#2: |err| q99=12.8703  tail_n=3/261  tail_share_SSE=58.05%
2025-12-16 00:42:13,016 | INFO | [pred] ridge#2: per-day mse days=19 p50=0.419251 p90=16.4285 p99=50.0426 max=56.0318
2025-12-16 00:42:13,016 | INFO | [pred] lasso#1: n=261 R2_OS=0.04055 mse=6.5585 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.138 std=0.115 p1=-0.0833 p99=0.37
2025-12-16 00:42:13,016 | INFO | [pred] lasso#1: |err| q99=13.2967  tail_n=3/261  tail_share_SSE=56.71%
2025-12-16 00:42:13,018 | INFO | [pred] lasso#1: per-day mse days=19 p50=0.562385 p90=18.18 p99=49.2264 max=54.3927
2025-12-16 00:42:13,018 | INFO | [pred] lasso#2: n=261 R2_OS=0.04164 mse=6.55105 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.142 std=0.119 p1=-0.0848 p99=0.381
2025-12-16 00:42:13,019 | INFO | [pred] lasso#2: |err| q99=13.2874  tail_n=3/261  tail_share_SSE=56.73%
2025-12-16 00:42:13,020 | INFO | [pred] lasso#2: per-day mse days=19 p50=0.571605 p90=18.153 p99=49.1728 max=54.3344
2025-12-16 00:42:13,021 | INFO | [pred] elasticnet#1: n=261 R2_OS=0.04903 mse=6.50052 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.166 std=0.142 p1=-0.0968 p99=0.441
2025-12-16 00:42:13,021 | INFO | [pred] elasticnet#1: |err| q99=13.2284  tail_n=3/261  tail_share_SSE=56.87%
2025-12-16 00:42:13,023 | INFO | [pred] elasticnet#1: per-day mse days=19 p50=0.627436 p90=17.9507 p99=48.8995 max=54.0388
2025-12-16 00:42:13,023 | INFO | [pred] elasticnet#2: n=261 R2_OS=0.04274 mse=6.54355 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.145 std=0.12 p1=-0.0772 p99=0.392
2025-12-16 00:42:13,023 | INFO | [pred] elasticnet#2: |err| q99=13.2767  tail_n=3/261  tail_share_SSE=56.76%
2025-12-16 00:42:13,025 | INFO | [pred] elasticnet#2: per-day mse days=19 p50=0.583541 p90=18.1124 p99=49.2063 max=54.3832
2025-12-16 00:42:13,026 | INFO | [pred] pcr#1: n=261 R2_OS=0.06314 mse=6.40405 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.198 std=0.217 p1=-0.259 p99=0.745
2025-12-16 00:42:13,026 | INFO | [pred] pcr#1: |err| q99=13.008  tail_n=3/261  tail_share_SSE=56.81%
2025-12-16 00:42:13,027 | INFO | [pred] pcr#1: per-day mse days=19 p50=0.548086 p90=17.3016 p99=48.6344 max=53.8654
2025-12-16 00:42:13,028 | INFO | [pred] pcr#2: n=261 R2_OS=0.06315 mse=6.40404 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.198 std=0.217 p1=-0.259 p99=0.745
2025-12-16 00:42:13,028 | INFO | [pred] pcr#2: |err| q99=13.008  tail_n=3/261  tail_share_SSE=56.81%
2025-12-16 00:42:13,030 | INFO | [pred] pcr#2: per-day mse days=19 p50=0.548083 p90=17.3015 p99=48.6343 max=53.8653
2025-12-16 00:42:13,030 | INFO | [pred] pls#1: n=261 R2_OS=0.10274 mse=6.13337 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.511 std=0.526 p1=-0.549 p99=1.72
2025-12-16 00:42:13,031 | INFO | [pred] pls#1: |err| q99=12.5034  tail_n=3/261  tail_share_SSE=55.74%
2025-12-16 00:42:13,032 | INFO | [pred] pls#1: per-day mse days=19 p50=1.28753 p90=17.536 p99=44.7111 max=49.6166
2025-12-16 00:42:13,033 | INFO | [pred] pls#2: n=261 R2_OS=0.10332 mse=6.1294 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.389 std=0.618 p1=-0.822 p99=1.77
2025-12-16 00:42:13,033 | INFO | [pred] pls#2: |err| q99=12.4705  tail_n=3/261  tail_share_SSE=56.49%
2025-12-16 00:42:13,034 | INFO | [pred] pls#2: per-day mse days=19 p50=1.27945 p90=17.8301 p99=46.0224 max=51.1777
2025-12-16 00:42:13,036 | INFO | [pred] L-En: n=261 R2_OS=0.07884 mse=6.29678 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.203 std=0.286 p1=-0.347 p99=0.872
2025-12-16 00:42:13,036 | INFO | [pred] L-En: |err| q99=12.9093  tail_n=3/261  tail_share_SSE=57.42%
2025-12-16 00:42:13,038 | INFO | [pred] L-En: per-day mse days=19 p50=0.385962 p90=17.0715 p99=48.4042 max=53.7168
2025-12-16 00:42:13,040 | INFO | [pred] ffn#1: n=261 R2_OS=0.08288 mse=6.26912 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.289 std=0.488 p1=-0.381 p99=1.64
2025-12-16 00:42:13,040 | INFO | [pred] ffn#1: |err| q99=12.7885  tail_n=3/261  tail_share_SSE=56.75%
2025-12-16 00:42:13,042 | INFO | [pred] ffn#1: per-day mse days=19 p50=0.979659 p90=17.5937 p99=46.9347 max=51.9417
2025-12-16 00:42:13,045 | INFO | [pred] ffn#2: n=261 R2_OS=0.05150 mse=6.48362 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.151 std=0.295 p1=-0.271 p99=1
2025-12-16 00:42:13,045 | INFO | [pred] ffn#2: |err| q99=13.2085  tail_n=3/261  tail_share_SSE=56.81%
2025-12-16 00:42:13,047 | INFO | [pred] ffn#2: per-day mse days=19 p50=0.477616 p90=17.6967 p99=47.9756 max=52.8971
2025-12-16 00:42:13,070 | INFO | [pred] rf#1: n=261 R2_OS=0.09863 mse=6.16145 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.436 std=0.533 p1=-0.149 p99=1.84
2025-12-16 00:42:13,070 | INFO | [pred] rf#1: |err| q99=12.4024  tail_n=3/261  tail_share_SSE=56.02%
2025-12-16 00:42:13,072 | INFO | [pred] rf#1: per-day mse days=19 p50=1.40136 p90=17.2539 p99=47.1268 max=52.5676
2025-12-16 00:42:13,095 | INFO | [pred] rf#2: n=261 R2_OS=0.09619 mse=6.17818 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.36 std=0.446 p1=-0.145 p99=1.45
2025-12-16 00:42:13,095 | INFO | [pred] rf#2: |err| q99=12.5708  tail_n=3/261  tail_share_SSE=56.67%
2025-12-16 00:42:13,097 | INFO | [pred] rf#2: per-day mse days=19 p50=1.00696 p90=16.4298 p99=47.1541 max=52.3598
2025-12-16 00:42:13,098 | INFO | [pred] lgbm_gbdt#1: n=261 R2_OS=0.08395 mse=6.2618 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.385 std=0.608 p1=-0.0638 p99=2.25
2025-12-16 00:42:13,098 | INFO | [pred] lgbm_gbdt#1: |err| q99=12.4958  tail_n=3/261  tail_share_SSE=56.00%
2025-12-16 00:42:13,100 | INFO | [pred] lgbm_gbdt#1: per-day mse days=19 p50=1.29261 p90=19.2831 p99=46.5415 max=51.5841
2025-12-16 00:42:13,101 | INFO | [pred] lgbm_gbdt#2: n=261 R2_OS=0.09503 mse=6.18608 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.335 std=0.539 p1=-0.113 p99=2.1
2025-12-16 00:42:13,101 | INFO | [pred] lgbm_gbdt#2: |err| q99=12.6518  tail_n=3/261  tail_share_SSE=57.04%
2025-12-16 00:42:13,103 | INFO | [pred] lgbm_gbdt#2: per-day mse days=19 p50=0.989486 p90=16.4999 p99=46.5089 max=51.3598
2025-12-16 00:42:13,104 | INFO | [pred] lgbm_dart#1: n=261 R2_OS=0.09358 mse=6.19602 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.276 std=0.446 p1=-0.179 p99=1.49
2025-12-16 00:42:13,104 | INFO | [pred] lgbm_dart#1: |err| q99=12.7238  tail_n=3/261  tail_share_SSE=57.41%
2025-12-16 00:42:13,106 | INFO | [pred] lgbm_dart#1: per-day mse days=19 p50=0.962686 p90=16.8358 p99=47.5286 max=52.5969
2025-12-16 00:42:13,107 | INFO | [pred] lgbm_dart#2: n=261 R2_OS=0.10922 mse=6.08907 mse0=6.83568 | y mean=0.482 std=2.57 | yhat mean=0.344 std=0.542 p1=-0.0759 p99=1.99
2025-12-16 00:42:13,107 | INFO | [pred] lgbm_dart#2: |err| q99=12.3853  tail_n=3/261  tail_share_SSE=56.71%
2025-12-16 00:42:13,109 | INFO | [pred] lgbm_dart#2: per-day mse days=19 p50=0.940728 p90=18.219 p99=46.6823 max=51.6671
