2025-12-12 20:57:46,342 | INFO | Loaded data: 13142 rows, 162 cols
2025-12-12 20:57:46,349 | INFO | After contract filters: 13142 rows
2025-12-12 20:57:46,356 | WARNING | Replacing 15 +/-inf values with NaN before splits.
2025-12-12 20:57:46,400 | INFO | [expanding] enabled=True | freq=M | min_train_months=38 | months_total=44
2025-12-12 20:57:46,410 | INFO | === Expanding step: train_to_2023-02__test_2023-03 ===
2025-12-12 20:57:46,410 | INFO | Step out_dir: results/dh_ret/all-all/IBMCTINTERACTIONS/monthly/2023-03
2025-12-12 20:57:46,410 | INFO | train_end=2023-02 | test_month=2023-03
2025-12-12 20:57:46,410 | INFO | Split sizes: train=4700 | val=716 | test=1111
2025-12-12 20:57:46,414 | INFO | [guardrails] transform=none
2025-12-12 20:57:46,414 | INFO | [guardrails] winsor z: lower_q=0.0100 (-1.55488), upper_q=0.9900 (5.93399)
2025-12-12 20:57:46,734 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-12 20:57:48,218 | INFO | [keep] ridge#1 score=-0.18862 params={'max_iter': np.int64(10000), 'alpha': 4.6692064912482625}
2025-12-12 20:57:48,224 | INFO | [keep] ridge#2 score=-0.18877 params={'max_iter': np.int64(10000), 'alpha': 4.927032682174098}
2025-12-12 20:58:18,636 | INFO | [keep] lasso#1 score=0.00859 params={'max_iter': np.int64(10000), 'alpha': 0.08432558817326784}
2025-12-12 20:58:18,642 | INFO | [keep] lasso#2 score=0.00828 params={'max_iter': np.int64(10000), 'alpha': 0.07634611079196907}
2025-12-12 20:58:52,650 | INFO | [keep] elasticnet#1 score=0.00831 params={'max_iter': np.int64(10000), 'alpha': 0.23948569385987084, 'l1_ratio': 0.36756187004789653}
2025-12-12 20:58:52,656 | INFO | [keep] elasticnet#2 score=0.00781 params={'max_iter': np.int64(10000), 'alpha': 0.8516144627787162, 'l1_ratio': 0.10204481074802807}
2025-12-12 20:58:53,110 | INFO | [keep] pcr#1 score=0.00440 params={'pca__n_components': 1, 'ridge__alpha': 1.0}
2025-12-12 20:58:53,118 | INFO | [keep] pcr#2 score=0.00440 params={'pca__n_components': 1, 'ridge__alpha': 0.1}
2025-12-12 20:58:53,198 | INFO | [keep] pls#1 score=-0.07092 params={'n_components': 2}
2025-12-12 20:58:53,204 | INFO | [keep] pls#2 score=-0.15111 params={'n_components': 1}
2025-12-12 20:58:53,204 | INFO | Training FFN: ['ffn']
2025-12-12 21:01:47,823 | INFO | [keep] ffn#1 score=0.00851 params={'ffn__activation': np.str_('gelu'), 'ffn__batch_size': np.int64(1024), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(128), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(5), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(1.0), 'ffn__dropout': 0.03177184646466966, 'ffn__weight_decay': 0.0007126197149987634}
2025-12-12 21:01:48,840 | INFO | [keep] ffn#2 score=0.00654 params={'ffn__activation': np.str_('gelu'), 'ffn__batch_size': np.int64(1024), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0005), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(5), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(1.0), 'ffn__dropout': 0.19563098100050666, 'ffn__weight_decay': 1.969043480269283e-05}
2025-12-12 21:01:48,840 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-12 21:05:59,662 | INFO | [keep] rf#1 score=0.01016 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.7, 'min_samples_leaf': 50, 'min_samples_split': 10, 'n_estimators': 1500}
2025-12-12 21:06:00,846 | INFO | [keep] rf#2 score=0.00990 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.7, 'min_samples_leaf': 50, 'min_samples_split': 2, 'n_estimators': 1000}
2025-12-12 21:06:16,600 | INFO | [keep] lgbm_gbdt#1 score=0.01748 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.01), 'max_bin': np.int64(127), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(800), 'num_leaves': np.int64(127), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 0.042444613236089244, 'reg_lambda': 0.0012073863726279688} | n_estimators(refit)=60
2025-12-12 21:06:16,838 | INFO | [keep] lgbm_gbdt#2 score=0.01642 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.01), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(2000), 'num_leaves': np.int64(127), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 3.144350681997742, 'reg_lambda': 0.01394969264149467} | n_estimators(refit)=81
2025-12-12 21:13:40,452 | INFO | [keep] lgbm_dart#1 score=0.01658 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.2), 'learning_rate': np.float64(0.01), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'max_drop': np.int64(10), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.001), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(2000), 'num_leaves': np.int64(127), 'skip_drop': np.float64(0.25), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.0002744715100024846, 'reg_lambda': 4.14703477353411e-06}
2025-12-12 21:13:42,862 | INFO | [keep] lgbm_dart#2 score=0.01520 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.1), 'learning_rate': np.float64(0.01), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'max_drop': np.int64(10), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.001), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(1200), 'num_leaves': np.int64(63), 'skip_drop': np.float64(0.1), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.12382412482913521, 'reg_lambda': 1.4787982649626883e-06}
2025-12-12 21:14:08,815 | INFO | === Expanding step: train_to_2023-03__test_2023-04 ===
2025-12-12 21:14:08,815 | INFO | Step out_dir: results/dh_ret/all-all/IBMCTINTERACTIONS/monthly/2023-04
2025-12-12 21:14:08,816 | INFO | train_end=2023-03 | test_month=2023-04
2025-12-12 21:14:08,816 | INFO | Split sizes: train=4789 | val=726 | test=983
2025-12-12 21:14:08,821 | INFO | [guardrails] transform=none
2025-12-12 21:14:08,821 | INFO | [guardrails] winsor z: lower_q=0.0100 (-1.55367), upper_q=0.9900 (5.95392)
2025-12-12 21:14:09,157 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-12 21:14:10,885 | INFO | [keep] ridge#1 score=-0.14121 params={'max_iter': np.int64(10000), 'alpha': 8.291189979207587}
2025-12-12 21:14:10,891 | INFO | [keep] ridge#2 score=-0.14532 params={'max_iter': np.int64(10000), 'alpha': 7.08481306320402}
2025-12-12 21:14:47,132 | INFO | [keep] lasso#1 score=0.01046 params={'max_iter': np.int64(10000), 'alpha': 0.07634611079196907}
2025-12-12 21:14:47,139 | INFO | [keep] lasso#2 score=0.01037 params={'max_iter': np.int64(10000), 'alpha': 0.08432558817326784}
2025-12-12 21:15:27,542 | INFO | [keep] elasticnet#1 score=0.00993 params={'max_iter': np.int64(10000), 'alpha': 0.23948569385987084, 'l1_ratio': 0.36756187004789653}
2025-12-12 21:15:27,547 | INFO | [keep] elasticnet#2 score=0.00946 params={'max_iter': np.int64(10000), 'alpha': 0.8516144627787162, 'l1_ratio': 0.10204481074802807}
2025-12-12 21:15:28,060 | INFO | [keep] pcr#1 score=0.00548 params={'pca__n_components': 1, 'ridge__alpha': 1.0}
2025-12-12 21:15:28,069 | INFO | [keep] pcr#2 score=0.00548 params={'pca__n_components': 1, 'ridge__alpha': 0.1}
2025-12-12 21:15:28,155 | INFO | [keep] pls#1 score=-0.04619 params={'n_components': 2}
2025-12-12 21:15:28,162 | INFO | [keep] pls#2 score=-0.09169 params={'n_components': 3}
2025-12-12 21:15:28,162 | INFO | Training FFN: ['ffn']
2025-12-12 21:19:45,106 | INFO | [keep] ffn#1 score=0.00315 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(512), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(0.5), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(20), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(0.5), 'ffn__dropout': 0.2428094914467595, 'ffn__weight_decay': 0.0001340004881783983}
2025-12-12 21:19:46,477 | INFO | [keep] ffn#2 score=0.00048 params={'ffn__activation': np.str_('gelu'), 'ffn__batch_size': np.int64(1024), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(32), 'ffn__huber_delta': np.float64(2.0), 'ffn__learning_rate': np.float64(0.0003), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(1.0), 'ffn__dropout': 0.010608730726647276, 'ffn__weight_decay': 1.9552726186680726e-05}
2025-12-12 21:19:46,481 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-12 21:24:05,594 | INFO | [keep] rf#1 score=0.01375 params={'bootstrap': True, 'max_depth': 12, 'max_features': 'sqrt', 'max_samples': 0.9, 'min_samples_leaf': 10, 'min_samples_split': 2, 'n_estimators': 600}
2025-12-12 21:24:06,850 | INFO | [keep] rf#2 score=0.01274 params={'bootstrap': True, 'max_depth': 12, 'max_features': 'log2', 'max_samples': 0.9, 'min_samples_leaf': 10, 'min_samples_split': 2, 'n_estimators': 1000}
2025-12-12 21:24:18,794 | INFO | [keep] lgbm_gbdt#1 score=0.01967 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.01), 'max_bin': np.int64(127), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(100), 'n_estimators': np.int64(800), 'num_leaves': np.int64(127), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.003620201338684272, 'reg_lambda': 5.899499127627508} | n_estimators(refit)=127
2025-12-12 21:24:18,897 | INFO | [keep] lgbm_gbdt#2 score=0.01798 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.005), 'max_bin': np.int64(63), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(2000), 'num_leaves': np.int64(31), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 0.0038614840301041614, 'reg_lambda': 0.011564582544083464} | n_estimators(refit)=118
2025-12-12 21:32:07,019 | INFO | [keep] lgbm_dart#1 score=0.02172 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.2), 'learning_rate': np.float64(0.01), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'max_drop': np.int64(10), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.001), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(2000), 'num_leaves': np.int64(127), 'skip_drop': np.float64(0.25), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.0002744715100024846, 'reg_lambda': 4.14703477353411e-06}
2025-12-12 21:32:10,991 | INFO | [keep] lgbm_dart#2 score=0.01839 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'drop_rate': np.float64(0.1), 'learning_rate': np.float64(0.005), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'max_drop': np.int64(10), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.1), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(1200), 'num_leaves': np.int64(63), 'skip_drop': np.float64(0.25), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 0.49630716834181543, 'reg_lambda': 0.003703824297251048}
2025-12-12 21:32:31,577 | INFO | === Expanding step: train_to_2023-04__test_2023-05 ===
2025-12-12 21:32:31,577 | INFO | Step out_dir: results/dh_ret/all-all/IBMCTINTERACTIONS/monthly/2023-05
2025-12-12 21:32:31,577 | INFO | train_end=2023-04 | test_month=2023-05
2025-12-12 21:32:31,577 | INFO | Split sizes: train=4842 | val=729 | test=1135
2025-12-12 21:32:31,581 | INFO | [guardrails] transform=none
2025-12-12 21:32:31,582 | INFO | [guardrails] winsor z: lower_q=0.0100 (-1.54935), upper_q=0.9900 (5.92553)
2025-12-12 21:32:31,917 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-12 21:32:33,614 | INFO | [keep] ridge#1 score=-0.15009 params={'max_iter': np.int64(10000), 'alpha': 5.567232047731109}
2025-12-12 21:32:33,620 | INFO | [keep] ridge#2 score=-0.15034 params={'max_iter': np.int64(10000), 'alpha': 6.842522829851383}
2025-12-12 21:33:10,287 | INFO | [keep] lasso#1 score=0.01108 params={'max_iter': np.int64(10000), 'alpha': 0.07634611079196907}
2025-12-12 21:33:10,296 | INFO | [keep] lasso#2 score=0.01068 params={'max_iter': np.int64(10000), 'alpha': 0.08432558817326784}
2025-12-12 21:33:48,554 | INFO | [keep] elasticnet#1 score=0.01025 params={'max_iter': np.int64(10000), 'alpha': 0.23948569385987084, 'l1_ratio': 0.36756187004789653}
2025-12-12 21:33:48,560 | INFO | [keep] elasticnet#2 score=0.00974 params={'max_iter': np.int64(10000), 'alpha': 0.8516144627787162, 'l1_ratio': 0.10204481074802807}
2025-12-12 21:33:49,051 | INFO | [keep] pcr#1 score=0.00537 params={'pca__n_components': 1, 'ridge__alpha': 1.0}
2025-12-12 21:33:49,059 | INFO | [keep] pcr#2 score=0.00537 params={'pca__n_components': 1, 'ridge__alpha': 0.1}
2025-12-12 21:33:49,146 | INFO | [keep] pls#1 score=-0.06422 params={'n_components': 2}
2025-12-12 21:33:49,153 | INFO | [keep] pls#2 score=-0.11386 params={'n_components': 3}
2025-12-12 21:33:49,153 | INFO | Training FFN: ['ffn']
2025-12-12 21:37:03,406 | INFO | [keep] ffn#1 score=0.00736 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(1024), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(0.5), 'ffn__learning_rate': np.float64(0.0005), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(5), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(0.5), 'ffn__dropout': 0.16406547050082665, 'ffn__weight_decay': 6.6752987880661055e-06}
2025-12-12 21:37:06,527 | INFO | [keep] ffn#2 score=0.00704 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(512), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(2.0), 'ffn__learning_rate': np.float64(0.001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(20), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(0.5), 'ffn__dropout': 0.12468247828057727, 'ffn__weight_decay': 0.0006454332349976913}
2025-12-12 21:37:06,528 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-12 21:41:20,717 | INFO | [keep] rf#1 score=0.01303 params={'bootstrap': True, 'max_depth': 12, 'max_features': 'sqrt', 'max_samples': 0.5, 'min_samples_leaf': 20, 'min_samples_split': 2, 'n_estimators': 600}
2025-12-12 21:41:22,175 | INFO | [keep] rf#2 score=0.01231 params={'bootstrap': True, 'max_depth': 12, 'max_features': 'log2', 'max_samples': 0.9, 'min_samples_leaf': 10, 'min_samples_split': 2, 'n_estimators': 1000}
2025-12-12 21:41:34,219 | INFO | [keep] lgbm_gbdt#1 score=0.01778 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(63), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(800), 'num_leaves': np.int64(63), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 0.01985005396378788, 'reg_lambda': 0.005616032613563234} | n_estimators(refit)=33
2025-12-12 21:41:34,327 | INFO | [keep] lgbm_gbdt#2 score=0.01711 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.005), 'max_bin': np.int64(63), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(2000), 'num_leaves': np.int64(31), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 0.0038614840301041614, 'reg_lambda': 0.011564582544083464} | n_estimators(refit)=106
2025-12-12 21:49:48,479 | INFO | [keep] lgbm_dart#1 score=0.01792 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.2), 'learning_rate': np.float64(0.01), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'max_drop': np.int64(10), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.001), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(2000), 'num_leaves': np.int64(127), 'skip_drop': np.float64(0.25), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.0002744715100024846, 'reg_lambda': 4.14703477353411e-06}
2025-12-12 21:49:50,426 | INFO | [keep] lgbm_dart#2 score=0.01537 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.2), 'learning_rate': np.float64(0.005), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'max_drop': np.int64(10), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.01), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(800), 'num_leaves': np.int64(127), 'skip_drop': np.float64(0.5), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 0.05486707083399466, 'reg_lambda': 0.0014682254745165147}
2025-12-12 21:50:07,504 | INFO | === Expanding step: train_to_2023-05__test_2023-06 ===
2025-12-12 21:50:07,504 | INFO | Step out_dir: results/dh_ret/all-all/IBMCTINTERACTIONS/monthly/2023-06
2025-12-12 21:50:07,504 | INFO | train_end=2023-05 | test_month=2023-06
2025-12-12 21:50:07,504 | INFO | Split sizes: train=4999 | val=704 | test=1104
2025-12-12 21:50:07,508 | INFO | [guardrails] transform=none
2025-12-12 21:50:07,508 | INFO | [guardrails] winsor z: lower_q=0.0100 (-1.55354), upper_q=0.9900 (5.9358)
2025-12-12 21:50:07,854 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-12 21:50:09,687 | INFO | [keep] ridge#1 score=-0.17077 params={'max_iter': np.int64(10000), 'alpha': 3.014230555820276}
2025-12-12 21:50:09,695 | INFO | [keep] ridge#2 score=-0.17118 params={'max_iter': np.int64(10000), 'alpha': 3.19943567483872}
2025-12-12 21:50:41,753 | INFO | [keep] lasso#1 score=0.01232 params={'max_iter': np.int64(10000), 'alpha': 0.07634611079196907}
2025-12-12 21:50:41,761 | INFO | [keep] lasso#2 score=0.01180 params={'max_iter': np.int64(10000), 'alpha': 0.08432558817326784}
2025-12-12 21:51:17,408 | INFO | [keep] elasticnet#1 score=0.01137 params={'max_iter': np.int64(10000), 'alpha': 0.23948569385987084, 'l1_ratio': 0.36756187004789653}
2025-12-12 21:51:17,414 | INFO | [keep] elasticnet#2 score=0.01097 params={'max_iter': np.int64(10000), 'alpha': 0.8516144627787162, 'l1_ratio': 0.10204481074802807}
2025-12-12 21:51:17,945 | INFO | [keep] pcr#1 score=0.00690 params={'pca__n_components': 1, 'ridge__alpha': 1.0}
2025-12-12 21:51:17,954 | INFO | [keep] pcr#2 score=0.00690 params={'pca__n_components': 1, 'ridge__alpha': 0.1}
2025-12-12 21:51:18,052 | INFO | [keep] pls#1 score=-0.06885 params={'n_components': 2}
2025-12-12 21:51:18,060 | INFO | [keep] pls#2 score=-0.11044 params={'n_components': 3}
2025-12-12 21:51:18,061 | INFO | Training FFN: ['ffn']
2025-12-12 21:54:45,259 | INFO | [keep] ffn#1 score=0.01282 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(1024), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(0.5), 'ffn__learning_rate': np.float64(0.0005), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(5), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(0.5), 'ffn__dropout': 0.16406547050082665, 'ffn__weight_decay': 6.6752987880661055e-06}
2025-12-12 21:54:47,634 | INFO | [keep] ffn#2 score=0.01222 params={'ffn__activation': np.str_('gelu'), 'ffn__batch_size': np.int64(1024), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(2.0), 'ffn__learning_rate': np.float64(0.0003), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(20), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(1.0), 'ffn__dropout': 0.11332555178774427, 'ffn__weight_decay': 3.4578888773166634e-06}
2025-12-12 21:54:47,638 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-12 21:59:02,394 | INFO | [keep] rf#1 score=0.01790 params={'bootstrap': True, 'max_depth': 12, 'max_features': 'log2', 'max_samples': 0.5, 'min_samples_leaf': 10, 'min_samples_split': 10, 'n_estimators': 1500}
2025-12-12 21:59:03,791 | INFO | [keep] rf#2 score=0.01784 params={'bootstrap': True, 'max_depth': 12, 'max_features': 'sqrt', 'max_samples': 0.5, 'min_samples_leaf': 10, 'min_samples_split': 10, 'n_estimators': 1000}
2025-12-12 21:59:22,932 | INFO | [keep] lgbm_gbdt#1 score=0.03049 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(1.0), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(100), 'n_estimators': np.int64(1200), 'num_leaves': np.int64(63), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 0.20431928975893546, 'reg_lambda': 5.512558995333183e-06} | n_estimators(refit)=173
2025-12-12 21:59:23,023 | INFO | [keep] lgbm_gbdt#2 score=0.02833 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(1.0), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(127), 'max_depth': np.int64(4), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(1200), 'num_leaves': np.int64(31), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.00028278139120020197, 'reg_lambda': 4.670239773312262e-06} | n_estimators(refit)=161
2025-12-12 22:07:32,551 | INFO | [keep] lgbm_dart#1 score=0.02529 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.2), 'learning_rate': np.float64(0.01), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'max_drop': np.int64(10), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.001), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(2000), 'num_leaves': np.int64(127), 'skip_drop': np.float64(0.25), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.0002744715100024846, 'reg_lambda': 4.14703477353411e-06}
2025-12-12 22:07:35,561 | INFO | [keep] lgbm_dart#2 score=0.02206 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'drop_rate': np.float64(0.2), 'learning_rate': np.float64(0.005), 'max_bin': np.int64(63), 'max_depth': np.int64(-1), 'max_drop': np.int64(10), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.001), 'min_split_gain': np.float64(0.05), 'n_estimators': np.int64(2000), 'num_leaves': np.int64(63), 'skip_drop': np.float64(0.5), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 0.00011909508958818801, 'reg_lambda': 8.79181829862466}
2025-12-12 22:08:01,447 | INFO | === Expanding step: train_to_2023-06__test_2023-07 ===
2025-12-12 22:08:01,447 | INFO | Step out_dir: results/dh_ret/all-all/IBMCTINTERACTIONS/monthly/2023-07
2025-12-12 22:08:01,447 | INFO | train_end=2023-06 | test_month=2023-07
2025-12-12 22:08:01,447 | INFO | Split sizes: train=5134 | val=924 | test=817
2025-12-12 22:08:01,451 | INFO | [guardrails] transform=none
2025-12-12 22:08:01,451 | INFO | [guardrails] winsor z: lower_q=0.0100 (-1.55149), upper_q=0.9900 (5.92683)
2025-12-12 22:08:01,804 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-12 22:08:03,403 | INFO | [keep] ridge#1 score=-0.11707 params={'max_iter': np.int64(10000), 'alpha': 8.291189979207587}
2025-12-12 22:08:03,410 | INFO | [keep] ridge#2 score=-0.12111 params={'max_iter': np.int64(10000), 'alpha': 7.08481306320402}
2025-12-12 22:08:28,192 | INFO | [keep] lasso#1 score=0.01062 params={'max_iter': np.int64(10000), 'alpha': 0.06236650188352654}
2025-12-12 22:08:28,199 | INFO | [keep] lasso#2 score=0.01061 params={'max_iter': np.int64(10000), 'alpha': 0.07634611079196907}
2025-12-12 22:08:58,308 | INFO | [keep] elasticnet#1 score=0.00967 params={'max_iter': np.int64(10000), 'alpha': 0.23948569385987084, 'l1_ratio': 0.36756187004789653}
2025-12-12 22:08:58,315 | INFO | [keep] elasticnet#2 score=0.00918 params={'max_iter': np.int64(10000), 'alpha': 0.8516144627787162, 'l1_ratio': 0.10204481074802807}
2025-12-12 22:08:58,887 | INFO | [keep] pcr#1 score=0.00442 params={'pca__n_components': 1, 'ridge__alpha': 1.0}
2025-12-12 22:08:58,898 | INFO | [keep] pcr#2 score=0.00442 params={'pca__n_components': 1, 'ridge__alpha': 0.1}
2025-12-12 22:08:59,009 | INFO | [keep] pls#1 score=-0.02386 params={'n_components': 2}
2025-12-12 22:08:59,017 | INFO | [keep] pls#2 score=-0.04655 params={'n_components': 3}
2025-12-12 22:08:59,017 | INFO | Training FFN: ['ffn']
2025-12-12 22:13:03,026 | INFO | [keep] ffn#1 score=0.00795 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(1024), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(128), 'ffn__huber_delta': np.float64(0.5), 'ffn__learning_rate': np.float64(0.0003), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(5), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(0.5), 'ffn__dropout': 0.2534560750801521, 'ffn__weight_decay': 3.391438919981466e-05}
2025-12-12 22:13:04,148 | INFO | [keep] ffn#2 score=0.00763 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(512), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(2.0), 'ffn__learning_rate': np.float64(0.001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(20), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(1.0), 'ffn__dropout': 0.08654293111455859, 'ffn__weight_decay': 1.9946384472763202e-05}
2025-12-12 22:13:04,148 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-12 22:17:08,648 | INFO | [keep] rf#1 score=0.01206 params={'bootstrap': True, 'max_depth': 12, 'max_features': 'log2', 'max_samples': 0.7, 'min_samples_leaf': 20, 'min_samples_split': 2, 'n_estimators': 600}
2025-12-12 22:17:10,821 | INFO | [keep] rf#2 score=0.01178 params={'bootstrap': True, 'max_depth': 12, 'max_features': 'log2', 'max_samples': 0.9, 'min_samples_leaf': 20, 'min_samples_split': 5, 'n_estimators': 1500}
2025-12-12 22:17:26,728 | INFO | [keep] lgbm_gbdt#1 score=0.01856 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.01), 'max_bin': np.int64(127), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(800), 'num_leaves': np.int64(127), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 0.042444613236089244, 'reg_lambda': 0.0012073863726279688} | n_estimators(refit)=106
2025-12-12 22:17:27,235 | INFO | [keep] lgbm_gbdt#2 score=0.01730 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.005), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(3000), 'num_leaves': np.int64(63), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.49133425416186965, 'reg_lambda': 6.816785745902279} | n_estimators(refit)=219
2025-12-12 22:24:26,884 | INFO | [keep] lgbm_dart#1 score=0.01436 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.05), 'learning_rate': np.float64(0.003), 'max_bin': np.int64(127), 'max_depth': np.int64(-1), 'max_drop': np.int64(50), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.1), 'min_split_gain': np.float64(0.0), 'n_estimators': np.int64(1200), 'num_leaves': np.int64(63), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 3.093731730342483, 'reg_lambda': 1.5946590546637215e-06}
2025-12-12 22:24:36,142 | INFO | [keep] lgbm_dart#2 score=0.01385 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.2), 'learning_rate': np.float64(0.005), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'max_drop': np.int64(10), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.001), 'min_split_gain': np.float64(0.0), 'n_estimators': np.int64(3000), 'num_leaves': np.int64(127), 'skip_drop': np.float64(0.1), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.06927184499120616, 'reg_lambda': 5.785303828922974e-06}
2025-12-12 22:24:57,892 | INFO | === Expanding step: train_to_2023-07__test_2023-08 ===
2025-12-12 22:24:57,893 | INFO | Step out_dir: results/dh_ret/all-all/IBMCTINTERACTIONS/monthly/2023-08
2025-12-12 22:24:57,893 | INFO | train_end=2023-07 | test_month=2023-08
2025-12-12 22:24:57,893 | INFO | Split sizes: train=5288 | val=1345 | test=860
2025-12-12 22:24:57,897 | INFO | [guardrails] transform=none
2025-12-12 22:24:57,897 | INFO | [guardrails] winsor z: lower_q=0.0100 (-1.54405), upper_q=0.9900 (5.91806)
2025-12-12 22:24:58,242 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-12 22:24:59,951 | INFO | [keep] ridge#1 score=-0.12416 params={'max_iter': np.int64(10000), 'alpha': 8.291189979207587}
2025-12-12 22:24:59,958 | INFO | [keep] ridge#2 score=-0.12548 params={'max_iter': np.int64(10000), 'alpha': 7.08481306320402}
2025-12-12 22:25:20,863 | INFO | [keep] lasso#1 score=0.01220 params={'max_iter': np.int64(10000), 'alpha': 0.06236650188352654}
2025-12-12 22:25:20,870 | INFO | [keep] lasso#2 score=0.01154 params={'max_iter': np.int64(10000), 'alpha': 0.05627949975223145}
2025-12-12 22:25:45,520 | INFO | [keep] elasticnet#1 score=0.01031 params={'max_iter': np.int64(10000), 'alpha': 0.23948569385987084, 'l1_ratio': 0.36756187004789653}
2025-12-12 22:25:45,527 | INFO | [keep] elasticnet#2 score=0.00993 params={'max_iter': np.int64(10000), 'alpha': 0.06873278384941513, 'l1_ratio': 0.7038885835403663}
2025-12-12 22:25:46,027 | INFO | [keep] pcr#1 score=-0.00116 params={'pca__n_components': 1, 'ridge__alpha': 1.0}
2025-12-12 22:25:46,035 | INFO | [keep] pcr#2 score=-0.00116 params={'pca__n_components': 1, 'ridge__alpha': 0.1}
2025-12-12 22:25:46,125 | INFO | [keep] pls#1 score=-0.03145 params={'n_components': 2}
2025-12-12 22:25:46,132 | INFO | [keep] pls#2 score=-0.03653 params={'n_components': 1}
2025-12-12 22:25:46,132 | INFO | Training FFN: ['ffn']
2025-12-12 22:29:07,971 | INFO | [keep] ffn#1 score=0.00762 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(512), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(2.0), 'ffn__learning_rate': np.float64(0.001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(20), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(1.0), 'ffn__dropout': 0.08654293111455859, 'ffn__weight_decay': 1.9946384472763202e-05}
2025-12-12 22:29:09,136 | INFO | [keep] ffn#2 score=0.00391 params={'ffn__activation': np.str_('gelu'), 'ffn__batch_size': np.int64(1024), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0005), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(2), 'ffn__patience': np.int64(5), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(1.0), 'ffn__dropout': 0.006592090647876525, 'ffn__weight_decay': 1.3312453834558391e-05}
2025-12-12 22:29:09,136 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-12 22:33:45,288 | INFO | [keep] rf#1 score=0.01395 params={'bootstrap': True, 'max_depth': 12, 'max_features': 'sqrt', 'max_samples': 0.5, 'min_samples_leaf': 50, 'min_samples_split': 2, 'n_estimators': 1000}
2025-12-12 22:33:47,546 | INFO | [keep] rf#2 score=0.01386 params={'bootstrap': True, 'max_depth': 12, 'max_features': 'sqrt', 'max_samples': 0.7, 'min_samples_leaf': 20, 'min_samples_split': 10, 'n_estimators': 1500}
2025-12-12 22:34:02,052 | INFO | [keep] lgbm_gbdt#1 score=0.02244 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.005), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(3000), 'num_leaves': np.int64(63), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.49133425416186965, 'reg_lambda': 6.816785745902279} | n_estimators(refit)=266
2025-12-12 22:34:02,191 | INFO | [keep] lgbm_gbdt#2 score=0.02169 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(2000), 'num_leaves': np.int64(63), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 4.266367845929973e-05, 'reg_lambda': 0.0033418888058123737} | n_estimators(refit)=61
2025-12-12 22:41:07,720 | INFO | [keep] lgbm_dart#1 score=0.01623 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.05), 'learning_rate': np.float64(0.003), 'max_bin': np.int64(127), 'max_depth': np.int64(-1), 'max_drop': np.int64(50), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.1), 'min_split_gain': np.float64(0.0), 'n_estimators': np.int64(1200), 'num_leaves': np.int64(63), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 3.093731730342483, 'reg_lambda': 1.5946590546637215e-06}
2025-12-12 22:41:18,168 | INFO | [keep] lgbm_dart#2 score=0.01588 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.2), 'learning_rate': np.float64(0.005), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'max_drop': np.int64(10), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.001), 'min_split_gain': np.float64(0.0), 'n_estimators': np.int64(3000), 'num_leaves': np.int64(127), 'skip_drop': np.float64(0.1), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.06927184499120616, 'reg_lambda': 5.785303828922974e-06}
2025-12-12 22:41:48,971 | INFO | Wrote expanding predictions: results/dh_ret/all-all/IBMCTINTERACTIONS/predictions_expanding.csv
2025-12-12 22:41:48,971 | INFO | Wrote steps summary: results/dh_ret/all-all/IBMCTINTERACTIONS/steps_summary.json
2025-12-12 22:42:22,075 | INFO | Variant complete (expanding monthly). Yay! :)
