2025-12-16 09:22:34,838 | INFO | Loaded data: 21203 rows, 157 cols
2025-12-16 09:22:34,859 | INFO | After contract filters: 21203 rows
2025-12-16 09:22:34,885 | WARNING | Replacing 12 +/-inf values with NaN before splits.
2025-12-16 09:22:34,973 | INFO | [expanding] enabled=True | freq=M | min_train_months=38 | months_total=44
2025-12-16 09:22:34,973 | INFO | [weighting] Sample weights enabled. Column='mid_t', Clip=[10, 5000.0]
2025-12-16 09:22:34,996 | INFO | === Expanding step: train_to_2023-02__test_2023-03 ===
2025-12-16 09:22:35,004 | INFO | [guardrails] transform=none
2025-12-16 09:22:35,004 | INFO | [guardrails] winsor z: lower_q=0.0050 (-1.66476), upper_q=0.9950 (16.0882)
2025-12-16 09:22:35,514 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-16 09:22:38,662 | INFO | [keep] ridge#1 score=-0.04988 params={'max_iter': np.int64(10000), 'alpha': 92.28295957427436}
2025-12-16 09:22:38,674 | INFO | [keep] ridge#2 score=-0.05460 params={'max_iter': np.int64(10000), 'alpha': 86.26905220714896}
2025-12-16 09:22:44,940 | INFO | [keep] lasso#1 score=0.06180 params={'max_iter': np.int64(10000), 'alpha': 0.014135935551752304}
2025-12-16 09:22:44,955 | INFO | [keep] lasso#2 score=0.06180 params={'max_iter': np.int64(10000), 'alpha': 0.01276954761904551}
2025-12-16 09:22:53,729 | INFO | [keep] elasticnet#1 score=0.06202 params={'max_iter': np.int64(10000), 'alpha': 0.023358825194833552, 'l1_ratio': 0.5547471590949188}
2025-12-16 09:22:53,815 | INFO | [keep] elasticnet#2 score=0.06171 params={'max_iter': np.int64(10000), 'alpha': 0.018662266976517967, 'l1_ratio': 0.6167152904533248}
2025-12-16 09:22:54,673 | INFO | [keep] pcr#1 score=0.00496 params={'pca__n_components': 6, 'ridge__alpha': 0.0001}
2025-12-16 09:22:54,687 | INFO | [keep] pcr#2 score=0.00496 params={'pca__n_components': 6, 'ridge__alpha': 0.001}
2025-12-16 09:22:54,848 | INFO | [keep] pls#1 score=0.03423 params={'n_components': 3}
2025-12-16 09:22:54,862 | INFO | [keep] pls#2 score=0.01739 params={'n_components': 4}
2025-12-16 09:22:54,862 | INFO | Training FFN: ['ffn']
2025-12-16 10:05:39,352 | INFO | [keep] ffn#1 score=0.05620 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(64), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.47878885927286424, 'ffn__weight_decay': 0.004336485563242767}
2025-12-16 10:05:54,411 | INFO | [keep] ffn#2 score=0.05590 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(64), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.4731634167180391, 'ffn__weight_decay': 0.0014653571755444989}
2025-12-16 10:05:54,411 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-16 10:06:47,949 | INFO | [keep] rf#1 score=0.07855 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.6, 'min_samples_leaf': 20, 'n_estimators': 200}
2025-12-16 10:06:48,410 | INFO | [keep] rf#2 score=0.07832 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'log2', 'max_samples': 0.6, 'min_samples_leaf': 20, 'n_estimators': 200}
2025-12-16 10:07:01,911 | INFO | [keep] lgbm_gbdt#1 score=0.08665 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'learning_rate': np.float64(0.1), 'max_bin': np.int64(127), 'max_depth': np.int64(4), 'min_child_samples': np.int64(100), 'n_estimators': np.int64(200), 'num_leaves': np.int64(15), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.26593836708988355, 'reg_lambda': 0.2785392800820963} | n_estimators(refit)=24
2025-12-16 10:07:01,960 | INFO | [keep] lgbm_gbdt#2 score=0.08540 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'learning_rate': np.float64(0.1), 'max_bin': np.int64(63), 'max_depth': np.int64(6), 'min_child_samples': np.int64(200), 'n_estimators': np.int64(200), 'num_leaves': np.int64(15), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 2.557273434307698, 'reg_lambda': 0.15865500409725955} | n_estimators(refit)=22
2025-12-16 10:07:34,606 | INFO | [keep] lgbm_dart#1 score=0.09377 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'drop_rate': np.float64(0.3), 'learning_rate': np.float64(0.1), 'max_bin': np.int64(63), 'max_depth': np.int64(4), 'max_drop': np.int64(20), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.1), 'min_split_gain': np.float64(0.05), 'n_estimators': np.int64(100), 'num_leaves': np.int64(31), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 13.201261326847794, 'reg_lambda': 8.883879772755321}
2025-12-16 10:07:35,302 | INFO | [keep] lgbm_dart#2 score=0.09277 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'drop_rate': np.float64(0.3), 'learning_rate': np.float64(0.05), 'max_bin': np.int64(127), 'max_depth': np.int64(6), 'max_drop': np.int64(20), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.1), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'skip_drop': np.float64(0.3), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.11331543612010862, 'reg_lambda': 5.912295566997817}
2025-12-16 10:07:35,303 | INFO | [pred] ridge#1: n=682 R2_OS=0.08973 mse=11.1155 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.302 std=0.39 p1=-0.605 p99=1.32
2025-12-16 10:07:35,303 | INFO | [pred] ridge#1: |err| q99=16.7543  tail_n=7/682  tail_share_SSE=36.89%
2025-12-16 10:07:35,306 | INFO | [pred] ridge#1: per-day mse days=21 p50=0.963829 p90=46.3673 p99=64.3039 max=67.0887
2025-12-16 10:07:35,306 | INFO | [pred] ridge#2: n=682 R2_OS=0.08991 mse=11.1133 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.302 std=0.391 p1=-0.608 p99=1.33
2025-12-16 10:07:35,306 | INFO | [pred] ridge#2: |err| q99=16.7524  tail_n=7/682  tail_share_SSE=36.90%
2025-12-16 10:07:35,308 | INFO | [pred] ridge#2: per-day mse days=21 p50=0.964255 p90=46.3538 p99=64.3039 max=67.0922
2025-12-16 10:07:35,309 | INFO | [pred] lasso#1: n=682 R2_OS=0.07015 mse=11.3547 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.27 std=0.234 p1=-0.185 p99=0.743
2025-12-16 10:07:35,309 | INFO | [pred] lasso#1: |err| q99=16.8365  tail_n=7/682  tail_share_SSE=37.09%
2025-12-16 10:07:35,311 | INFO | [pred] lasso#1: per-day mse days=21 p50=0.780378 p90=47.0673 p99=65.8527 max=68.3532
2025-12-16 10:07:35,311 | INFO | [pred] lasso#2: n=682 R2_OS=0.07057 mse=11.3495 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.271 std=0.238 p1=-0.194 p99=0.755
2025-12-16 10:07:35,311 | INFO | [pred] lasso#2: |err| q99=16.8394  tail_n=7/682  tail_share_SSE=37.07%
2025-12-16 10:07:35,313 | INFO | [pred] lasso#2: per-day mse days=21 p50=0.783204 p90=47.0223 p99=65.7284 max=68.2123
2025-12-16 10:07:35,314 | INFO | [pred] elasticnet#1: n=682 R2_OS=0.06996 mse=11.357 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.268 std=0.236 p1=-0.189 p99=0.746
2025-12-16 10:07:35,314 | INFO | [pred] elasticnet#1: |err| q99=16.8426  tail_n=7/682  tail_share_SSE=37.06%
2025-12-16 10:07:35,316 | INFO | [pred] elasticnet#1: per-day mse days=21 p50=0.777437 p90=47.0812 p99=65.7947 max=68.2861
2025-12-16 10:07:35,316 | INFO | [pred] elasticnet#2: n=682 R2_OS=0.07073 mse=11.3475 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.27 std=0.241 p1=-0.196 p99=0.76
2025-12-16 10:07:35,317 | INFO | [pred] elasticnet#2: |err| q99=16.8425  tail_n=7/682  tail_share_SSE=37.04%
2025-12-16 10:07:35,319 | INFO | [pred] elasticnet#2: per-day mse days=21 p50=0.783452 p90=47.0456 p99=65.6535 max=68.1402
2025-12-16 10:07:35,319 | INFO | [pred] pcr#1: n=682 R2_OS=0.02958 mse=11.8501 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.0928 std=0.163 p1=-0.253 p99=0.487
2025-12-16 10:07:35,319 | INFO | [pred] pcr#1: |err| q99=16.9919  tail_n=7/682  tail_share_SSE=36.85%
2025-12-16 10:07:35,321 | INFO | [pred] pcr#1: per-day mse days=21 p50=0.750965 p90=50.3727 p99=70.0027 max=72.9945
2025-12-16 10:07:35,322 | INFO | [pred] pcr#2: n=682 R2_OS=0.02958 mse=11.8501 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.0928 std=0.163 p1=-0.253 p99=0.487
2025-12-16 10:07:35,322 | INFO | [pred] pcr#2: |err| q99=16.9919  tail_n=7/682  tail_share_SSE=36.85%
2025-12-16 10:07:35,324 | INFO | [pred] pcr#2: per-day mse days=21 p50=0.750965 p90=50.3727 p99=70.0027 max=72.9945
2025-12-16 10:07:35,325 | INFO | [pred] pls#1: n=682 R2_OS=0.15549 mse=10.3126 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.574 std=0.64 p1=-0.61 p99=1.89
2025-12-16 10:07:35,325 | INFO | [pred] pls#1: |err| q99=15.7193  tail_n=7/682  tail_share_SSE=37.13%
2025-12-16 10:07:35,327 | INFO | [pred] pls#1: per-day mse days=21 p50=1.73596 p90=41.1936 p99=60.0914 max=63.1003
2025-12-16 10:07:35,327 | INFO | [pred] pls#2: n=682 R2_OS=0.16340 mse=10.2159 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.597 std=0.632 p1=-0.649 p99=1.96
2025-12-16 10:07:35,327 | INFO | [pred] pls#2: |err| q99=15.6536  tail_n=7/682  tail_share_SSE=37.49%
2025-12-16 10:07:35,329 | INFO | [pred] pls#2: per-day mse days=21 p50=1.62726 p90=40.3174 p99=59.686 max=62.5839
2025-12-16 10:07:35,331 | INFO | [pred] L-En: n=682 R2_OS=0.09006 mse=11.1115 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.304 std=0.299 p1=-0.257 p99=0.902
2025-12-16 10:07:35,331 | INFO | [pred] L-En: |err| q99=16.6312  tail_n=7/682  tail_share_SSE=37.25%
2025-12-16 10:07:35,333 | INFO | [pred] L-En: per-day mse days=21 p50=0.892292 p90=46.2379 p99=65.0064 max=67.7608
2025-12-16 10:07:35,335 | INFO | [pred] ffn#1: n=682 R2_OS=0.13617 mse=10.5485 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.451 std=0.587 p1=-0.617 p99=1.93
2025-12-16 10:07:35,336 | INFO | [pred] ffn#1: |err| q99=16.0955  tail_n=7/682  tail_share_SSE=36.41%
2025-12-16 10:07:35,338 | INFO | [pred] ffn#1: per-day mse days=21 p50=1.4049 p90=43.4295 p99=58.4685 max=60.9734
2025-12-16 10:07:35,340 | INFO | [pred] ffn#2: n=682 R2_OS=0.13709 mse=10.5372 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.455 std=0.591 p1=-0.614 p99=1.94
2025-12-16 10:07:35,340 | INFO | [pred] ffn#2: |err| q99=16.0876  tail_n=7/682  tail_share_SSE=36.42%
2025-12-16 10:07:35,342 | INFO | [pred] ffn#2: per-day mse days=21 p50=1.42891 p90=43.3448 p99=58.4531 max=60.9663
2025-12-16 10:07:35,366 | INFO | [pred] rf#1: n=682 R2_OS=0.19273 mse=9.85783 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.528 std=0.627 p1=-0.0653 p99=2.48
2025-12-16 10:07:35,366 | INFO | [pred] rf#1: |err| q99=15.3639  tail_n=7/682  tail_share_SSE=38.55%
2025-12-16 10:07:35,368 | INFO | [pred] rf#1: per-day mse days=21 p50=1.14494 p90=38.0076 p99=61.6815 max=65.3273
2025-12-16 10:07:35,392 | INFO | [pred] rf#2: n=682 R2_OS=0.15553 mse=10.3121 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.481 std=0.478 p1=-0.0435 p99=1.83
2025-12-16 10:07:35,392 | INFO | [pred] rf#2: |err| q99=16.0084  tail_n=7/682  tail_share_SSE=37.92%
2025-12-16 10:07:35,394 | INFO | [pred] rf#2: per-day mse days=21 p50=1.01994 p90=40.7282 p99=63.2037 max=66.6742
2025-12-16 10:07:35,395 | INFO | [pred] lgbm_gbdt#1: n=682 R2_OS=0.18088 mse=10.0025 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.467 std=0.628 p1=-0.0967 p99=2.35
2025-12-16 10:07:35,396 | INFO | [pred] lgbm_gbdt#1: |err| q99=15.7212  tail_n=7/682  tail_share_SSE=38.31%
2025-12-16 10:07:35,398 | INFO | [pred] lgbm_gbdt#1: per-day mse days=21 p50=1.30791 p90=39.2578 p99=62.526 max=66.5057
2025-12-16 10:07:35,399 | INFO | [pred] lgbm_gbdt#2: n=682 R2_OS=0.18048 mse=10.0073 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.471 std=0.65 p1=-0.148 p99=2.21
2025-12-16 10:07:35,399 | INFO | [pred] lgbm_gbdt#2: |err| q99=15.423  tail_n=7/682  tail_share_SSE=38.31%
2025-12-16 10:07:35,401 | INFO | [pred] lgbm_gbdt#2: per-day mse days=21 p50=1.57488 p90=39.7253 p99=61.9192 max=65.2764
2025-12-16 10:07:35,402 | INFO | [pred] lgbm_dart#1: n=682 R2_OS=0.13462 mse=10.5674 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.345 std=0.454 p1=-0.0593 p99=1.57
2025-12-16 10:07:35,402 | INFO | [pred] lgbm_dart#1: |err| q99=16.2303  tail_n=7/682  tail_share_SSE=37.69%
2025-12-16 10:07:35,404 | INFO | [pred] lgbm_dart#1: per-day mse days=21 p50=1.09775 p90=43.2057 p99=63.3691 max=66.427
2025-12-16 10:07:35,406 | INFO | [pred] lgbm_dart#2: n=682 R2_OS=0.14867 mse=10.3958 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.345 std=0.47 p1=-0.14 p99=1.93
2025-12-16 10:07:35,407 | INFO | [pred] lgbm_dart#2: |err| q99=16.1204  tail_n=7/682  tail_share_SSE=38.46%
2025-12-16 10:07:35,409 | INFO | [pred] lgbm_dart#2: per-day mse days=21 p50=0.967034 p90=41.6099 p99=63.2336 max=65.8755
2025-12-16 10:08:00,227 | INFO | === Expanding step: train_to_2023-03__test_2023-04 ===
2025-12-16 10:08:00,233 | INFO | [guardrails] transform=none
2025-12-16 10:08:00,233 | INFO | [guardrails] winsor z: lower_q=0.0050 (-1.67141), upper_q=0.9950 (16.0871)
2025-12-16 10:08:00,779 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-16 10:08:04,121 | INFO | [keep] ridge#1 score=-0.01444 params={'max_iter': np.int64(10000), 'alpha': 92.28295957427436}
2025-12-16 10:08:04,133 | INFO | [keep] ridge#2 score=-0.01659 params={'max_iter': np.int64(10000), 'alpha': 86.26905220714896}
2025-12-16 10:08:10,801 | INFO | [keep] lasso#1 score=0.05850 params={'max_iter': np.int64(10000), 'alpha': 0.014135935551752304}
2025-12-16 10:08:10,817 | INFO | [keep] lasso#2 score=0.05847 params={'max_iter': np.int64(10000), 'alpha': 0.01276954761904551}
2025-12-16 10:08:20,277 | INFO | [keep] elasticnet#1 score=0.05858 params={'max_iter': np.int64(10000), 'alpha': 0.023358825194833552, 'l1_ratio': 0.5547471590949188}
2025-12-16 10:08:20,361 | INFO | [keep] elasticnet#2 score=0.05848 params={'max_iter': np.int64(10000), 'alpha': 0.018662266976517967, 'l1_ratio': 0.6167152904533248}
2025-12-16 10:08:21,339 | INFO | [keep] pcr#1 score=-0.00071 params={'pca__n_components': 6, 'ridge__alpha': 0.0001}
2025-12-16 10:08:21,354 | INFO | [keep] pcr#2 score=-0.00071 params={'pca__n_components': 6, 'ridge__alpha': 0.001}
2025-12-16 10:08:21,528 | INFO | [keep] pls#1 score=0.02523 params={'n_components': 3}
2025-12-16 10:08:21,543 | INFO | [keep] pls#2 score=0.02035 params={'n_components': 4}
2025-12-16 10:08:21,543 | INFO | Training FFN: ['ffn']
2025-12-16 10:52:56,575 | INFO | [keep] ffn#1 score=0.05736 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(64), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.47878885927286424, 'ffn__weight_decay': 0.004336485563242767}
2025-12-16 10:53:14,659 | INFO | [keep] ffn#2 score=0.05730 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(64), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.4731634167180391, 'ffn__weight_decay': 0.0014653571755444989}
2025-12-16 10:53:14,659 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-16 10:54:07,784 | INFO | [keep] rf#1 score=0.08550 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.6, 'min_samples_leaf': 50, 'n_estimators': 100}
2025-12-16 10:54:08,529 | INFO | [keep] rf#2 score=0.08394 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.6, 'min_samples_leaf': 20, 'n_estimators': 300}
2025-12-16 10:54:21,123 | INFO | [keep] lgbm_gbdt#1 score=0.09725 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.05), 'max_bin': np.int64(127), 'max_depth': np.int64(4), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 1.569905318887705, 'reg_lambda': 0.29928644475767835} | n_estimators(refit)=56
2025-12-16 10:54:21,170 | INFO | [keep] lgbm_gbdt#2 score=0.09241 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'learning_rate': np.float64(0.1), 'max_bin': np.int64(127), 'max_depth': np.int64(6), 'min_child_samples': np.int64(100), 'n_estimators': np.int64(50), 'num_leaves': np.int64(7), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.9263755207433342, 'reg_lambda': 0.12022245820487377} | n_estimators(refit)=27
2025-12-16 10:54:51,408 | INFO | [keep] lgbm_dart#1 score=0.09974 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'drop_rate': np.float64(0.5), 'learning_rate': np.float64(0.05), 'max_bin': np.int64(127), 'max_depth': np.int64(6), 'max_drop': np.int64(20), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.01), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(200), 'num_leaves': np.int64(15), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 0.8301335256974502, 'reg_lambda': 92.5224254754638}
2025-12-16 10:54:51,664 | INFO | [keep] lgbm_dart#2 score=0.09826 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'drop_rate': np.float64(0.2), 'learning_rate': np.float64(0.1), 'max_bin': np.int64(63), 'max_depth': np.int64(4), 'max_drop': np.int64(20), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.01), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(200), 'num_leaves': np.int64(7), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 11.457401935437032, 'reg_lambda': 85.19329375595758}
2025-12-16 10:54:51,665 | INFO | [pred] ridge#1: n=521 R2_OS=0.08434 mse=4.54031 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.282 std=0.319 p1=-0.338 p99=1.16
2025-12-16 10:54:51,665 | INFO | [pred] ridge#1: |err| q99=10.0292  tail_n=6/521  tail_share_SSE=69.73%
2025-12-16 10:54:51,667 | INFO | [pred] ridge#1: per-day mse days=19 p50=0.452586 p90=13.6746 p99=26.6304 max=28.7586
2025-12-16 10:54:51,668 | INFO | [pred] ridge#2: n=521 R2_OS=0.08441 mse=4.53993 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.282 std=0.32 p1=-0.34 p99=1.16
2025-12-16 10:54:51,668 | INFO | [pred] ridge#2: |err| q99=10.0245  tail_n=6/521  tail_share_SSE=69.73%
2025-12-16 10:54:51,670 | INFO | [pred] ridge#2: per-day mse days=19 p50=0.452794 p90=13.6687 p99=26.6354 max=28.7646
2025-12-16 10:54:51,670 | INFO | [pred] lasso#1: n=521 R2_OS=0.06753 mse=4.62365 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.251 std=0.232 p1=-0.163 p99=0.672
2025-12-16 10:54:51,670 | INFO | [pred] lasso#1: |err| q99=10.4025  tail_n=6/521  tail_share_SSE=70.15%
2025-12-16 10:54:51,672 | INFO | [pred] lasso#1: per-day mse days=19 p50=0.53845 p90=14.3618 p99=26.65 max=28.7611
2025-12-16 10:54:51,672 | INFO | [pred] lasso#2: n=521 R2_OS=0.06876 mse=4.61755 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.257 std=0.236 p1=-0.161 p99=0.687
2025-12-16 10:54:51,673 | INFO | [pred] lasso#2: |err| q99=10.3904  tail_n=6/521  tail_share_SSE=70.13%
2025-12-16 10:54:51,674 | INFO | [pred] lasso#2: per-day mse days=19 p50=0.532694 p90=14.3387 p99=26.6109 max=28.7175
2025-12-16 10:54:51,675 | INFO | [pred] elasticnet#1: n=521 R2_OS=0.06814 mse=4.62062 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.252 std=0.233 p1=-0.161 p99=0.676
2025-12-16 10:54:51,675 | INFO | [pred] elasticnet#1: |err| q99=10.3995  tail_n=6/521  tail_share_SSE=70.16%
2025-12-16 10:54:51,677 | INFO | [pred] elasticnet#1: per-day mse days=19 p50=0.529261 p90=14.3548 p99=26.635 max=28.7439
2025-12-16 10:54:51,677 | INFO | [pred] elasticnet#2: n=521 R2_OS=0.06952 mse=4.61379 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.26 std=0.237 p1=-0.162 p99=0.696
2025-12-16 10:54:51,677 | INFO | [pred] elasticnet#2: |err| q99=10.3849  tail_n=6/521  tail_share_SSE=70.13%
2025-12-16 10:54:51,679 | INFO | [pred] elasticnet#2: per-day mse days=19 p50=0.525495 p90=14.3258 p99=26.5895 max=28.6935
2025-12-16 10:54:51,680 | INFO | [pred] pcr#1: n=521 R2_OS=0.02946 mse=4.81242 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.0256 std=0.141 p1=-0.26 p99=0.424
2025-12-16 10:54:51,680 | INFO | [pred] pcr#1: |err| q99=10.75  tail_n=6/521  tail_share_SSE=70.17%
2025-12-16 10:54:51,682 | INFO | [pred] pcr#1: per-day mse days=19 p50=0.406483 p90=14.8951 p99=28.0555 max=30.2739
2025-12-16 10:54:51,683 | INFO | [pred] pcr#2: n=521 R2_OS=0.02946 mse=4.81242 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.0256 std=0.141 p1=-0.26 p99=0.424
2025-12-16 10:54:51,683 | INFO | [pred] pcr#2: |err| q99=10.75  tail_n=6/521  tail_share_SSE=70.17%
2025-12-16 10:54:51,684 | INFO | [pred] pcr#2: per-day mse days=19 p50=0.406483 p90=14.8951 p99=28.0555 max=30.2739
2025-12-16 10:54:51,685 | INFO | [pred] pls#1: n=521 R2_OS=0.06274 mse=4.64741 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.528 std=0.656 p1=-0.789 p99=2.04
2025-12-16 10:54:51,685 | INFO | [pred] pls#1: |err| q99=9.58158  tail_n=6/521  tail_share_SSE=64.85%
2025-12-16 10:54:51,687 | INFO | [pred] pls#1: per-day mse days=19 p50=1.60131 p90=13.5032 p99=25.6299 max=27.8755
2025-12-16 10:54:51,687 | INFO | [pred] pls#2: n=521 R2_OS=0.04542 mse=4.73326 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.549 std=0.671 p1=-0.728 p99=2.3
2025-12-16 10:54:51,688 | INFO | [pred] pls#2: |err| q99=9.69543  tail_n=6/521  tail_share_SSE=64.06%
2025-12-16 10:54:51,689 | INFO | [pred] pls#2: per-day mse days=19 p50=1.56237 p90=13.7927 p99=25.5112 max=27.7517
2025-12-16 10:54:51,691 | INFO | [pred] L-En: n=521 R2_OS=0.07637 mse=4.57979 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.271 std=0.291 p1=-0.235 p99=0.82
2025-12-16 10:54:51,691 | INFO | [pred] L-En: |err| q99=10.3334  tail_n=6/521  tail_share_SSE=70.03%
2025-12-16 10:54:51,693 | INFO | [pred] L-En: per-day mse days=19 p50=0.546294 p90=14.0924 p99=26.6109 max=28.7812
2025-12-16 10:54:51,695 | INFO | [pred] ffn#1: n=521 R2_OS=0.07798 mse=4.57182 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.505 std=0.634 p1=-0.503 p99=1.93
2025-12-16 10:54:51,695 | INFO | [pred] ffn#1: |err| q99=9.85623  tail_n=6/521  tail_share_SSE=64.61%
2025-12-16 10:54:51,697 | INFO | [pred] ffn#1: per-day mse days=19 p50=1.62378 p90=13.1454 p99=24.2326 max=26.1199
2025-12-16 10:54:51,700 | INFO | [pred] ffn#2: n=521 R2_OS=0.07762 mse=4.57363 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.506 std=0.636 p1=-0.506 p99=1.94
2025-12-16 10:54:51,700 | INFO | [pred] ffn#2: |err| q99=9.85176  tail_n=6/521  tail_share_SSE=64.56%
2025-12-16 10:54:51,701 | INFO | [pred] ffn#2: per-day mse days=19 p50=1.62357 p90=13.1405 p99=24.2133 max=26.0966
2025-12-16 10:54:51,714 | INFO | [pred] rf#1: n=521 R2_OS=0.08536 mse=4.53522 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.422 std=0.522 p1=-0.101 p99=1.82
2025-12-16 10:54:51,714 | INFO | [pred] rf#1: |err| q99=10.0396  tail_n=6/521  tail_share_SSE=67.87%
2025-12-16 10:54:51,716 | INFO | [pred] rf#1: per-day mse days=19 p50=1.18625 p90=13.5867 p99=25.5605 max=27.6441
2025-12-16 10:54:51,749 | INFO | [pred] rf#2: n=521 R2_OS=0.07214 mse=4.60078 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.495 std=0.667 p1=-0.0831 p99=2.32
2025-12-16 10:54:51,749 | INFO | [pred] rf#2: |err| q99=9.69414  tail_n=6/521  tail_share_SSE=65.01%
2025-12-16 10:54:51,752 | INFO | [pred] rf#2: per-day mse days=19 p50=1.63693 p90=12.8923 p99=25.1359 max=27.3095
2025-12-16 10:54:51,754 | INFO | [pred] lgbm_gbdt#1: n=521 R2_OS=-0.10988 mse=5.50331 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.756 std=1.17 p1=-0.116 p99=4.65
2025-12-16 10:54:51,754 | INFO | [pred] lgbm_gbdt#1: |err| q99=9.68048  tail_n=6/521  tail_share_SSE=51.25%
2025-12-16 10:54:51,756 | INFO | [pred] lgbm_gbdt#1: per-day mse days=19 p50=1.86656 p90=15.2649 p99=23.0168 max=24.6513
2025-12-16 10:54:51,758 | INFO | [pred] lgbm_gbdt#2: n=521 R2_OS=0.04022 mse=4.75904 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.527 std=0.82 p1=-0.0824 p99=3.11
2025-12-16 10:54:51,758 | INFO | [pred] lgbm_gbdt#2: |err| q99=9.83348  tail_n=6/521  tail_share_SSE=61.34%
2025-12-16 10:54:51,761 | INFO | [pred] lgbm_gbdt#2: per-day mse days=19 p50=1.74835 p90=13.1942 p99=23.5956 max=25.4073
2025-12-16 10:54:51,762 | INFO | [pred] lgbm_dart#1: n=521 R2_OS=0.06161 mse=4.65299 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.429 std=0.583 p1=-0.195 p99=1.83
2025-12-16 10:54:51,763 | INFO | [pred] lgbm_dart#1: |err| q99=9.94228  tail_n=6/521  tail_share_SSE=65.84%
2025-12-16 10:54:51,765 | INFO | [pred] lgbm_dart#1: per-day mse days=19 p50=1.55747 p90=13.6817 p99=24.1837 max=25.9062
2025-12-16 10:54:51,767 | INFO | [pred] lgbm_dart#2: n=521 R2_OS=0.06834 mse=4.61964 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.49 std=0.563 p1=-0.137 p99=1.81
2025-12-16 10:54:51,767 | INFO | [pred] lgbm_dart#2: |err| q99=9.77723  tail_n=6/521  tail_share_SSE=65.60%
2025-12-16 10:54:51,770 | INFO | [pred] lgbm_dart#2: per-day mse days=19 p50=1.50494 p90=13.4566 p99=24.2605 max=26.0035
2025-12-16 10:55:07,269 | INFO | === Expanding step: train_to_2023-04__test_2023-05 ===
2025-12-16 10:55:07,275 | INFO | [guardrails] transform=none
2025-12-16 10:55:07,275 | INFO | [guardrails] winsor z: lower_q=0.0050 (-1.7037), upper_q=0.9950 (16.0556)
2025-12-16 10:55:07,800 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-16 10:55:11,164 | INFO | [keep] ridge#1 score=0.02227 params={'max_iter': np.int64(10000), 'alpha': 92.28295957427436}
2025-12-16 10:55:11,175 | INFO | [keep] ridge#2 score=0.02113 params={'max_iter': np.int64(10000), 'alpha': 86.26905220714896}
2025-12-16 10:55:17,829 | INFO | [keep] lasso#1 score=0.06884 params={'max_iter': np.int64(10000), 'alpha': 0.01276954761904551}
2025-12-16 10:55:17,846 | INFO | [keep] lasso#2 score=0.06874 params={'max_iter': np.int64(10000), 'alpha': 0.012334805700860018}
2025-12-16 10:55:27,583 | INFO | [keep] elasticnet#1 score=0.06805 params={'max_iter': np.int64(10000), 'alpha': 0.023358825194833552, 'l1_ratio': 0.5547471590949188}
2025-12-16 10:55:27,672 | INFO | [keep] elasticnet#2 score=0.06802 params={'max_iter': np.int64(10000), 'alpha': 0.018662266976517967, 'l1_ratio': 0.6167152904533248}
2025-12-16 10:55:28,641 | INFO | [keep] pcr#1 score=0.00169 params={'pca__n_components': 5, 'ridge__alpha': 1.0}
2025-12-16 10:55:28,656 | INFO | [keep] pcr#2 score=0.00169 params={'pca__n_components': 5, 'ridge__alpha': 0.1}
2025-12-16 10:55:28,824 | INFO | [keep] pls#1 score=0.03575 params={'n_components': 2}
2025-12-16 10:55:28,838 | INFO | [keep] pls#2 score=0.03410 params={'n_components': 3}
2025-12-16 10:55:28,838 | INFO | Training FFN: ['ffn']
2025-12-16 11:39:34,539 | INFO | [keep] ffn#1 score=0.05480 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(64), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(32), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.49651215141776783, 'ffn__weight_decay': 0.0015998881492631496}
2025-12-16 11:39:52,732 | INFO | [keep] ffn#2 score=0.05229 params={'ffn__activation': np.str_('tanh'), 'ffn__batch_size': np.int64(64), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.4040166708390237, 'ffn__weight_decay': 0.007913989622325568}
2025-12-16 11:39:52,732 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-16 11:40:47,940 | INFO | [keep] rf#1 score=0.09540 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.6, 'min_samples_leaf': 50, 'n_estimators': 200}
2025-12-16 11:40:48,706 | INFO | [keep] rf#2 score=0.09301 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.6, 'min_samples_leaf': 50, 'n_estimators': 300}
2025-12-16 11:41:02,048 | INFO | [keep] lgbm_gbdt#1 score=0.09096 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(63), 'max_depth': np.int64(6), 'min_child_samples': np.int64(100), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 0.49768205094903084, 'reg_lambda': 3.021308351984474} | n_estimators(refit)=106
2025-12-16 11:41:02,095 | INFO | [keep] lgbm_gbdt#2 score=0.09065 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'learning_rate': np.float64(0.1), 'max_bin': np.int64(63), 'max_depth': np.int64(6), 'min_child_samples': np.int64(200), 'n_estimators': np.int64(200), 'num_leaves': np.int64(15), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 2.557273434307698, 'reg_lambda': 0.15865500409725955} | n_estimators(refit)=22
2025-12-16 11:41:34,291 | INFO | [keep] lgbm_dart#1 score=0.10418 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'drop_rate': np.float64(0.2), 'learning_rate': np.float64(0.1), 'max_bin': np.int64(127), 'max_depth': np.int64(4), 'max_drop': np.int64(20), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.01), 'min_split_gain': np.float64(0.05), 'n_estimators': np.int64(100), 'num_leaves': np.int64(15), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.10866975018682318, 'reg_lambda': 0.22205108081983832}
2025-12-16 11:41:34,435 | INFO | [keep] lgbm_dart#2 score=0.10417 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'drop_rate': np.float64(0.2), 'learning_rate': np.float64(0.1), 'max_bin': np.int64(127), 'max_depth': np.int64(4), 'max_drop': np.int64(20), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.01), 'min_split_gain': np.float64(0.05), 'n_estimators': np.int64(100), 'num_leaves': np.int64(31), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 8.319025698678395, 'reg_lambda': 1.2714731864073856}
2025-12-16 11:41:34,436 | INFO | [pred] ridge#1: n=597 R2_OS=0.05681 mse=5.07234 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.359 std=0.413 p1=-0.312 p99=1.52
2025-12-16 11:41:34,436 | INFO | [pred] ridge#1: |err| q99=13.0165  tail_n=6/597  tail_share_SSE=52.13%
2025-12-16 11:41:34,438 | INFO | [pred] ridge#1: per-day mse days=19 p50=1.0281 p90=17.6877 p99=81.807 max=91.1033
2025-12-16 11:41:34,439 | INFO | [pred] ridge#2: n=597 R2_OS=0.05646 mse=5.07422 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.359 std=0.415 p1=-0.312 p99=1.53
2025-12-16 11:41:34,439 | INFO | [pred] ridge#2: |err| q99=13.0169  tail_n=6/597  tail_share_SSE=52.12%
2025-12-16 11:41:34,441 | INFO | [pred] ridge#2: per-day mse days=19 p50=1.03063 p90=17.6874 p99=81.8177 max=91.1119
2025-12-16 11:41:34,441 | INFO | [pred] lasso#1: n=597 R2_OS=0.06788 mse=5.01278 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.306 std=0.258 p1=-0.172 p99=0.779
2025-12-16 11:41:34,441 | INFO | [pred] lasso#1: |err| q99=13.0979  tail_n=6/597  tail_share_SSE=53.06%
2025-12-16 11:41:34,443 | INFO | [pred] lasso#1: per-day mse days=19 p50=0.782175 p90=17.9808 p99=82.4062 max=91.9529
2025-12-16 11:41:34,443 | INFO | [pred] lasso#2: n=597 R2_OS=0.06789 mse=5.01272 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.308 std=0.259 p1=-0.173 p99=0.784
2025-12-16 11:41:34,444 | INFO | [pred] lasso#2: |err| q99=13.0976  tail_n=6/597  tail_share_SSE=53.06%
2025-12-16 11:41:34,445 | INFO | [pred] lasso#2: per-day mse days=19 p50=0.782894 p90=17.9723 p99=82.4019 max=91.9489
2025-12-16 11:41:34,446 | INFO | [pred] elasticnet#1: n=597 R2_OS=0.06753 mse=5.01464 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.301 std=0.254 p1=-0.171 p99=0.769
2025-12-16 11:41:34,446 | INFO | [pred] elasticnet#1: |err| q99=13.1048  tail_n=6/597  tail_share_SSE=53.08%
2025-12-16 11:41:34,448 | INFO | [pred] elasticnet#1: per-day mse days=19 p50=0.78382 p90=18.0021 p99=82.4766 max=92.0362
2025-12-16 11:41:34,448 | INFO | [pred] elasticnet#2: n=597 R2_OS=0.06769 mse=5.01383 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.307 std=0.259 p1=-0.18 p99=0.787
2025-12-16 11:41:34,448 | INFO | [pred] elasticnet#2: |err| q99=13.1019  tail_n=6/597  tail_share_SSE=53.05%
2025-12-16 11:41:34,450 | INFO | [pred] elasticnet#2: per-day mse days=19 p50=0.78565 p90=17.9698 p99=82.4434 max=92
2025-12-16 11:41:34,451 | INFO | [pred] pcr#1: n=597 R2_OS=0.02212 mse=5.2589 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.0545 std=0.153 p1=-0.202 p99=0.464
2025-12-16 11:41:34,451 | INFO | [pred] pcr#1: |err| q99=13.5417  tail_n=6/597  tail_share_SSE=53.08%
2025-12-16 11:41:34,453 | INFO | [pred] pcr#1: per-day mse days=19 p50=0.958014 p90=19.1871 p99=87.888 max=98.3259
2025-12-16 11:41:34,454 | INFO | [pred] pcr#2: n=597 R2_OS=0.02212 mse=5.25889 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.0545 std=0.153 p1=-0.202 p99=0.464
2025-12-16 11:41:34,454 | INFO | [pred] pcr#2: |err| q99=13.5417  tail_n=6/597  tail_share_SSE=53.08%
2025-12-16 11:41:34,456 | INFO | [pred] pcr#2: per-day mse days=19 p50=0.958015 p90=19.187 p99=87.888 max=98.3258
2025-12-16 11:41:34,456 | INFO | [pred] pls#1: n=597 R2_OS=0.11346 mse=4.76768 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.537 std=0.625 p1=-0.58 p99=1.72
2025-12-16 11:41:34,456 | INFO | [pred] pls#1: |err| q99=12.3582  tail_n=6/597  tail_share_SSE=49.77%
2025-12-16 11:41:34,458 | INFO | [pred] pls#1: per-day mse days=19 p50=1.07556 p90=15.8172 p99=72.7792 max=80.884
2025-12-16 11:41:34,459 | INFO | [pred] pls#2: n=597 R2_OS=0.10449 mse=4.81589 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.654 std=0.678 p1=-0.57 p99=1.98
2025-12-16 11:41:34,459 | INFO | [pred] pls#2: |err| q99=12.2876  tail_n=6/597  tail_share_SSE=48.29%
2025-12-16 11:41:34,460 | INFO | [pred] pls#2: per-day mse days=19 p50=1.25655 p90=15.6675 p99=71.2531 max=79.018
2025-12-16 11:41:34,462 | INFO | [pred] L-En: n=597 R2_OS=0.07864 mse=4.9549 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.324 std=0.325 p1=-0.248 p99=0.988
2025-12-16 11:41:34,462 | INFO | [pred] L-En: |err| q99=13.0165  tail_n=6/597  tail_share_SSE=52.86%
2025-12-16 11:41:34,464 | INFO | [pred] L-En: per-day mse days=19 p50=0.847981 p90=17.6289 p99=81.1405 max=90.4926
2025-12-16 11:41:34,466 | INFO | [pred] ffn#1: n=597 R2_OS=0.00171 mse=5.36864 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=1.01 std=0.924 p1=-0.302 p99=3.19
2025-12-16 11:41:34,467 | INFO | [pred] ffn#1: |err| q99=11.8313  tail_n=6/597  tail_share_SSE=41.78%
2025-12-16 11:41:34,468 | INFO | [pred] ffn#1: per-day mse days=19 p50=2.60301 p90=15.3388 p99=69.7855 max=77.0485
2025-12-16 11:41:34,471 | INFO | [pred] ffn#2: n=597 R2_OS=0.06721 mse=5.01638 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.375 std=0.31 p1=-0.239 p99=0.986
2025-12-16 11:41:34,471 | INFO | [pred] ffn#2: |err| q99=13.0817  tail_n=6/597  tail_share_SSE=52.55%
2025-12-16 11:41:34,473 | INFO | [pred] ffn#2: per-day mse days=19 p50=0.838474 p90=17.7057 p99=82.1564 max=91.7444
2025-12-16 11:41:34,496 | INFO | [pred] rf#1: n=597 R2_OS=0.10541 mse=4.81094 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.575 std=0.65 p1=-0.0811 p99=2
2025-12-16 11:41:34,496 | INFO | [pred] rf#1: |err| q99=12.5636  tail_n=6/597  tail_share_SSE=49.76%
2025-12-16 11:41:34,498 | INFO | [pred] rf#1: per-day mse days=19 p50=1.80195 p90=15.7826 p99=74.9686 max=83.4728
2025-12-16 11:41:34,531 | INFO | [pred] rf#2: n=597 R2_OS=0.10061 mse=4.83675 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.583 std=0.665 p1=-0.0728 p99=2.06
2025-12-16 11:41:34,531 | INFO | [pred] rf#2: |err| q99=12.5015  tail_n=6/597  tail_share_SSE=49.54%
2025-12-16 11:41:34,533 | INFO | [pred] rf#2: per-day mse days=19 p50=1.69423 p90=15.8734 p99=74.6545 max=83.0343
2025-12-16 11:41:34,535 | INFO | [pred] lgbm_gbdt#1: n=597 R2_OS=0.13491 mse=4.6523 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.639 std=0.813 p1=-0.135 p99=2.69
2025-12-16 11:41:34,535 | INFO | [pred] lgbm_gbdt#1: |err| q99=10.92  tail_n=6/597  tail_share_SSE=48.38%
2025-12-16 11:41:34,537 | INFO | [pred] lgbm_gbdt#1: per-day mse days=19 p50=2.09857 p90=15.7212 p99=61.7845 max=67.1033
2025-12-16 11:41:34,538 | INFO | [pred] lgbm_gbdt#2: n=597 R2_OS=0.12308 mse=4.71592 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.724 std=0.847 p1=-0.131 p99=3.02
2025-12-16 11:41:34,538 | INFO | [pred] lgbm_gbdt#2: |err| q99=10.5534  tail_n=6/597  tail_share_SSE=46.82%
2025-12-16 11:41:34,540 | INFO | [pred] lgbm_gbdt#2: per-day mse days=19 p50=2.66376 p90=15.7365 p99=59.032 max=63.8338
2025-12-16 11:41:34,541 | INFO | [pred] lgbm_dart#1: n=597 R2_OS=0.10784 mse=4.79787 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.704 std=0.893 p1=-0.0946 p99=2.79
2025-12-16 11:41:34,542 | INFO | [pred] lgbm_dart#1: |err| q99=10.9551  tail_n=6/597  tail_share_SSE=46.39%
2025-12-16 11:41:34,544 | INFO | [pred] lgbm_dart#1: per-day mse days=19 p50=2.73473 p90=15.6816 p99=62.2682 max=67.6903
2025-12-16 11:41:34,545 | INFO | [pred] lgbm_dart#2: n=597 R2_OS=0.11223 mse=4.77429 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.673 std=0.821 p1=-0.0943 p99=2.62
2025-12-16 11:41:34,545 | INFO | [pred] lgbm_dart#2: |err| q99=11.0221  tail_n=6/597  tail_share_SSE=47.20%
2025-12-16 11:41:34,547 | INFO | [pred] lgbm_dart#2: per-day mse days=19 p50=2.51284 p90=15.9288 p99=62.5816 max=68.1258
2025-12-16 11:41:52,562 | INFO | === Expanding step: train_to_2023-05__test_2023-06 ===
2025-12-16 11:41:52,568 | INFO | [guardrails] transform=none
2025-12-16 11:41:52,568 | INFO | [guardrails] winsor z: lower_q=0.0050 (-1.69905), upper_q=0.9950 (15.9481)
2025-12-16 11:41:53,100 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-16 11:41:56,447 | INFO | [keep] ridge#1 score=0.03967 params={'max_iter': np.int64(10000), 'alpha': 92.28295957427436}
2025-12-16 11:41:56,459 | INFO | [keep] ridge#2 score=0.03888 params={'max_iter': np.int64(10000), 'alpha': 86.26905220714896}
2025-12-16 11:42:03,230 | INFO | [keep] lasso#1 score=0.06567 params={'max_iter': np.int64(10000), 'alpha': 0.014135935551752304}
2025-12-16 11:42:03,245 | INFO | [keep] lasso#2 score=0.06561 params={'max_iter': np.int64(10000), 'alpha': 0.01276954761904551}
2025-12-16 11:42:13,285 | INFO | [keep] elasticnet#1 score=0.06527 params={'max_iter': np.int64(10000), 'alpha': 0.023358825194833552, 'l1_ratio': 0.5547471590949188}
2025-12-16 11:42:13,370 | INFO | [keep] elasticnet#2 score=0.06515 params={'max_iter': np.int64(10000), 'alpha': 0.018662266976517967, 'l1_ratio': 0.6167152904533248}
2025-12-16 11:42:14,224 | INFO | [keep] pcr#1 score=0.00336 params={'pca__n_components': 5, 'ridge__alpha': 1.0}
2025-12-16 11:42:14,239 | INFO | [keep] pcr#2 score=0.00336 params={'pca__n_components': 5, 'ridge__alpha': 0.1}
2025-12-16 11:42:14,530 | INFO | [keep] pls#1 score=0.07140 params={'n_components': 1}
2025-12-16 11:42:14,544 | INFO | [keep] pls#2 score=0.01401 params={'n_components': 3}
2025-12-16 11:42:14,544 | INFO | Training FFN: ['ffn']
2025-12-16 12:30:16,014 | INFO | [keep] ffn#1 score=0.06951 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(64), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(32), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.49651215141776783, 'ffn__weight_decay': 0.0015998881492631496}
2025-12-16 12:30:59,150 | INFO | [keep] ffn#2 score=0.06787 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(64), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(32), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.4311742245508329, 'ffn__weight_decay': 0.0019674028256453594}
2025-12-16 12:30:59,151 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-16 12:31:55,261 | INFO | [keep] rf#1 score=0.10448 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.6, 'min_samples_leaf': 20, 'n_estimators': 300}
2025-12-16 12:31:55,810 | INFO | [keep] rf#2 score=0.10097 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.6, 'min_samples_leaf': 20, 'n_estimators': 200}
2025-12-16 12:32:08,953 | INFO | [keep] lgbm_gbdt#1 score=0.10026 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.1), 'max_bin': np.int64(127), 'max_depth': np.int64(6), 'min_child_samples': np.int64(200), 'n_estimators': np.int64(200), 'num_leaves': np.int64(15), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 1.6316096531713469, 'reg_lambda': 2.549382456709141} | n_estimators(refit)=22
2025-12-16 12:32:09,004 | INFO | [keep] lgbm_gbdt#2 score=0.10018 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.1), 'max_bin': np.int64(127), 'max_depth': np.int64(6), 'min_child_samples': np.int64(200), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 1.3589482177682006, 'reg_lambda': 0.33945247683628305} | n_estimators(refit)=22
2025-12-16 12:32:41,831 | INFO | [keep] lgbm_dart#1 score=0.11475 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'drop_rate': np.float64(0.2), 'learning_rate': np.float64(0.05), 'max_bin': np.int64(63), 'max_depth': np.int64(6), 'max_drop': np.int64(10), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.01), 'min_split_gain': np.float64(0.05), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 1.007908770912927, 'reg_lambda': 0.33582746295594984}
2025-12-16 12:32:41,928 | INFO | [keep] lgbm_dart#2 score=0.10779 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'drop_rate': np.float64(0.3), 'learning_rate': np.float64(0.1), 'max_bin': np.int64(63), 'max_depth': np.int64(6), 'max_drop': np.int64(10), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.1), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(50), 'num_leaves': np.int64(15), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 94.55205830884037, 'reg_lambda': 1.3496582100654222}
2025-12-16 12:32:41,928 | INFO | [pred] ridge#1: n=513 R2_OS=0.07902 mse=7.13432 mse0=7.74646 | y mean=0.581 std=2.72 | yhat mean=0.166 std=0.337 p1=-0.565 p99=0.797
2025-12-16 12:32:41,929 | INFO | [pred] ridge#1: |err| q99=14.7458  tail_n=6/513  tail_share_SSE=54.10%
2025-12-16 12:32:41,931 | INFO | [pred] ridge#1: per-day mse days=20 p50=1.04758 p90=24.8673 p99=28.2595 max=29.0022
2025-12-16 12:32:41,932 | INFO | [pred] ridge#2: n=513 R2_OS=0.07916 mse=7.13324 mse0=7.74646 | y mean=0.581 std=2.72 | yhat mean=0.166 std=0.338 p1=-0.566 p99=0.802
2025-12-16 12:32:41,932 | INFO | [pred] ridge#2: |err| q99=14.7431  tail_n=6/513  tail_share_SSE=54.10%
2025-12-16 12:32:41,934 | INFO | [pred] ridge#2: per-day mse days=20 p50=1.0486 p90=24.8645 p99=28.2581 max=29.0016
2025-12-16 12:32:41,934 | INFO | [pred] lasso#1: n=513 R2_OS=0.06398 mse=7.25085 mse0=7.74646 | y mean=0.581 std=2.72 | yhat mean=0.181 std=0.232 p1=-0.395 p99=0.628
2025-12-16 12:32:41,934 | INFO | [pred] lasso#1: |err| q99=14.8699  tail_n=6/513  tail_share_SSE=54.19%
2025-12-16 12:32:41,937 | INFO | [pred] lasso#1: per-day mse days=20 p50=1.0117 p90=25.1947 p99=28.718 max=29.428
2025-12-16 12:32:41,937 | INFO | [pred] lasso#2: n=513 R2_OS=0.06414 mse=7.24961 mse0=7.74646 | y mean=0.581 std=2.72 | yhat mean=0.179 std=0.237 p1=-0.42 p99=0.642
2025-12-16 12:32:41,937 | INFO | [pred] lasso#2: |err| q99=14.8766  tail_n=6/513  tail_share_SSE=54.18%
2025-12-16 12:32:41,939 | INFO | [pred] lasso#2: per-day mse days=20 p50=1.01049 p90=25.1807 p99=28.6865 max=29.3889
2025-12-16 12:32:41,940 | INFO | [pred] elasticnet#1: n=513 R2_OS=0.06345 mse=7.25493 mse0=7.74646 | y mean=0.581 std=2.72 | yhat mean=0.178 std=0.233 p1=-0.407 p99=0.632
2025-12-16 12:32:41,940 | INFO | [pred] elasticnet#1: |err| q99=14.8768  tail_n=6/513  tail_share_SSE=54.18%
2025-12-16 12:32:41,942 | INFO | [pred] elasticnet#1: per-day mse days=20 p50=1.01115 p90=25.2111 p99=28.7157 max=29.4208
2025-12-16 12:32:41,942 | INFO | [pred] elasticnet#2: n=513 R2_OS=0.06407 mse=7.25013 mse0=7.74646 | y mean=0.581 std=2.72 | yhat mean=0.177 std=0.24 p1=-0.435 p99=0.65
2025-12-16 12:32:41,943 | INFO | [pred] elasticnet#2: |err| q99=14.8811  tail_n=6/513  tail_share_SSE=54.18%
2025-12-16 12:32:41,945 | INFO | [pred] elasticnet#2: per-day mse days=20 p50=1.0097 p90=25.175 p99=28.6721 max=29.3691
2025-12-16 12:32:41,945 | INFO | [pred] pcr#1: n=513 R2_OS=0.02465 mse=7.55553 mse0=7.74646 | y mean=0.581 std=2.72 | yhat mean=0.0381 std=0.153 p1=-0.221 p99=0.463
2025-12-16 12:32:41,946 | INFO | [pred] pcr#1: |err| q99=14.9514  tail_n=6/513  tail_share_SSE=53.55%
2025-12-16 12:32:41,948 | INFO | [pred] pcr#1: per-day mse days=20 p50=1.10749 p90=26.5853 p99=29.9076 max=30.5321
2025-12-16 12:32:41,948 | INFO | [pred] pcr#2: n=513 R2_OS=0.02465 mse=7.55552 mse0=7.74646 | y mean=0.581 std=2.72 | yhat mean=0.0381 std=0.153 p1=-0.221 p99=0.463
2025-12-16 12:32:41,949 | INFO | [pred] pcr#2: |err| q99=14.9514  tail_n=6/513  tail_share_SSE=53.55%
2025-12-16 12:32:41,950 | INFO | [pred] pcr#2: per-day mse days=20 p50=1.10749 p90=26.5852 p99=29.9076 max=30.532
2025-12-16 12:32:41,951 | INFO | [pred] pls#1: n=513 R2_OS=0.11333 mse=6.86853 mse0=7.74646 | y mean=0.581 std=2.72 | yhat mean=0.682 std=0.419 p1=-0.114 p99=1.57
2025-12-16 12:32:41,951 | INFO | [pred] pls#1: |err| q99=14.0261  tail_n=6/513  tail_share_SSE=52.45%
2025-12-16 12:32:41,953 | INFO | [pred] pls#1: per-day mse days=20 p50=2.37702 p90=21.994 p99=27.4754 max=28.3825
2025-12-16 12:32:41,954 | INFO | [pred] pls#2: n=513 R2_OS=0.12929 mse=6.74495 mse0=7.74646 | y mean=0.581 std=2.72 | yhat mean=0.632 std=0.612 p1=-0.434 p99=1.91
2025-12-16 12:32:41,954 | INFO | [pred] pls#2: |err| q99=13.869  tail_n=6/513  tail_share_SSE=52.69%
2025-12-16 12:32:41,956 | INFO | [pred] pls#2: per-day mse days=20 p50=1.77774 p90=21.2264 p99=27.3729 max=28.4917
2025-12-16 12:32:41,958 | INFO | [pred] L-En: n=513 R2_OS=0.08063 mse=7.12185 mse0=7.74646 | y mean=0.581 std=2.72 | yhat mean=0.244 std=0.269 p1=-0.249 p99=0.763
2025-12-16 12:32:41,958 | INFO | [pred] L-En: |err| q99=14.7102  tail_n=6/513  tail_share_SSE=54.29%
2025-12-16 12:32:41,960 | INFO | [pred] L-En: per-day mse days=20 p50=1.02762 p90=24.6755 p99=28.4635 max=29.2453
2025-12-16 12:32:41,962 | INFO | [pred] ffn#1: n=513 R2_OS=0.15671 mse=6.53253 mse0=7.74646 | y mean=0.581 std=2.72 | yhat mean=0.631 std=0.798 p1=-0.568 p99=2.59
2025-12-16 12:32:41,962 | INFO | [pred] ffn#1: |err| q99=13.6255  tail_n=6/513  tail_share_SSE=50.91%
2025-12-16 12:32:41,965 | INFO | [pred] ffn#1: per-day mse days=20 p50=1.50536 p90=21.8217 p99=26.1722 max=27.1782
2025-12-16 12:32:41,967 | INFO | [pred] ffn#2: n=513 R2_OS=0.15761 mse=6.52556 mse0=7.74646 | y mean=0.581 std=2.72 | yhat mean=0.652 std=0.825 p1=-0.578 p99=2.71
2025-12-16 12:32:41,967 | INFO | [pred] ffn#2: |err| q99=13.6243  tail_n=6/513  tail_share_SSE=50.71%
2025-12-16 12:32:41,969 | INFO | [pred] ffn#2: per-day mse days=20 p50=1.56978 p90=21.8202 p99=26.1021 max=27.1033
2025-12-16 12:32:42,003 | INFO | [pred] rf#1: n=513 R2_OS=0.17248 mse=6.41031 mse0=7.74646 | y mean=0.581 std=2.72 | yhat mean=0.586 std=0.703 p1=-0.121 p99=2.27
2025-12-16 12:32:42,003 | INFO | [pred] rf#1: |err| q99=13.395  tail_n=6/513  tail_share_SSE=52.41%
2025-12-16 12:32:42,005 | INFO | [pred] rf#1: per-day mse days=20 p50=1.37789 p90=19.9014 p99=26.2026 max=27.264
2025-12-16 12:32:42,027 | INFO | [pred] rf#2: n=513 R2_OS=0.17294 mse=6.40677 mse0=7.74646 | y mean=0.581 std=2.72 | yhat mean=0.593 std=0.714 p1=-0.116 p99=2.35
2025-12-16 12:32:42,027 | INFO | [pred] rf#2: |err| q99=13.3387  tail_n=6/513  tail_share_SSE=52.42%
2025-12-16 12:32:42,029 | INFO | [pred] rf#2: per-day mse days=20 p50=1.38261 p90=19.9785 p99=26.2576 max=27.3159
2025-12-16 12:32:42,030 | INFO | [pred] lgbm_gbdt#1: n=513 R2_OS=0.15294 mse=6.56175 mse0=7.74646 | y mean=0.581 std=2.72 | yhat mean=0.597 std=0.796 p1=-0.243 p99=2.35
2025-12-16 12:32:42,031 | INFO | [pred] lgbm_gbdt#1: |err| q99=13.4457  tail_n=6/513  tail_share_SSE=51.12%
2025-12-16 12:32:42,032 | INFO | [pred] lgbm_gbdt#1: per-day mse days=20 p50=1.69211 p90=20.5562 p99=26.0111 max=27.0061
2025-12-16 12:32:42,033 | INFO | [pred] lgbm_gbdt#2: n=513 R2_OS=0.16062 mse=6.50225 mse0=7.74646 | y mean=0.581 std=2.72 | yhat mean=0.688 std=0.925 p1=-0.253 p99=3.03
2025-12-16 12:32:42,033 | INFO | [pred] lgbm_gbdt#2: |err| q99=13.4625  tail_n=6/513  tail_share_SSE=50.92%
2025-12-16 12:32:42,035 | INFO | [pred] lgbm_gbdt#2: per-day mse days=20 p50=1.91841 p90=18.7184 p99=25.8333 max=26.9305
2025-12-16 12:32:42,037 | INFO | [pred] lgbm_dart#1: n=513 R2_OS=0.19185 mse=6.26029 mse0=7.74646 | y mean=0.581 std=2.72 | yhat mean=0.689 std=0.993 p1=-0.313 p99=3.11
2025-12-16 12:32:42,037 | INFO | [pred] lgbm_dart#1: |err| q99=13.1109  tail_n=6/513  tail_share_SSE=51.37%
2025-12-16 12:32:42,039 | INFO | [pred] lgbm_dart#1: per-day mse days=20 p50=1.74724 p90=17.4453 p99=25.6461 max=26.8395
2025-12-16 12:32:42,040 | INFO | [pred] lgbm_dart#2: n=513 R2_OS=0.07877 mse=7.13626 mse0=7.74646 | y mean=0.581 std=2.72 | yhat mean=0.246 std=0.295 p1=-0.133 p99=0.956
2025-12-16 12:32:42,040 | INFO | [pred] lgbm_dart#2: |err| q99=14.7113  tail_n=6/513  tail_share_SSE=53.71%
2025-12-16 12:32:42,041 | INFO | [pred] lgbm_dart#2: per-day mse days=20 p50=1.02696 p90=24.6152 p99=28.1639 max=28.7409
2025-12-16 12:32:57,963 | INFO | === Expanding step: train_to_2023-06__test_2023-07 ===
2025-12-16 12:32:57,969 | INFO | [guardrails] transform=none
2025-12-16 12:32:57,969 | INFO | [guardrails] winsor z: lower_q=0.0050 (-1.69817), upper_q=0.9950 (15.9917)
2025-12-16 12:32:58,511 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-16 12:33:01,689 | INFO | [keep] ridge#1 score=0.04857 params={'max_iter': np.int64(10000), 'alpha': 92.28295957427436}
2025-12-16 12:33:01,701 | INFO | [keep] ridge#2 score=0.04799 params={'max_iter': np.int64(10000), 'alpha': 86.26905220714896}
2025-12-16 12:33:08,862 | INFO | [keep] lasso#1 score=0.06636 params={'max_iter': np.int64(10000), 'alpha': 0.018688099841937894}
2025-12-16 12:33:08,877 | INFO | [keep] lasso#2 score=0.06636 params={'max_iter': np.int64(10000), 'alpha': 0.018662266976517967}
2025-12-16 12:33:19,656 | INFO | [keep] elasticnet#1 score=0.06614 params={'max_iter': np.int64(10000), 'alpha': 0.024234724484675927, 'l1_ratio': 0.7244233410291644}
2025-12-16 12:33:19,752 | INFO | [keep] elasticnet#2 score=0.06614 params={'max_iter': np.int64(10000), 'alpha': 0.021947049130435388, 'l1_ratio': 0.7771269379769022}
2025-12-16 12:33:20,748 | INFO | [keep] pcr#1 score=0.00971 params={'pca__n_components': 5, 'ridge__alpha': 0.0001}
2025-12-16 12:33:20,763 | INFO | [keep] pcr#2 score=0.00971 params={'pca__n_components': 5, 'ridge__alpha': 0.001}
2025-12-16 12:33:20,937 | INFO | [keep] pls#1 score=0.07327 params={'n_components': 1}
2025-12-16 12:33:20,951 | INFO | [keep] pls#2 score=0.03232 params={'n_components': 3}
2025-12-16 12:33:20,951 | INFO | Training FFN: ['ffn']
2025-12-16 13:23:46,219 | INFO | [keep] ffn#1 score=0.07280 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(64), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(32), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.49651215141776783, 'ffn__weight_decay': 0.0015998881492631496}
2025-12-16 13:24:29,616 | INFO | [keep] ffn#2 score=0.07018 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(64), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(32), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.4311742245508329, 'ffn__weight_decay': 0.0019674028256453594}
2025-12-16 13:24:29,616 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-16 13:25:25,695 | INFO | [keep] rf#1 score=0.10400 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.6, 'min_samples_leaf': 50, 'n_estimators': 200}
2025-12-16 13:25:26,522 | INFO | [keep] rf#2 score=0.10253 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.6, 'min_samples_leaf': 20, 'n_estimators': 300}
2025-12-16 13:25:38,807 | INFO | [keep] lgbm_gbdt#1 score=0.09793 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.05), 'max_bin': np.int64(127), 'max_depth': np.int64(4), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(50), 'num_leaves': np.int64(7), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 3.8166323444941797, 'reg_lambda': 0.15648973361257507} | n_estimators(refit)=27
2025-12-16 13:25:38,851 | INFO | [keep] lgbm_gbdt#2 score=0.08785 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.05), 'max_bin': np.int64(127), 'max_depth': np.int64(4), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 1.569905318887705, 'reg_lambda': 0.29928644475767835} | n_estimators(refit)=20
2025-12-16 13:26:11,897 | INFO | [keep] lgbm_dart#1 score=0.09983 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'drop_rate': np.float64(0.5), 'learning_rate': np.float64(0.05), 'max_bin': np.int64(63), 'max_depth': np.int64(6), 'max_drop': np.int64(10), 'min_child_samples': np.int64(200), 'min_child_weight': np.float64(0.01), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 14.084210996912105, 'reg_lambda': 0.12056103129408201}
2025-12-16 13:26:12,062 | INFO | [keep] lgbm_dart#2 score=0.09603 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'drop_rate': np.float64(0.2), 'learning_rate': np.float64(0.05), 'max_bin': np.int64(63), 'max_depth': np.int64(6), 'max_drop': np.int64(10), 'min_child_samples': np.int64(200), 'min_child_weight': np.float64(0.1), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(100), 'num_leaves': np.int64(31), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 0.2719839508265554, 'reg_lambda': 2.9118489461447954}
2025-12-16 13:26:12,062 | INFO | [pred] ridge#1: n=432 R2_OS=0.06364 mse=10.0925 mse0=10.7783 | y mean=0.678 std=3.22 | yhat mean=0.173 std=0.338 p1=-0.383 p99=1.03
2025-12-16 13:26:12,063 | INFO | [pred] ridge#1: |err| q99=18.033  tail_n=5/432  tail_share_SSE=47.99%
2025-12-16 13:26:12,065 | INFO | [pred] ridge#1: per-day mse days=19 p50=0.967904 p90=21.5163 p99=65.8436 max=72.0277
2025-12-16 13:26:12,065 | INFO | [pred] ridge#2: n=432 R2_OS=0.06382 mse=10.0905 mse0=10.7783 | y mean=0.678 std=3.22 | yhat mean=0.173 std=0.339 p1=-0.384 p99=1.03
2025-12-16 13:26:12,065 | INFO | [pred] ridge#2: |err| q99=18.0305  tail_n=5/432  tail_share_SSE=47.99%
2025-12-16 13:26:12,067 | INFO | [pred] ridge#2: per-day mse days=19 p50=0.967655 p90=21.5103 p99=65.8335 max=72.0175
2025-12-16 13:26:12,067 | INFO | [pred] lasso#1: n=432 R2_OS=0.04411 mse=10.303 mse0=10.7783 | y mean=0.678 std=3.22 | yhat mean=0.115 std=0.207 p1=-0.299 p99=0.537
2025-12-16 13:26:12,068 | INFO | [pred] lasso#1: |err| q99=18.2622  tail_n=5/432  tail_share_SSE=48.07%
2025-12-16 13:26:12,069 | INFO | [pred] lasso#1: per-day mse days=19 p50=0.919494 p90=22.1607 p99=66.1122 max=72.0404
2025-12-16 13:26:12,070 | INFO | [pred] lasso#2: n=432 R2_OS=0.04410 mse=10.303 mse0=10.7783 | y mean=0.678 std=3.22 | yhat mean=0.115 std=0.208 p1=-0.299 p99=0.537
2025-12-16 13:26:12,070 | INFO | [pred] lasso#2: |err| q99=18.2622  tail_n=5/432  tail_share_SSE=48.07%
2025-12-16 13:26:12,072 | INFO | [pred] lasso#2: per-day mse days=19 p50=0.919529 p90=22.1607 p99=66.1133 max=72.0417
2025-12-16 13:26:12,072 | INFO | [pred] elasticnet#1: n=432 R2_OS=0.04364 mse=10.308 mse0=10.7783 | y mean=0.678 std=3.22 | yhat mean=0.114 std=0.209 p1=-0.305 p99=0.535
2025-12-16 13:26:12,072 | INFO | [pred] elasticnet#1: |err| q99=18.2669  tail_n=5/432  tail_share_SSE=48.07%
2025-12-16 13:26:12,074 | INFO | [pred] elasticnet#1: per-day mse days=19 p50=0.921637 p90=22.173 p99=66.1636 max=72.1006
2025-12-16 13:26:12,074 | INFO | [pred] elasticnet#2: n=432 R2_OS=0.04366 mse=10.3078 mse0=10.7783 | y mean=0.678 std=3.22 | yhat mean=0.113 std=0.211 p1=-0.31 p99=0.539
2025-12-16 13:26:12,074 | INFO | [pred] elasticnet#2: |err| q99=18.2665  tail_n=5/432  tail_share_SSE=48.07%
2025-12-16 13:26:12,076 | INFO | [pred] elasticnet#2: per-day mse days=19 p50=0.922204 p90=22.1711 p99=66.1784 max=72.121
2025-12-16 13:26:12,077 | INFO | [pred] pcr#1: n=432 R2_OS=0.01859 mse=10.578 mse0=10.7783 | y mean=0.678 std=3.22 | yhat mean=-0.0031 std=0.132 p1=-0.232 p99=0.316
2025-12-16 13:26:12,077 | INFO | [pred] pcr#1: |err| q99=18.4395  tail_n=5/432  tail_share_SSE=47.59%
2025-12-16 13:26:12,079 | INFO | [pred] pcr#1: per-day mse days=19 p50=0.872465 p90=22.6618 p99=67.9839 max=74.0146
2025-12-16 13:26:12,079 | INFO | [pred] pcr#2: n=432 R2_OS=0.01859 mse=10.578 mse0=10.7783 | y mean=0.678 std=3.22 | yhat mean=-0.0031 std=0.132 p1=-0.232 p99=0.316
2025-12-16 13:26:12,080 | INFO | [pred] pcr#2: |err| q99=18.4395  tail_n=5/432  tail_share_SSE=47.59%
2025-12-16 13:26:12,081 | INFO | [pred] pcr#2: per-day mse days=19 p50=0.872465 p90=22.6618 p99=67.9839 max=74.0146
2025-12-16 13:26:12,082 | INFO | [pred] pls#1: n=432 R2_OS=0.08963 mse=9.81232 mse0=10.7783 | y mean=0.678 std=3.22 | yhat mean=0.534 std=0.469 p1=-0.413 p99=1.47
2025-12-16 13:26:12,082 | INFO | [pred] pls#1: |err| q99=17.5676  tail_n=5/432  tail_share_SSE=47.45%
2025-12-16 13:26:12,084 | INFO | [pred] pls#1: per-day mse days=19 p50=1.58375 p90=20.4006 p99=61.1486 max=66.4646
2025-12-16 13:26:12,084 | INFO | [pred] pls#2: n=432 R2_OS=0.10077 mse=9.69225 mse0=10.7783 | y mean=0.678 std=3.22 | yhat mean=0.386 std=0.615 p1=-0.689 p99=1.71
2025-12-16 13:26:12,084 | INFO | [pred] pls#2: |err| q99=17.523  tail_n=5/432  tail_share_SSE=48.14%
2025-12-16 13:26:12,086 | INFO | [pred] pls#2: per-day mse days=19 p50=1.40292 p90=20.1981 p99=61.3176 max=66.6903
2025-12-16 13:26:12,087 | INFO | [pred] L-En: n=432 R2_OS=0.05864 mse=10.1463 mse0=10.7783 | y mean=0.678 std=3.22 | yhat mean=0.172 std=0.262 p1=-0.274 p99=0.726
2025-12-16 13:26:12,088 | INFO | [pred] L-En: |err| q99=18.0988  tail_n=5/432  tail_share_SSE=48.15%
2025-12-16 13:26:12,089 | INFO | [pred] L-En: per-day mse days=19 p50=0.938581 p90=21.7158 p99=65.4024 max=71.2871
2025-12-16 13:26:12,092 | INFO | [pred] ffn#1: n=432 R2_OS=0.12495 mse=9.4316 mse0=10.7783 | y mean=0.678 std=3.22 | yhat mean=0.349 std=0.603 p1=-0.379 p99=1.96
2025-12-16 13:26:12,092 | INFO | [pred] ffn#1: |err| q99=17.2098  tail_n=5/432  tail_share_SSE=48.35%
2025-12-16 13:26:12,094 | INFO | [pred] ffn#1: per-day mse days=19 p50=1.52124 p90=19.3607 p99=60.8534 max=66.8369
2025-12-16 13:26:12,096 | INFO | [pred] ffn#2: n=432 R2_OS=0.12766 mse=9.40234 mse0=10.7783 | y mean=0.678 std=3.22 | yhat mean=0.36 std=0.624 p1=-0.422 p99=2.01
2025-12-16 13:26:12,096 | INFO | [pred] ffn#2: |err| q99=17.155  tail_n=5/432  tail_share_SSE=48.26%
2025-12-16 13:26:12,098 | INFO | [pred] ffn#2: per-day mse days=19 p50=1.43797 p90=19.2158 p99=60.6799 max=66.6644
2025-12-16 13:26:12,121 | INFO | [pred] rf#1: n=432 R2_OS=0.12019 mse=9.48292 mse0=10.7783 | y mean=0.678 std=3.22 | yhat mean=0.4 std=0.589 p1=-0.0923 p99=1.98
2025-12-16 13:26:12,121 | INFO | [pred] rf#1: |err| q99=17.0703  tail_n=5/432  tail_share_SSE=47.44%
2025-12-16 13:26:12,123 | INFO | [pred] rf#1: per-day mse days=19 p50=1.48004 p90=19.17 p99=60.528 max=65.8751
2025-12-16 13:26:12,145 | INFO | [pred] rf#2: n=432 R2_OS=0.12683 mse=9.41128 mse0=10.7783 | y mean=0.678 std=3.22 | yhat mean=0.423 std=0.622 p1=-0.0957 p99=2.18
2025-12-16 13:26:12,146 | INFO | [pred] rf#2: |err| q99=17.0377  tail_n=5/432  tail_share_SSE=47.22%
2025-12-16 13:26:12,147 | INFO | [pred] rf#2: per-day mse days=19 p50=1.61659 p90=19.1135 p99=59.3816 max=64.4899
2025-12-16 13:26:12,148 | INFO | [pred] lgbm_gbdt#1: n=432 R2_OS=0.10022 mse=9.69817 mse0=10.7783 | y mean=0.678 std=3.22 | yhat mean=0.371 std=0.617 p1=-0.109 p99=2.42
2025-12-16 13:26:12,149 | INFO | [pred] lgbm_gbdt#1: |err| q99=17.4357  tail_n=5/432  tail_share_SSE=47.44%
2025-12-16 13:26:12,150 | INFO | [pred] lgbm_gbdt#1: per-day mse days=19 p50=1.44673 p90=19.7466 p99=60.4671 max=65.5944
2025-12-16 13:26:12,151 | INFO | [pred] lgbm_gbdt#2: n=432 R2_OS=0.08990 mse=9.80941 mse0=10.7783 | y mean=0.678 std=3.22 | yhat mean=0.279 std=0.459 p1=-0.209 p99=1.53
2025-12-16 13:26:12,151 | INFO | [pred] lgbm_gbdt#2: |err| q99=17.6483  tail_n=5/432  tail_share_SSE=47.93%
2025-12-16 13:26:12,153 | INFO | [pred] lgbm_gbdt#2: per-day mse days=19 p50=1.4517 p90=20.6017 p99=61.7321 max=67.0147
2025-12-16 13:26:12,155 | INFO | [pred] lgbm_dart#1: n=432 R2_OS=0.12861 mse=9.39211 mse0=10.7783 | y mean=0.678 std=3.22 | yhat mean=0.395 std=0.696 p1=-0.232 p99=2.23
2025-12-16 13:26:12,155 | INFO | [pred] lgbm_dart#1: |err| q99=16.9984  tail_n=5/432  tail_share_SSE=46.96%
2025-12-16 13:26:12,157 | INFO | [pred] lgbm_dart#1: per-day mse days=19 p50=1.69768 p90=18.6977 p99=59.1287 max=64.2557
2025-12-16 13:26:12,158 | INFO | [pred] lgbm_dart#2: n=432 R2_OS=0.12730 mse=9.40622 mse0=10.7783 | y mean=0.678 std=3.22 | yhat mean=0.4 std=0.632 p1=-0.204 p99=2.05
2025-12-16 13:26:12,158 | INFO | [pred] lgbm_dart#2: |err| q99=17.183  tail_n=5/432  tail_share_SSE=47.64%
2025-12-16 13:26:12,160 | INFO | [pred] lgbm_dart#2: per-day mse days=19 p50=1.27661 p90=19.1726 p99=58.4727 max=63.3586
2025-12-16 13:26:26,434 | INFO | === Expanding step: train_to_2023-07__test_2023-08 ===
2025-12-16 13:26:26,440 | INFO | [guardrails] transform=none
2025-12-16 13:26:26,440 | INFO | [guardrails] winsor z: lower_q=0.0050 (-1.6872), upper_q=0.9950 (15.9524)
2025-12-16 13:26:26,985 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-16 13:26:30,291 | INFO | [keep] ridge#1 score=0.05215 params={'max_iter': np.int64(10000), 'alpha': 92.28295957427436}
2025-12-16 13:26:30,303 | INFO | [keep] ridge#2 score=0.05148 params={'max_iter': np.int64(10000), 'alpha': 86.26905220714896}
2025-12-16 13:26:37,473 | INFO | [keep] lasso#1 score=0.06905 params={'max_iter': np.int64(10000), 'alpha': 0.014135935551752304}
2025-12-16 13:26:37,488 | INFO | [keep] lasso#2 score=0.06901 params={'max_iter': np.int64(10000), 'alpha': 0.015470958549309927}
2025-12-16 13:26:47,886 | INFO | [keep] elasticnet#1 score=0.06880 params={'max_iter': np.int64(10000), 'alpha': 0.023358825194833552, 'l1_ratio': 0.5547471590949188}
2025-12-16 13:26:47,987 | INFO | [keep] elasticnet#2 score=0.06849 params={'max_iter': np.int64(10000), 'alpha': 0.020304615777978822, 'l1_ratio': 0.8135386840125377}
2025-12-16 13:26:48,983 | INFO | [keep] pcr#1 score=0.00823 params={'pca__n_components': 5, 'ridge__alpha': 0.0001}
2025-12-16 13:26:48,998 | INFO | [keep] pcr#2 score=0.00823 params={'pca__n_components': 5, 'ridge__alpha': 0.001}
2025-12-16 13:26:49,172 | INFO | [keep] pls#1 score=0.07620 params={'n_components': 1}
2025-12-16 13:26:49,186 | INFO | [keep] pls#2 score=0.05680 params={'n_components': 3}
2025-12-16 13:26:49,186 | INFO | Training FFN: ['ffn']
2025-12-16 14:09:56,606 | INFO | [keep] ffn#1 score=0.07753 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(64), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(32), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.49651215141776783, 'ffn__weight_decay': 0.0015998881492631496}
2025-12-16 14:10:26,351 | INFO | [keep] ffn#2 score=0.07742 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(64), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.39200724658983155, 'ffn__weight_decay': 0.0054475948916969}
2025-12-16 14:10:26,351 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-16 14:11:24,088 | INFO | [keep] rf#1 score=0.10950 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.6, 'min_samples_leaf': 20, 'n_estimators': 300}
2025-12-16 14:11:24,354 | INFO | [keep] rf#2 score=0.10907 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'log2', 'max_samples': 0.8, 'min_samples_leaf': 20, 'n_estimators': 100}
2025-12-16 14:11:36,963 | INFO | [keep] lgbm_gbdt#1 score=0.09060 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.1), 'max_bin': np.int64(127), 'max_depth': np.int64(6), 'min_child_samples': np.int64(200), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 1.3589482177682006, 'reg_lambda': 0.33945247683628305} | n_estimators(refit)=14
2025-12-16 14:11:37,008 | INFO | [keep] lgbm_gbdt#2 score=0.09060 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.1), 'max_bin': np.int64(127), 'max_depth': np.int64(6), 'min_child_samples': np.int64(200), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 0.23719409398804892, 'reg_lambda': 2.6941121346865606} | n_estimators(refit)=14
2025-12-16 14:12:10,012 | INFO | [keep] lgbm_dart#1 score=0.10621 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'drop_rate': np.float64(0.5), 'learning_rate': np.float64(0.05), 'max_bin': np.int64(63), 'max_depth': np.int64(6), 'max_drop': np.int64(10), 'min_child_samples': np.int64(200), 'min_child_weight': np.float64(0.01), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 14.084210996912105, 'reg_lambda': 0.12056103129408201}
2025-12-16 14:12:10,176 | INFO | [keep] lgbm_dart#2 score=0.09993 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'drop_rate': np.float64(0.2), 'learning_rate': np.float64(0.05), 'max_bin': np.int64(63), 'max_depth': np.int64(6), 'max_drop': np.int64(10), 'min_child_samples': np.int64(200), 'min_child_weight': np.float64(0.1), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(100), 'num_leaves': np.int64(31), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 0.2719839508265554, 'reg_lambda': 2.9118489461447954}
2025-12-16 14:12:10,177 | INFO | [pred] ridge#1: n=396 R2_OS=0.09034 mse=4.9268 mse0=5.4161 | y mean=0.493 std=2.28 | yhat mean=0.138 std=0.403 p1=-0.61 p99=1.17
2025-12-16 14:12:10,177 | INFO | [pred] ridge#1: |err| q99=10.8024  tail_n=4/396  tail_share_SSE=58.43%
2025-12-16 14:12:10,179 | INFO | [pred] ridge#1: per-day mse days=20 p50=1.4129 p90=12.7712 p99=19.7627 max=21.3426
2025-12-16 14:12:10,180 | INFO | [pred] ridge#2: n=396 R2_OS=0.09032 mse=4.92691 mse0=5.4161 | y mean=0.493 std=2.28 | yhat mean=0.138 std=0.405 p1=-0.615 p99=1.17
2025-12-16 14:12:10,180 | INFO | [pred] ridge#2: |err| q99=10.797  tail_n=4/396  tail_share_SSE=58.43%
2025-12-16 14:12:10,182 | INFO | [pred] ridge#2: per-day mse days=20 p50=1.4252 p90=12.773 p99=19.7571 max=21.335
2025-12-16 14:12:10,182 | INFO | [pred] lasso#1: n=396 R2_OS=0.07949 mse=4.98558 mse0=5.4161 | y mean=0.493 std=2.28 | yhat mean=0.153 std=0.235 p1=-0.307 p99=0.674
2025-12-16 14:12:10,182 | INFO | [pred] lasso#1: |err| q99=11.2229  tail_n=4/396  tail_share_SSE=57.94%
2025-12-16 14:12:10,184 | INFO | [pred] lasso#1: per-day mse days=20 p50=1.06975 p90=12.862 p99=20.5121 max=22.2244
2025-12-16 14:12:10,184 | INFO | [pred] lasso#2: n=396 R2_OS=0.07855 mse=4.99067 mse0=5.4161 | y mean=0.493 std=2.28 | yhat mean=0.151 std=0.229 p1=-0.298 p99=0.65
2025-12-16 14:12:10,184 | INFO | [pred] lasso#2: |err| q99=11.2323  tail_n=4/396  tail_share_SSE=57.88%
2025-12-16 14:12:10,186 | INFO | [pred] lasso#2: per-day mse days=20 p50=1.0699 p90=12.8672 p99=20.5473 max=22.2543
2025-12-16 14:12:10,187 | INFO | [pred] elasticnet#1: n=396 R2_OS=0.07971 mse=4.9844 mse0=5.4161 | y mean=0.493 std=2.28 | yhat mean=0.154 std=0.238 p1=-0.31 p99=0.686
2025-12-16 14:12:10,187 | INFO | [pred] elasticnet#1: |err| q99=11.22  tail_n=4/396  tail_share_SSE=57.96%
2025-12-16 14:12:10,188 | INFO | [pred] elasticnet#1: per-day mse days=20 p50=1.07153 p90=12.8621 p99=20.4991 max=22.2149
2025-12-16 14:12:10,189 | INFO | [pred] elasticnet#2: n=396 R2_OS=0.07759 mse=4.99585 mse0=5.4161 | y mean=0.493 std=2.28 | yhat mean=0.15 std=0.224 p1=-0.29 p99=0.628
2025-12-16 14:12:10,189 | INFO | [pred] elasticnet#2: |err| q99=11.2412  tail_n=4/396  tail_share_SSE=57.83%
2025-12-16 14:12:10,191 | INFO | [pred] elasticnet#2: per-day mse days=20 p50=1.07078 p90=12.8726 p99=20.5798 max=22.2823
2025-12-16 14:12:10,191 | INFO | [pred] pcr#1: n=396 R2_OS=0.00561 mse=5.38572 mse0=5.4161 | y mean=0.493 std=2.28 | yhat mean=-0.0153 std=0.124 p1=-0.255 p99=0.297
2025-12-16 14:12:10,192 | INFO | [pred] pcr#1: |err| q99=11.6804  tail_n=4/396  tail_share_SSE=56.33%
2025-12-16 14:12:10,193 | INFO | [pred] pcr#1: per-day mse days=20 p50=1.26073 p90=13.46 p99=22.3989 max=24.1258
2025-12-16 14:12:10,194 | INFO | [pred] pcr#2: n=396 R2_OS=0.00561 mse=5.38572 mse0=5.4161 | y mean=0.493 std=2.28 | yhat mean=-0.0153 std=0.124 p1=-0.255 p99=0.297
2025-12-16 14:12:10,194 | INFO | [pred] pcr#2: |err| q99=11.6804  tail_n=4/396  tail_share_SSE=56.33%
2025-12-16 14:12:10,196 | INFO | [pred] pcr#2: per-day mse days=20 p50=1.26073 p90=13.46 p99=22.3989 max=24.1258
2025-12-16 14:12:10,196 | INFO | [pred] pls#1: n=396 R2_OS=0.12943 mse=4.71508 mse0=5.4161 | y mean=0.493 std=2.28 | yhat mean=0.563 std=0.416 p1=-0.154 p99=1.47
2025-12-16 14:12:10,196 | INFO | [pred] pls#1: |err| q99=10.6429  tail_n=4/396  tail_share_SSE=56.27%
2025-12-16 14:12:10,198 | INFO | [pred] pls#1: per-day mse days=20 p50=1.30342 p90=12.2259 p99=18.0184 max=19.3093
2025-12-16 14:12:10,198 | INFO | [pred] pls#2: n=396 R2_OS=0.15722 mse=4.5646 mse0=5.4161 | y mean=0.493 std=2.28 | yhat mean=0.318 std=0.608 p1=-0.734 p99=1.59
2025-12-16 14:12:10,199 | INFO | [pred] pls#2: |err| q99=11.0079  tail_n=4/396  tail_share_SSE=56.19%
2025-12-16 14:12:10,200 | INFO | [pred] pls#2: per-day mse days=20 p50=1.15874 p90=11.7461 p99=19.0712 max=20.6152
2025-12-16 14:12:10,202 | INFO | [pred] L-En: n=396 R2_OS=0.09049 mse=4.92603 mse0=5.4161 | y mean=0.493 std=2.28 | yhat mean=0.173 std=0.276 p1=-0.312 p99=0.724
2025-12-16 14:12:10,202 | INFO | [pred] L-En: |err| q99=11.1527  tail_n=4/396  tail_share_SSE=58.02%
2025-12-16 14:12:10,204 | INFO | [pred] L-En: per-day mse days=20 p50=1.11853 p90=12.7834 p99=20.2363 max=21.8652
2025-12-16 14:12:10,206 | INFO | [pred] ffn#1: n=396 R2_OS=0.16716 mse=4.51073 mse0=5.4161 | y mean=0.493 std=2.28 | yhat mean=0.245 std=0.575 p1=-0.503 p99=1.79
2025-12-16 14:12:10,206 | INFO | [pred] ffn#1: |err| q99=10.0537  tail_n=4/396  tail_share_SSE=58.80%
2025-12-16 14:12:10,208 | INFO | [pred] ffn#1: per-day mse days=20 p50=1.03955 p90=11.0676 p99=16.66 max=17.6367
2025-12-16 14:12:10,210 | INFO | [pred] ffn#2: n=396 R2_OS=0.16815 mse=4.50539 mse0=5.4161 | y mean=0.493 std=2.28 | yhat mean=0.513 std=0.661 p1=-0.589 p99=2.33
2025-12-16 14:12:10,210 | INFO | [pred] ffn#2: |err| q99=10.302  tail_n=4/396  tail_share_SSE=56.11%
2025-12-16 14:12:10,212 | INFO | [pred] ffn#2: per-day mse days=20 p50=1.09442 p90=10.9297 p99=16.4795 max=17.5733
2025-12-16 14:12:10,234 | INFO | [pred] rf#1: n=396 R2_OS=0.18599 mse=4.40875 mse0=5.4161 | y mean=0.493 std=2.28 | yhat mean=0.459 std=0.632 p1=-0.101 p99=2.15
2025-12-16 14:12:10,235 | INFO | [pred] rf#1: |err| q99=10.9311  tail_n=4/396  tail_share_SSE=55.56%
2025-12-16 14:12:10,236 | INFO | [pred] rf#1: per-day mse days=20 p50=1.13468 p90=11.1541 p99=17.1396 max=18.4118
2025-12-16 14:12:10,248 | INFO | [pred] rf#2: n=396 R2_OS=0.16678 mse=4.51283 mse0=5.4161 | y mean=0.493 std=2.28 | yhat mean=0.396 std=0.559 p1=-0.0961 p99=2
2025-12-16 14:12:10,249 | INFO | [pred] rf#2: |err| q99=10.8824  tail_n=4/396  tail_share_SSE=56.80%
2025-12-16 14:12:10,251 | INFO | [pred] rf#2: per-day mse days=20 p50=1.06633 p90=11.4399 p99=17.6171 max=18.9924
2025-12-16 14:12:10,251 | INFO | [pred] lgbm_gbdt#1: n=396 R2_OS=0.18065 mse=4.43769 mse0=5.4161 | y mean=0.493 std=2.28 | yhat mean=0.419 std=0.718 p1=-0.164 p99=2.35
2025-12-16 14:12:10,252 | INFO | [pred] lgbm_gbdt#1: |err| q99=11.0412  tail_n=4/396  tail_share_SSE=53.70%
2025-12-16 14:12:10,253 | INFO | [pred] lgbm_gbdt#1: per-day mse days=20 p50=1.30991 p90=10.9936 p99=16.7921 max=18.0514
2025-12-16 14:12:10,254 | INFO | [pred] lgbm_gbdt#2: n=396 R2_OS=0.19110 mse=4.38107 mse0=5.4161 | y mean=0.493 std=2.28 | yhat mean=0.42 std=0.676 p1=-0.174 p99=2.4
2025-12-16 14:12:10,254 | INFO | [pred] lgbm_gbdt#2: |err| q99=10.7846  tail_n=4/396  tail_share_SSE=55.06%
2025-12-16 14:12:10,256 | INFO | [pred] lgbm_gbdt#2: per-day mse days=20 p50=1.19074 p90=11.0516 p99=16.5875 max=17.809
2025-12-16 14:12:10,257 | INFO | [pred] lgbm_dart#1: n=396 R2_OS=0.21433 mse=4.25527 mse0=5.4161 | y mean=0.493 std=2.28 | yhat mean=0.409 std=0.738 p1=-0.205 p99=2.58
2025-12-16 14:12:10,257 | INFO | [pred] lgbm_dart#1: |err| q99=10.4769  tail_n=4/396  tail_share_SSE=54.27%
2025-12-16 14:12:10,259 | INFO | [pred] lgbm_dart#1: per-day mse days=20 p50=1.56624 p90=10.6236 p99=15.5276 max=16.6204
2025-12-16 14:12:10,260 | INFO | [pred] lgbm_dart#2: n=396 R2_OS=0.21265 mse=4.26438 mse0=5.4161 | y mean=0.493 std=2.28 | yhat mean=0.427 std=0.677 p1=-0.136 p99=2.29
2025-12-16 14:12:10,260 | INFO | [pred] lgbm_dart#2: |err| q99=10.8353  tail_n=4/396  tail_share_SSE=55.53%
2025-12-16 14:12:10,262 | INFO | [pred] lgbm_dart#2: per-day mse days=20 p50=1.21014 p90=10.8694 p99=16.6047 max=17.8823
2025-12-16 14:12:23,900 | INFO | Wrote expanding predictions: results/dh_ret/all-all/IBM/predictions_expanding.csv
2025-12-16 14:12:23,901 | INFO | [Selection] Choosing best model variant per family based on Aggregate R2_OS:
2025-12-16 14:12:23,901 | INFO |   > Family L-En: Winner=L-En (R2=0.0798)
2025-12-16 14:12:23,901 | INFO |   > Family N-En: Winner=N-En (R2=0.1425)
2025-12-16 14:12:23,901 | INFO |   > Family elasticnet: Winner=elasticnet#2 (R2=0.0647) | Dropped=['elasticnet#1']
2025-12-16 14:12:23,901 | INFO |   > Family ffn: Winner=ffn#2 (R2=0.1261) | Dropped=['ffn#1']
2025-12-16 14:12:23,901 | INFO |   > Family lasso: Winner=lasso#2 (R2=0.0647) | Dropped=['lasso#1']
2025-12-16 14:12:23,901 | INFO |   > Family lgbm_dart: Winner=lgbm_dart#1 (R2=0.1385) | Dropped=['lgbm_dart#2']
2025-12-16 14:12:23,901 | INFO |   > Family lgbm_gbdt: Winner=lgbm_gbdt#2 (R2=0.1393) | Dropped=['lgbm_gbdt#1']
2025-12-16 14:12:23,901 | INFO |   > Family pcr: Winner=pcr#2 (R2=0.0237) | Dropped=['pcr#1']
2025-12-16 14:12:23,901 | INFO |   > Family pls: Winner=pls#2 (R2=0.1259) | Dropped=['pls#1']
2025-12-16 14:12:23,901 | INFO |   > Family rf: Winner=rf#1 (R2=0.1529) | Dropped=['rf#2']
2025-12-16 14:12:23,901 | INFO |   > Family ridge: Winner=ridge#2 (R2=0.0785) | Dropped=['ridge#1']
2025-12-16 14:12:32,468 | INFO | [SHAP] Generating plots for subset: all (n=396)
2025-12-16 14:13:04,745 | INFO | [SHAP] Generating plots for subset: dte_1_7 (n=64)
2025-12-16 14:13:24,127 | INFO | [SHAP] Generating plots for subset: dte_8_31 (n=332)
2025-12-16 14:13:52,876 | INFO | [SHAP] Skipping subset itm (n=8 too small)
2025-12-16 14:13:52,876 | INFO | [SHAP] Generating plots for subset: atm (n=214)
2025-12-16 14:14:15,058 | INFO | [SHAP] Generating plots for subset: otm (n=174)
2025-12-16 14:14:37,582 | INFO | Variant complete (expanding monthly). Yay! :)
