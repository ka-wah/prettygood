2025-12-12 20:57:46,410 | INFO | === Expanding step: train_to_2023-02__test_2023-03 ===
2025-12-12 20:57:46,410 | INFO | Step out_dir: results/dh_ret/all-all/IBMCTINTERACTIONS/monthly/2023-03
2025-12-12 20:57:46,410 | INFO | train_end=2023-02 | test_month=2023-03
2025-12-12 20:57:46,410 | INFO | Split sizes: train=4700 | val=716 | test=1111
2025-12-12 20:57:46,414 | INFO | [guardrails] transform=none
2025-12-12 20:57:46,414 | INFO | [guardrails] winsor z: lower_q=0.0100 (-1.55488), upper_q=0.9900 (5.93399)
2025-12-12 20:57:46,734 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-12 20:57:48,218 | INFO | [keep] ridge#1 score=-0.18862 params={'max_iter': np.int64(10000), 'alpha': 4.6692064912482625}
2025-12-12 20:57:48,224 | INFO | [keep] ridge#2 score=-0.18877 params={'max_iter': np.int64(10000), 'alpha': 4.927032682174098}
2025-12-12 20:58:18,636 | INFO | [keep] lasso#1 score=0.00859 params={'max_iter': np.int64(10000), 'alpha': 0.08432558817326784}
2025-12-12 20:58:18,642 | INFO | [keep] lasso#2 score=0.00828 params={'max_iter': np.int64(10000), 'alpha': 0.07634611079196907}
2025-12-12 20:58:52,650 | INFO | [keep] elasticnet#1 score=0.00831 params={'max_iter': np.int64(10000), 'alpha': 0.23948569385987084, 'l1_ratio': 0.36756187004789653}
2025-12-12 20:58:52,656 | INFO | [keep] elasticnet#2 score=0.00781 params={'max_iter': np.int64(10000), 'alpha': 0.8516144627787162, 'l1_ratio': 0.10204481074802807}
2025-12-12 20:58:53,110 | INFO | [keep] pcr#1 score=0.00440 params={'pca__n_components': 1, 'ridge__alpha': 1.0}
2025-12-12 20:58:53,118 | INFO | [keep] pcr#2 score=0.00440 params={'pca__n_components': 1, 'ridge__alpha': 0.1}
2025-12-12 20:58:53,198 | INFO | [keep] pls#1 score=-0.07092 params={'n_components': 2}
2025-12-12 20:58:53,204 | INFO | [keep] pls#2 score=-0.15111 params={'n_components': 1}
2025-12-12 20:58:53,204 | INFO | Training FFN: ['ffn']
2025-12-12 21:01:47,823 | INFO | [keep] ffn#1 score=0.00851 params={'ffn__activation': np.str_('gelu'), 'ffn__batch_size': np.int64(1024), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(128), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(5), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(1.0), 'ffn__dropout': 0.03177184646466966, 'ffn__weight_decay': 0.0007126197149987634}
2025-12-12 21:01:48,840 | INFO | [keep] ffn#2 score=0.00654 params={'ffn__activation': np.str_('gelu'), 'ffn__batch_size': np.int64(1024), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0005), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(5), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(1.0), 'ffn__dropout': 0.19563098100050666, 'ffn__weight_decay': 1.969043480269283e-05}
2025-12-12 21:01:48,840 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-12 21:05:59,662 | INFO | [keep] rf#1 score=0.01016 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.7, 'min_samples_leaf': 50, 'min_samples_split': 10, 'n_estimators': 1500}
2025-12-12 21:06:00,846 | INFO | [keep] rf#2 score=0.00990 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.7, 'min_samples_leaf': 50, 'min_samples_split': 2, 'n_estimators': 1000}
2025-12-12 21:06:16,600 | INFO | [keep] lgbm_gbdt#1 score=0.01748 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.01), 'max_bin': np.int64(127), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(800), 'num_leaves': np.int64(127), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 0.042444613236089244, 'reg_lambda': 0.0012073863726279688} | n_estimators(refit)=60
2025-12-12 21:06:16,838 | INFO | [keep] lgbm_gbdt#2 score=0.01642 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.01), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(2000), 'num_leaves': np.int64(127), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 3.144350681997742, 'reg_lambda': 0.01394969264149467} | n_estimators(refit)=81
2025-12-12 21:13:40,452 | INFO | [keep] lgbm_dart#1 score=0.01658 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.2), 'learning_rate': np.float64(0.01), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'max_drop': np.int64(10), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.001), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(2000), 'num_leaves': np.int64(127), 'skip_drop': np.float64(0.25), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.0002744715100024846, 'reg_lambda': 4.14703477353411e-06}
2025-12-12 21:13:42,862 | INFO | [keep] lgbm_dart#2 score=0.01520 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.1), 'learning_rate': np.float64(0.01), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'max_drop': np.int64(10), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.001), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(1200), 'num_leaves': np.int64(63), 'skip_drop': np.float64(0.1), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.12382412482913521, 'reg_lambda': 1.4787982649626883e-06}
