2025-12-12 20:57:46,380 | INFO | Loaded data: 13142 rows, 162 cols
2025-12-12 20:57:46,402 | INFO | After contract filters: 6279 rows
2025-12-12 20:57:46,413 | INFO | [expanding] enabled=True | freq=M | min_train_months=38 | months_total=44
2025-12-12 20:57:46,418 | INFO | === Expanding step: train_to_2023-02__test_2023-03 ===
2025-12-12 20:57:46,419 | INFO | Step out_dir: results/dh_ret/put-all/IBMCTINTERACTIONS/monthly/2023-03
2025-12-12 20:57:46,419 | INFO | train_end=2023-02 | test_month=2023-03
2025-12-12 20:57:46,419 | INFO | Split sizes: train=2204 | val=418 | test=526
2025-12-12 20:57:46,422 | INFO | [guardrails] transform=none
2025-12-12 20:57:46,422 | INFO | [guardrails] winsor z: lower_q=0.0100 (-1.48632), upper_q=0.9900 (6.41867)
2025-12-12 20:57:46,637 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-12 20:57:47,724 | INFO | [keep] ridge#1 score=-0.36306 params={'max_iter': np.int64(10000), 'alpha': 8.291189979207587}
2025-12-12 20:57:47,728 | INFO | [keep] ridge#2 score=-0.37638 params={'max_iter': np.int64(10000), 'alpha': 7.08481306320402}
2025-12-12 20:57:59,093 | INFO | [keep] lasso#1 score=0.01199 params={'max_iter': np.int64(10000), 'alpha': 0.22420123713724424}
2025-12-12 20:57:59,097 | INFO | [keep] lasso#2 score=0.01188 params={'max_iter': np.int64(10000), 'alpha': 0.19347247288603966}
2025-12-12 20:58:11,596 | INFO | [keep] elasticnet#1 score=0.01231 params={'max_iter': np.int64(10000), 'alpha': 0.8750516426087294, 'l1_ratio': 0.21689698439847394}
2025-12-12 20:58:11,600 | INFO | [keep] elasticnet#2 score=0.01211 params={'max_iter': np.int64(10000), 'alpha': 0.6053082080079019, 'l1_ratio': 0.3834415188257777}
2025-12-12 20:58:11,974 | INFO | [keep] pcr#1 score=0.01319 params={'pca__n_components': 5, 'ridge__alpha': 1.0}
2025-12-12 20:58:11,980 | INFO | [keep] pcr#2 score=0.01318 params={'pca__n_components': 5, 'ridge__alpha': 0.1}
2025-12-12 20:58:12,035 | INFO | [keep] pls#1 score=0.01047 params={'n_components': 1}
2025-12-12 20:58:12,039 | INFO | [keep] pls#2 score=-0.01607 params={'n_components': 2}
2025-12-12 20:58:12,039 | INFO | Training FFN: ['ffn']
2025-12-12 21:00:13,331 | INFO | [keep] ffn#1 score=0.02457 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(1024), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(32), 'ffn__huber_delta': np.float64(0.5), 'ffn__learning_rate': np.float64(0.001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(0.5), 'ffn__dropout': 0.06685914540449407, 'ffn__weight_decay': 1.7441989086524684e-06}
2025-12-12 21:00:14,777 | INFO | [keep] ffn#2 score=0.02211 params={'ffn__activation': np.str_('gelu'), 'ffn__batch_size': np.int64(512), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(2), 'ffn__patience': np.int64(5), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(0.5), 'ffn__dropout': 0.14592313466659965, 'ffn__weight_decay': 2.2136427671228553e-05}
2025-12-12 21:00:14,778 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-12 21:04:16,651 | INFO | [keep] rf#1 score=0.02166 params={'bootstrap': True, 'max_depth': 12, 'max_features': 'log2', 'max_samples': 0.7, 'min_samples_leaf': 20, 'min_samples_split': 2, 'n_estimators': 600}
2025-12-12 21:04:17,114 | INFO | [keep] rf#2 score=0.02107 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'log2', 'max_samples': 0.7, 'min_samples_leaf': 20, 'min_samples_split': 5, 'n_estimators': 600}
2025-12-12 21:04:25,610 | INFO | [keep] lgbm_gbdt#1 score=0.02484 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(63), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(800), 'num_leaves': np.int64(63), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 0.01985005396378788, 'reg_lambda': 0.005616032613563234} | n_estimators(refit)=92
2025-12-12 21:04:25,787 | INFO | [keep] lgbm_gbdt#2 score=0.02181 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.01), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(2000), 'num_leaves': np.int64(127), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 3.144350681997742, 'reg_lambda': 0.01394969264149467} | n_estimators(refit)=159
2025-12-12 21:09:20,847 | INFO | [keep] lgbm_dart#1 score=0.01376 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.2), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(63), 'max_depth': np.int64(3), 'max_drop': np.int64(50), 'min_child_samples': np.int64(200), 'min_child_weight': np.float64(0.001), 'min_split_gain': np.float64(0.05), 'n_estimators': np.int64(1200), 'num_leaves': np.int64(63), 'skip_drop': np.float64(0.25), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.05156246855727782, 'reg_lambda': 0.41351405841804467}
2025-12-12 21:09:21,429 | INFO | [keep] lgbm_dart#2 score=0.01374 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.15), 'learning_rate': np.float64(0.01), 'max_bin': np.int64(63), 'max_depth': np.int64(4), 'max_drop': np.int64(10), 'min_child_samples': np.int64(200), 'min_child_weight': np.float64(0.01), 'min_split_gain': np.float64(0.05), 'n_estimators': np.int64(1200), 'num_leaves': np.int64(127), 'skip_drop': np.float64(0.1), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 0.01106537076242519, 'reg_lambda': 0.2846138519843201}
2025-12-12 21:09:45,958 | INFO | === Expanding step: train_to_2023-03__test_2023-04 ===
2025-12-12 21:09:45,958 | INFO | Step out_dir: results/dh_ret/put-all/IBMCTINTERACTIONS/monthly/2023-04
2025-12-12 21:09:45,958 | INFO | train_end=2023-03 | test_month=2023-04
2025-12-12 21:09:45,958 | INFO | Split sizes: train=2239 | val=446 | test=441
2025-12-12 21:09:45,961 | INFO | [guardrails] transform=none
2025-12-12 21:09:45,961 | INFO | [guardrails] winsor z: lower_q=0.0100 (-1.48547), upper_q=0.9900 (6.41397)
2025-12-12 21:09:46,183 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-12 21:09:47,254 | INFO | [keep] ridge#1 score=-0.38469 params={'max_iter': np.int64(10000), 'alpha': 8.291189979207587}
2025-12-12 21:09:47,258 | INFO | [keep] ridge#2 score=-0.39563 params={'max_iter': np.int64(10000), 'alpha': 7.08481306320402}
2025-12-12 21:10:00,143 | INFO | [keep] lasso#1 score=0.01162 params={'max_iter': np.int64(10000), 'alpha': 0.16598654663071272}
2025-12-12 21:10:00,147 | INFO | [keep] lasso#2 score=0.01161 params={'max_iter': np.int64(10000), 'alpha': 0.22420123713724424}
2025-12-12 21:10:14,815 | INFO | [keep] elasticnet#1 score=0.01182 params={'max_iter': np.int64(10000), 'alpha': 0.8750516426087294, 'l1_ratio': 0.21689698439847394}
2025-12-12 21:10:14,819 | INFO | [keep] elasticnet#2 score=0.01166 params={'max_iter': np.int64(10000), 'alpha': 0.40298045932583026, 'l1_ratio': 0.613965955965896}
2025-12-12 21:10:15,214 | INFO | [keep] pcr#1 score=0.00984 params={'pca__n_components': 5, 'ridge__alpha': 1.0}
2025-12-12 21:10:15,223 | INFO | [keep] pcr#2 score=0.00983 params={'pca__n_components': 5, 'ridge__alpha': 0.1}
2025-12-12 21:10:15,283 | INFO | [keep] pls#1 score=0.01135 params={'n_components': 1}
2025-12-12 21:10:15,288 | INFO | [keep] pls#2 score=-0.00222 params={'n_components': 2}
2025-12-12 21:10:15,288 | INFO | Training FFN: ['ffn']
2025-12-12 21:12:18,924 | INFO | [keep] ffn#1 score=0.02335 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(1024), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(2.0), 'ffn__learning_rate': np.float64(0.001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(2), 'ffn__patience': np.int64(20), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(0.5), 'ffn__dropout': 0.25471149252855324, 'ffn__weight_decay': 1.2586757923192073e-06}
2025-12-12 21:12:20,353 | INFO | [keep] ffn#2 score=0.02261 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(512), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(128), 'ffn__huber_delta': np.float64(2.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(1.0), 'ffn__dropout': 0.26414276677577864, 'ffn__weight_decay': 0.0005684684928527873}
2025-12-12 21:12:20,353 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-12 21:16:22,538 | INFO | [keep] rf#1 score=0.02319 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'log2', 'max_samples': 0.7, 'min_samples_leaf': 20, 'min_samples_split': 5, 'n_estimators': 600}
2025-12-12 21:16:22,980 | INFO | [keep] rf#2 score=0.02310 params={'bootstrap': True, 'max_depth': 12, 'max_features': 'log2', 'max_samples': 0.7, 'min_samples_leaf': 20, 'min_samples_split': 2, 'n_estimators': 600}
2025-12-12 21:16:33,088 | INFO | [keep] lgbm_gbdt#1 score=0.02738 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(2000), 'num_leaves': np.int64(63), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 4.266367845929973e-05, 'reg_lambda': 0.0033418888058123737} | n_estimators(refit)=123
2025-12-12 21:16:33,128 | INFO | [keep] lgbm_gbdt#2 score=0.02567 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(63), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(800), 'num_leaves': np.int64(63), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 0.01985005396378788, 'reg_lambda': 0.005616032613563234} | n_estimators(refit)=45
2025-12-12 21:20:56,494 | INFO | [keep] lgbm_dart#1 score=0.01748 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.15), 'learning_rate': np.float64(0.01), 'max_bin': np.int64(63), 'max_depth': np.int64(4), 'max_drop': np.int64(50), 'min_child_samples': np.int64(400), 'min_child_weight': np.float64(0.1), 'min_split_gain': np.float64(0.0), 'n_estimators': np.int64(3000), 'num_leaves': np.int64(63), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.0009294494253199153, 'reg_lambda': 6.468274888037312e-05}
2025-12-12 21:21:02,093 | INFO | [keep] lgbm_dart#2 score=0.01726 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.2), 'learning_rate': np.float64(0.005), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'max_drop': np.int64(10), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.001), 'min_split_gain': np.float64(0.0), 'n_estimators': np.int64(3000), 'num_leaves': np.int64(127), 'skip_drop': np.float64(0.1), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.06927184499120616, 'reg_lambda': 5.785303828922974e-06}
2025-12-12 21:21:17,848 | INFO | === Expanding step: train_to_2023-04__test_2023-05 ===
2025-12-12 21:21:17,848 | INFO | Step out_dir: results/dh_ret/put-all/IBMCTINTERACTIONS/monthly/2023-05
2025-12-12 21:21:17,848 | INFO | train_end=2023-04 | test_month=2023-05
2025-12-12 21:21:17,848 | INFO | Split sizes: train=2278 | val=427 | test=505
2025-12-12 21:21:17,851 | INFO | [guardrails] transform=none
2025-12-12 21:21:17,852 | INFO | [guardrails] winsor z: lower_q=0.0100 (-1.50342), upper_q=0.9900 (6.40873)
2025-12-12 21:21:18,121 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-12 21:21:19,399 | INFO | [keep] ridge#1 score=-0.34246 params={'max_iter': np.int64(10000), 'alpha': 8.291189979207587}
2025-12-12 21:21:19,403 | INFO | [keep] ridge#2 score=-0.34916 params={'max_iter': np.int64(10000), 'alpha': 7.08481306320402}
2025-12-12 21:21:33,287 | INFO | [keep] lasso#1 score=0.01234 params={'max_iter': np.int64(10000), 'alpha': 0.16598654663071272}
2025-12-12 21:21:33,291 | INFO | [keep] lasso#2 score=0.01215 params={'max_iter': np.int64(10000), 'alpha': 0.19347247288603966}
2025-12-12 21:21:47,979 | INFO | [keep] elasticnet#1 score=0.01230 params={'max_iter': np.int64(10000), 'alpha': 0.8750516426087294, 'l1_ratio': 0.21689698439847394}
2025-12-12 21:21:47,984 | INFO | [keep] elasticnet#2 score=0.01201 params={'max_iter': np.int64(10000), 'alpha': 0.6053082080079019, 'l1_ratio': 0.3834415188257777}
2025-12-12 21:21:48,427 | INFO | [keep] pcr#1 score=0.01378 params={'pca__n_components': 5, 'ridge__alpha': 1.0}
2025-12-12 21:21:48,436 | INFO | [keep] pcr#2 score=0.01377 params={'pca__n_components': 5, 'ridge__alpha': 0.1}
2025-12-12 21:21:48,517 | INFO | [keep] pls#1 score=0.01656 params={'n_components': 1}
2025-12-12 21:21:48,523 | INFO | [keep] pls#2 score=-0.00067 params={'n_components': 2}
2025-12-12 21:21:48,523 | INFO | Training FFN: ['ffn']
2025-12-12 21:23:58,394 | INFO | [keep] ffn#1 score=0.03143 params={'ffn__activation': np.str_('gelu'), 'ffn__batch_size': np.int64(512), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(2), 'ffn__patience': np.int64(5), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(0.5), 'ffn__dropout': 0.14592313466659965, 'ffn__weight_decay': 2.2136427671228553e-05}
2025-12-12 21:23:59,615 | INFO | [keep] ffn#2 score=0.02756 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(1024), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(128), 'ffn__huber_delta': np.float64(0.5), 'ffn__learning_rate': np.float64(0.001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(20), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(1.0), 'ffn__dropout': 0.25763324046957065, 'ffn__weight_decay': 2.37415736236705e-05}
2025-12-12 21:23:59,618 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-12 21:27:45,140 | INFO | [keep] rf#1 score=0.02458 params={'bootstrap': True, 'max_depth': 12, 'max_features': 'log2', 'max_samples': 0.7, 'min_samples_leaf': 20, 'min_samples_split': 2, 'n_estimators': 600}
2025-12-12 21:27:46,439 | INFO | [keep] rf#2 score=0.02438 params={'bootstrap': True, 'max_depth': 12, 'max_features': 'log2', 'max_samples': 0.9, 'min_samples_leaf': 20, 'min_samples_split': 5, 'n_estimators': 1500}
2025-12-12 21:27:58,769 | INFO | [keep] lgbm_gbdt#1 score=0.02437 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(63), 'max_depth': np.int64(3), 'min_child_samples': np.int64(200), 'n_estimators': np.int64(800), 'num_leaves': np.int64(31), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.37046162123093973, 'reg_lambda': 0.0033692658737748773} | n_estimators(refit)=112
2025-12-12 21:27:58,830 | INFO | [keep] lgbm_gbdt#2 score=0.02371 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(1.0), 'learning_rate': np.float64(0.01), 'max_bin': np.int64(255), 'max_depth': np.int64(4), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(3000), 'num_leaves': np.int64(127), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.011518070709619632, 'reg_lambda': 0.10320701551211972} | n_estimators(refit)=126
2025-12-12 21:33:05,244 | INFO | [keep] lgbm_dart#1 score=0.01804 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.05), 'learning_rate': np.float64(0.003), 'max_bin': np.int64(127), 'max_depth': np.int64(-1), 'max_drop': np.int64(50), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.1), 'min_split_gain': np.float64(0.0), 'n_estimators': np.int64(1200), 'num_leaves': np.int64(63), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 3.093731730342483, 'reg_lambda': 1.5946590546637215e-06}
2025-12-12 21:33:07,918 | INFO | [keep] lgbm_dart#2 score=0.01803 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.15), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(255), 'max_depth': np.int64(4), 'max_drop': np.int64(50), 'min_child_samples': np.int64(200), 'min_child_weight': np.float64(0.01), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(2000), 'num_leaves': np.int64(63), 'skip_drop': np.float64(0.25), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 2.2753654630494613e-06, 'reg_lambda': 0.024554154276324118}
2025-12-12 21:33:24,316 | INFO | === Expanding step: train_to_2023-05__test_2023-06 ===
2025-12-12 21:33:24,316 | INFO | Step out_dir: results/dh_ret/put-all/IBMCTINTERACTIONS/monthly/2023-06
2025-12-12 21:33:24,316 | INFO | train_end=2023-05 | test_month=2023-06
2025-12-12 21:33:24,316 | INFO | Split sizes: train=2380 | val=407 | test=525
2025-12-12 21:33:24,319 | INFO | [guardrails] transform=none
2025-12-12 21:33:24,319 | INFO | [guardrails] winsor z: lower_q=0.0100 (-1.50331), upper_q=0.9900 (6.3808)
2025-12-12 21:33:24,544 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-12 21:33:25,798 | INFO | [keep] ridge#1 score=-0.21657 params={'max_iter': np.int64(10000), 'alpha': 8.291189979207587}
2025-12-12 21:33:25,802 | INFO | [keep] ridge#2 score=-0.22383 params={'max_iter': np.int64(10000), 'alpha': 7.08481306320402}
2025-12-12 21:33:37,359 | INFO | [keep] lasso#1 score=0.01240 params={'max_iter': np.int64(10000), 'alpha': 0.16598654663071272}
2025-12-12 21:33:37,362 | INFO | [keep] lasso#2 score=0.01224 params={'max_iter': np.int64(10000), 'alpha': 0.22420123713724424}
2025-12-12 21:33:50,482 | INFO | [keep] elasticnet#1 score=0.01242 params={'max_iter': np.int64(10000), 'alpha': 0.8750516426087294, 'l1_ratio': 0.21689698439847394}
2025-12-12 21:33:50,486 | INFO | [keep] elasticnet#2 score=0.01225 params={'max_iter': np.int64(10000), 'alpha': 0.6053082080079019, 'l1_ratio': 0.3834415188257777}
2025-12-12 21:33:50,887 | INFO | [keep] pcr#1 score=0.01893 params={'pca__n_components': 6, 'ridge__alpha': 1.0}
2025-12-12 21:33:50,893 | INFO | [keep] pcr#2 score=0.01892 params={'pca__n_components': 6, 'ridge__alpha': 0.1}
2025-12-12 21:33:50,952 | INFO | [keep] pls#1 score=0.01386 params={'n_components': 1}
2025-12-12 21:33:50,957 | INFO | [keep] pls#2 score=-0.00767 params={'n_components': 2}
2025-12-12 21:33:50,957 | INFO | Training FFN: ['ffn']
2025-12-12 21:36:06,515 | INFO | [keep] ffn#1 score=0.02660 params={'ffn__activation': np.str_('gelu'), 'ffn__batch_size': np.int64(512), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(2), 'ffn__patience': np.int64(5), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(0.5), 'ffn__dropout': 0.14592313466659965, 'ffn__weight_decay': 2.2136427671228553e-05}
2025-12-12 21:36:07,392 | INFO | [keep] ffn#2 score=0.02478 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(512), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0005), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(2), 'ffn__patience': np.int64(5), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(0.5), 'ffn__dropout': 0.10716222723363328, 'ffn__weight_decay': 0.0008293449987643943}
2025-12-12 21:36:07,393 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-12 21:39:59,937 | INFO | [keep] rf#1 score=0.02613 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.7, 'min_samples_leaf': 20, 'min_samples_split': 10, 'n_estimators': 600}
2025-12-12 21:40:01,191 | INFO | [keep] rf#2 score=0.02515 params={'bootstrap': True, 'max_depth': 12, 'max_features': 'log2', 'max_samples': 0.9, 'min_samples_leaf': 20, 'min_samples_split': 5, 'n_estimators': 1500}
2025-12-12 21:40:11,316 | INFO | [keep] lgbm_gbdt#1 score=0.02661 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.003), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(2000), 'num_leaves': np.int64(63), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 1.0830805002539181e-05, 'reg_lambda': 0.06230760683094162} | n_estimators(refit)=354
2025-12-12 21:40:11,526 | INFO | [keep] lgbm_gbdt#2 score=0.02554 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.005), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(3000), 'num_leaves': np.int64(63), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.49133425416186965, 'reg_lambda': 6.816785745902279} | n_estimators(refit)=191
2025-12-12 21:45:20,633 | INFO | [keep] lgbm_dart#1 score=0.02107 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.05), 'learning_rate': np.float64(0.003), 'max_bin': np.int64(127), 'max_depth': np.int64(-1), 'max_drop': np.int64(50), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.1), 'min_split_gain': np.float64(0.0), 'n_estimators': np.int64(1200), 'num_leaves': np.int64(63), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 3.093731730342483, 'reg_lambda': 1.5946590546637215e-06}
2025-12-12 21:45:20,935 | INFO | [keep] lgbm_dart#2 score=0.02033 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(0.8), 'drop_rate': np.float64(0.1), 'learning_rate': np.float64(0.01), 'max_bin': np.int64(127), 'max_depth': np.int64(4), 'max_drop': np.int64(10), 'min_child_samples': np.int64(200), 'min_child_weight': np.float64(0.01), 'min_split_gain': np.float64(0.0), 'n_estimators': np.int64(800), 'num_leaves': np.int64(127), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 3.1339239061547134e-06, 'reg_lambda': 0.00011208776772241358}
2025-12-12 21:45:39,594 | INFO | === Expanding step: train_to_2023-06__test_2023-07 ===
2025-12-12 21:45:39,594 | INFO | Step out_dir: results/dh_ret/put-all/IBMCTINTERACTIONS/monthly/2023-07
2025-12-12 21:45:39,594 | INFO | train_end=2023-06 | test_month=2023-07
2025-12-12 21:45:39,594 | INFO | Split sizes: train=2481 | val=531 | test=415
2025-12-12 21:45:39,597 | INFO | [guardrails] transform=none
2025-12-12 21:45:39,598 | INFO | [guardrails] winsor z: lower_q=0.0100 (-1.49319), upper_q=0.9900 (6.38048)
2025-12-12 21:45:39,830 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-12 21:45:40,973 | INFO | [keep] ridge#1 score=-0.30266 params={'max_iter': np.int64(10000), 'alpha': 8.291189979207587}
2025-12-12 21:45:40,978 | INFO | [keep] ridge#2 score=-0.33906 params={'max_iter': np.int64(10000), 'alpha': 7.08481306320402}
2025-12-12 21:45:51,561 | INFO | [keep] lasso#1 score=0.01050 params={'max_iter': np.int64(10000), 'alpha': 0.1065784610695946}
2025-12-12 21:45:51,565 | INFO | [keep] lasso#2 score=0.01044 params={'max_iter': np.int64(10000), 'alpha': 0.22420123713724424}
2025-12-12 21:46:03,478 | INFO | [keep] elasticnet#1 score=0.01164 params={'max_iter': np.int64(10000), 'alpha': 0.8516144627787162, 'l1_ratio': 0.10204481074802807}
2025-12-12 21:46:03,482 | INFO | [keep] elasticnet#2 score=0.01085 params={'max_iter': np.int64(10000), 'alpha': 0.23948569385987084, 'l1_ratio': 0.36756187004789653}
2025-12-12 21:46:03,898 | INFO | [keep] pcr#1 score=0.01579 params={'pca__n_components': 6, 'ridge__alpha': 1.0}
2025-12-12 21:46:03,904 | INFO | [keep] pcr#2 score=0.01579 params={'pca__n_components': 6, 'ridge__alpha': 0.1}
2025-12-12 21:46:03,966 | INFO | [keep] pls#1 score=0.00310 params={'n_components': 2}
2025-12-12 21:46:03,970 | INFO | [keep] pls#2 score=-0.00338 params={'n_components': 1}
2025-12-12 21:46:03,970 | INFO | Training FFN: ['ffn']
2025-12-12 21:49:05,099 | INFO | [keep] ffn#1 score=0.01577 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(512), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0005), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(2), 'ffn__patience': np.int64(5), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(0.5), 'ffn__dropout': 0.10716222723363328, 'ffn__weight_decay': 0.0008293449987643943}
2025-12-12 21:49:06,091 | INFO | [keep] ffn#2 score=0.01383 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(1024), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(2.0), 'ffn__learning_rate': np.float64(0.001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(2), 'ffn__patience': np.int64(20), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(0.5), 'ffn__dropout': 0.25471149252855324, 'ffn__weight_decay': 1.2586757923192073e-06}
2025-12-12 21:49:06,091 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-12 21:53:21,551 | INFO | [keep] rf#1 score=0.02013 params={'bootstrap': True, 'max_depth': 12, 'max_features': 'sqrt', 'max_samples': 0.9, 'min_samples_leaf': 20, 'min_samples_split': 10, 'n_estimators': 1500}
2025-12-12 21:53:22,861 | INFO | [keep] rf#2 score=0.02000 params={'bootstrap': True, 'max_depth': 12, 'max_features': 'sqrt', 'max_samples': 0.7, 'min_samples_leaf': 20, 'min_samples_split': 10, 'n_estimators': 1500}
2025-12-12 21:53:31,406 | INFO | [keep] lgbm_gbdt#1 score=0.02255 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.003), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(2000), 'num_leaves': np.int64(63), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 1.0830805002539181e-05, 'reg_lambda': 0.06230760683094162} | n_estimators(refit)=232
2025-12-12 21:53:31,652 | INFO | [keep] lgbm_gbdt#2 score=0.02224 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.005), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(3000), 'num_leaves': np.int64(63), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.49133425416186965, 'reg_lambda': 6.816785745902279} | n_estimators(refit)=243
2025-12-12 21:58:45,354 | INFO | [keep] lgbm_dart#1 score=0.02022 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'drop_rate': np.float64(0.1), 'learning_rate': np.float64(0.005), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'max_drop': np.int64(10), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.1), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(1200), 'num_leaves': np.int64(63), 'skip_drop': np.float64(0.25), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 0.49630716834181543, 'reg_lambda': 0.003703824297251048}
2025-12-12 21:58:47,646 | INFO | [keep] lgbm_dart#2 score=0.01834 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.05), 'learning_rate': np.float64(0.003), 'max_bin': np.int64(127), 'max_depth': np.int64(-1), 'max_drop': np.int64(50), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.1), 'min_split_gain': np.float64(0.0), 'n_estimators': np.int64(1200), 'num_leaves': np.int64(63), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 3.093731730342483, 'reg_lambda': 1.5946590546637215e-06}
2025-12-12 21:59:09,827 | INFO | === Expanding step: train_to_2023-07__test_2023-08 ===
2025-12-12 21:59:09,827 | INFO | Step out_dir: results/dh_ret/put-all/IBMCTINTERACTIONS/monthly/2023-08
2025-12-12 21:59:09,827 | INFO | train_end=2023-07 | test_month=2023-08
2025-12-12 21:59:09,827 | INFO | Split sizes: train=2551 | val=747 | test=373
2025-12-12 21:59:09,830 | INFO | [guardrails] transform=none
2025-12-12 21:59:09,830 | INFO | [guardrails] winsor z: lower_q=0.0100 (-1.48969), upper_q=0.9900 (6.32624)
2025-12-12 21:59:10,067 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-12 21:59:11,265 | INFO | [keep] ridge#1 score=-0.23993 params={'max_iter': np.int64(10000), 'alpha': 8.291189979207587}
2025-12-12 21:59:11,271 | INFO | [keep] ridge#2 score=-0.26447 params={'max_iter': np.int64(10000), 'alpha': 7.08481306320402}
2025-12-12 21:59:23,400 | INFO | [keep] lasso#1 score=0.01316 params={'max_iter': np.int64(10000), 'alpha': 0.08432558817326784}
2025-12-12 21:59:23,406 | INFO | [keep] lasso#2 score=0.01283 params={'max_iter': np.int64(10000), 'alpha': 0.07634611079196907}
2025-12-12 21:59:37,456 | INFO | [keep] elasticnet#1 score=0.01327 params={'max_iter': np.int64(10000), 'alpha': 0.8516144627787162, 'l1_ratio': 0.10204481074802807}
2025-12-12 21:59:37,461 | INFO | [keep] elasticnet#2 score=0.01307 params={'max_iter': np.int64(10000), 'alpha': 0.23948569385987084, 'l1_ratio': 0.36756187004789653}
2025-12-12 21:59:37,998 | INFO | [keep] pcr#1 score=0.01956 params={'pca__n_components': 6, 'ridge__alpha': 1.0}
2025-12-12 21:59:38,006 | INFO | [keep] pcr#2 score=0.01956 params={'pca__n_components': 6, 'ridge__alpha': 0.1}
2025-12-12 21:59:38,088 | INFO | [keep] pls#1 score=0.00891 params={'n_components': 1}
2025-12-12 21:59:38,094 | INFO | [keep] pls#2 score=0.00838 params={'n_components': 2}
2025-12-12 21:59:38,094 | INFO | Training FFN: ['ffn']
2025-12-12 22:03:15,501 | INFO | [keep] ffn#1 score=0.02419 params={'ffn__activation': np.str_('gelu'), 'ffn__batch_size': np.int64(1024), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(20), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(0.5), 'ffn__dropout': 0.1374777035499947, 'ffn__weight_decay': 5.079120681160787e-06}
2025-12-12 22:03:18,771 | INFO | [keep] ffn#2 score=0.01966 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(512), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(32), 'ffn__huber_delta': np.float64(0.5), 'ffn__learning_rate': np.float64(0.0005), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(2), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(1.0), 'ffn__dropout': 0.2719062682102642, 'ffn__weight_decay': 5.499468762911682e-05}
2025-12-12 22:03:18,772 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-12 22:07:17,698 | INFO | [keep] rf#1 score=0.02411 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'log2', 'max_samples': 0.9, 'min_samples_leaf': 20, 'min_samples_split': 2, 'n_estimators': 600}
2025-12-12 22:07:19,296 | INFO | [keep] rf#2 score=0.02275 params={'bootstrap': True, 'max_depth': 12, 'max_features': 'sqrt', 'max_samples': 0.7, 'min_samples_leaf': 20, 'min_samples_split': 10, 'n_estimators': 1500}
2025-12-12 22:07:30,941 | INFO | [keep] lgbm_gbdt#1 score=0.02491 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(1.0), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(127), 'max_depth': np.int64(4), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(1200), 'num_leaves': np.int64(31), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.00028278139120020197, 'reg_lambda': 4.670239773312262e-06} | n_estimators(refit)=35
2025-12-12 22:07:30,969 | INFO | [keep] lgbm_gbdt#2 score=0.02452 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(1.0), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(127), 'max_depth': np.int64(4), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(1200), 'num_leaves': np.int64(63), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 0.0007084073859958294, 'reg_lambda': 3.0490810454155356e-06} | n_estimators(refit)=46
2025-12-12 22:12:45,534 | INFO | [keep] lgbm_dart#1 score=0.02389 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.15), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'max_drop': np.int64(50), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.1), 'min_split_gain': np.float64(0.0), 'n_estimators': np.int64(1200), 'num_leaves': np.int64(63), 'skip_drop': np.float64(0.1), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 0.011300000038761235, 'reg_lambda': 1.5513060030054294e-05}
2025-12-12 22:12:47,771 | INFO | [keep] lgbm_dart#2 score=0.02230 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.05), 'learning_rate': np.float64(0.003), 'max_bin': np.int64(127), 'max_depth': np.int64(-1), 'max_drop': np.int64(50), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.1), 'min_split_gain': np.float64(0.0), 'n_estimators': np.int64(1200), 'num_leaves': np.int64(63), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 3.093731730342483, 'reg_lambda': 1.5946590546637215e-06}
2025-12-12 22:13:05,854 | INFO | Wrote expanding predictions: results/dh_ret/put-all/IBMCTINTERACTIONS/predictions_expanding.csv
2025-12-12 22:13:05,854 | INFO | Wrote steps summary: results/dh_ret/put-all/IBMCTINTERACTIONS/steps_summary.json
2025-12-12 22:13:28,684 | INFO | Variant complete (expanding monthly). Yay! :)
