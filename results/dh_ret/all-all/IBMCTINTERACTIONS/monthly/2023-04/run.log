2025-12-16 00:42:14,667 | INFO | === Expanding step: train_to_2023-03__test_2023-04 ===
2025-12-16 00:42:14,675 | INFO | [guardrails] transform=none
2025-12-16 00:42:14,676 | INFO | [guardrails] winsor z: lower_q=0.0050 (-1.67141), upper_q=0.9950 (16.0871)
2025-12-16 00:42:15,534 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-16 00:42:19,385 | INFO | [keep] ridge#1 score=-0.01540 params={'max_iter': np.int64(10000), 'alpha': 92.28295957427436}
2025-12-16 00:42:19,403 | INFO | [keep] ridge#2 score=-0.01885 params={'max_iter': np.int64(10000), 'alpha': 86.26905220714896}
2025-12-16 00:42:29,120 | INFO | [keep] lasso#1 score=0.05689 params={'max_iter': np.int64(10000), 'alpha': 0.017489966737814593}
2025-12-16 00:42:29,143 | INFO | [keep] lasso#2 score=0.05689 params={'max_iter': np.int64(10000), 'alpha': 0.017538232373118037}
2025-12-16 00:42:43,112 | INFO | [keep] elasticnet#1 score=0.05733 params={'max_iter': np.int64(10000), 'alpha': 0.05748291778269796, 'l1_ratio': 0.11608603694999485}
2025-12-16 00:42:43,184 | INFO | [keep] elasticnet#2 score=0.05708 params={'max_iter': np.int64(10000), 'alpha': 0.03565638590821156, 'l1_ratio': 0.20565448507612266}
2025-12-16 00:42:44,344 | INFO | [keep] pcr#1 score=-0.00853 params={'pca__n_components': 2, 'ridge__alpha': 0.0001}
2025-12-16 00:42:44,364 | INFO | [keep] pcr#2 score=-0.00853 params={'pca__n_components': 2, 'ridge__alpha': 0.001}
2025-12-16 00:42:44,571 | INFO | [keep] pls#1 score=0.01109 params={'n_components': 3}
2025-12-16 00:42:44,589 | INFO | [keep] pls#2 score=0.00212 params={'n_components': 2}
2025-12-16 00:42:44,593 | INFO | Training FFN: ['ffn']
2025-12-16 01:19:17,635 | INFO | [keep] ffn#1 score=0.06564 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(64), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.47878885927286424, 'ffn__weight_decay': 0.004336485563242767}
2025-12-16 01:19:35,175 | INFO | [keep] ffn#2 score=0.06412 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(64), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.4731634167180391, 'ffn__weight_decay': 0.0014653571755444989}
2025-12-16 01:19:35,175 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-16 01:20:30,494 | INFO | [keep] rf#1 score=0.08034 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.6, 'min_samples_leaf': 20, 'n_estimators': 100}
2025-12-16 01:20:30,810 | INFO | [keep] rf#2 score=0.07797 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.8, 'min_samples_leaf': 50, 'n_estimators': 100}
2025-12-16 01:20:45,582 | INFO | [keep] lgbm_gbdt#1 score=0.08369 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'learning_rate': np.float64(0.05), 'max_bin': np.int64(63), 'max_depth': np.int64(4), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(50), 'num_leaves': np.int64(15), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 0.4617232833016953, 'reg_lambda': 2.6659604721502874} | n_estimators(refit)=49
2025-12-16 01:20:45,830 | INFO | [keep] lgbm_gbdt#2 score=0.08107 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(63), 'max_depth': np.int64(6), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 1.2753898599202926, 'reg_lambda': 0.213737596049905} | n_estimators(refit)=101
2025-12-16 01:21:16,051 | INFO | [keep] lgbm_dart#1 score=0.09669 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'drop_rate': np.float64(0.2), 'learning_rate': np.float64(0.05), 'max_bin': np.int64(63), 'max_depth': np.int64(6), 'max_drop': np.int64(10), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.01), 'min_split_gain': np.float64(0.05), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 1.007908770912927, 'reg_lambda': 0.33582746295594984}
2025-12-16 01:21:16,577 | INFO | [keep] lgbm_dart#2 score=0.09140 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'drop_rate': np.float64(0.3), 'learning_rate': np.float64(0.1), 'max_bin': np.int64(127), 'max_depth': np.int64(6), 'max_drop': np.int64(20), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.01), 'min_split_gain': np.float64(0.05), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 19.475787289550833, 'reg_lambda': 0.8599203080926291}
2025-12-16 01:21:16,578 | INFO | [pred] ridge#1: n=521 R2_OS=0.07554 mse=4.58393 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.245 std=0.366 p1=-0.428 p99=1.16
2025-12-16 01:21:16,578 | INFO | [pred] ridge#1: |err| q99=9.93674  tail_n=6/521  tail_share_SSE=69.46%
2025-12-16 01:21:16,580 | INFO | [pred] ridge#1: per-day mse days=19 p50=0.648163 p90=13.5191 p99=26.6781 max=28.825
2025-12-16 01:21:16,581 | INFO | [pred] ridge#2: n=521 R2_OS=0.07554 mse=4.58395 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.243 std=0.367 p1=-0.432 p99=1.16
2025-12-16 01:21:16,581 | INFO | [pred] ridge#2: |err| q99=9.93223  tail_n=6/521  tail_share_SSE=69.46%
2025-12-16 01:21:16,583 | INFO | [pred] ridge#2: per-day mse days=19 p50=0.648922 p90=13.5129 p99=26.6872 max=28.8357
2025-12-16 01:21:16,583 | INFO | [pred] lasso#1: n=521 R2_OS=0.06168 mse=4.65264 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.235 std=0.236 p1=-0.212 p99=0.703
2025-12-16 01:21:16,583 | INFO | [pred] lasso#1: |err| q99=10.5022  tail_n=6/521  tail_share_SSE=69.97%
2025-12-16 01:21:16,585 | INFO | [pred] lasso#1: per-day mse days=19 p50=0.568211 p90=14.3359 p99=27.0126 max=29.2003
2025-12-16 01:21:16,586 | INFO | [pred] lasso#2: n=521 R2_OS=0.06168 mse=4.65265 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.235 std=0.236 p1=-0.212 p99=0.703
2025-12-16 01:21:16,586 | INFO | [pred] lasso#2: |err| q99=10.5021  tail_n=6/521  tail_share_SSE=69.97%
2025-12-16 01:21:16,588 | INFO | [pred] lasso#2: per-day mse days=19 p50=0.56861 p90=14.3363 p99=27.012 max=29.1996
2025-12-16 01:21:16,588 | INFO | [pred] elasticnet#1: n=521 R2_OS=0.06657 mse=4.6284 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.242 std=0.267 p1=-0.261 p99=0.826
2025-12-16 01:21:16,588 | INFO | [pred] elasticnet#1: |err| q99=10.4112  tail_n=6/521  tail_share_SSE=69.92%
2025-12-16 01:21:16,590 | INFO | [pred] elasticnet#1: per-day mse days=19 p50=0.500462 p90=14.1509 p99=26.9115 max=29.1005
2025-12-16 01:21:16,590 | INFO | [pred] elasticnet#2: n=521 R2_OS=0.06785 mse=4.62208 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.25 std=0.273 p1=-0.257 p99=0.846
2025-12-16 01:21:16,591 | INFO | [pred] elasticnet#2: |err| q99=10.3904  tail_n=6/521  tail_share_SSE=69.88%
2025-12-16 01:21:16,592 | INFO | [pred] elasticnet#2: per-day mse days=19 p50=0.520659 p90=14.1143 p99=26.8975 max=29.0912
2025-12-16 01:21:16,593 | INFO | [pred] pcr#1: n=521 R2_OS=-0.00632 mse=4.98985 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=-0.0381 std=0.0181 p1=-0.0701 p99=-0.00433
2025-12-16 01:21:16,593 | INFO | [pred] pcr#1: |err| q99=10.9263  tail_n=6/521  tail_share_SSE=69.67%
2025-12-16 01:21:16,595 | INFO | [pred] pcr#1: per-day mse days=19 p50=0.400818 p90=15.7146 p99=28.3596 max=30.5685
2025-12-16 01:21:16,596 | INFO | [pred] pcr#2: n=521 R2_OS=-0.00632 mse=4.98985 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=-0.0381 std=0.0181 p1=-0.0701 p99=-0.00433
2025-12-16 01:21:16,596 | INFO | [pred] pcr#2: |err| q99=10.9263  tail_n=6/521  tail_share_SSE=69.67%
2025-12-16 01:21:16,598 | INFO | [pred] pcr#2: per-day mse days=19 p50=0.400818 p90=15.7146 p99=28.3596 max=30.5685
2025-12-16 01:21:16,598 | INFO | [pred] pls#1: n=521 R2_OS=0.06306 mse=4.64581 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.5 std=0.698 p1=-0.971 p99=2.16
2025-12-16 01:21:16,598 | INFO | [pred] pls#1: |err| q99=9.93697  tail_n=6/521  tail_share_SSE=64.76%
2025-12-16 01:21:16,600 | INFO | [pred] pls#1: per-day mse days=19 p50=1.37387 p90=13.2008 p99=25.8352 max=28.2242
2025-12-16 01:21:16,601 | INFO | [pred] pls#2: n=521 R2_OS=0.07099 mse=4.60647 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.415 std=0.685 p1=-1.09 p99=1.92
2025-12-16 01:21:16,601 | INFO | [pred] pls#2: |err| q99=9.94973  tail_n=6/521  tail_share_SSE=66.02%
2025-12-16 01:21:16,602 | INFO | [pred] pls#2: per-day mse days=19 p50=1.38144 p90=13.4111 p99=25.7819 max=28.0666
2025-12-16 01:21:16,604 | INFO | [pred] L-En: n=521 R2_OS=0.07089 mse=4.60701 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.229 std=0.291 p1=-0.285 p99=0.833
2025-12-16 01:21:16,604 | INFO | [pred] L-En: |err| q99=10.3962  tail_n=6/521  tail_share_SSE=70.16%
2025-12-16 01:21:16,606 | INFO | [pred] L-En: per-day mse days=19 p50=0.506989 p90=14.0867 p99=26.8823 max=29.1079
2025-12-16 01:21:16,609 | INFO | [pred] ffn#1: n=521 R2_OS=0.04549 mse=4.73295 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.628 std=0.908 p1=-0.446 p99=3.01
2025-12-16 01:21:16,609 | INFO | [pred] ffn#1: |err| q99=8.9717  tail_n=6/521  tail_share_SSE=58.59%
2025-12-16 01:21:16,611 | INFO | [pred] ffn#1: per-day mse days=19 p50=1.87182 p90=11.9784 p99=24.5517 max=26.7502
2025-12-16 01:21:16,614 | INFO | [pred] ffn#2: n=521 R2_OS=0.04663 mse=4.72728 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.625 std=0.907 p1=-0.454 p99=3.01
2025-12-16 01:21:16,614 | INFO | [pred] ffn#2: |err| q99=8.97353  tail_n=6/521  tail_share_SSE=58.66%
2025-12-16 01:21:16,616 | INFO | [pred] ffn#2: per-day mse days=19 p50=1.86264 p90=11.9642 p99=24.5753 max=26.7784
2025-12-16 01:21:16,629 | INFO | [pred] rf#1: n=521 R2_OS=0.08007 mse=4.56149 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.441 std=0.618 p1=-0.108 p99=2.06
2025-12-16 01:21:16,629 | INFO | [pred] rf#1: |err| q99=9.69973  tail_n=6/521  tail_share_SSE=66.26%
2025-12-16 01:21:16,630 | INFO | [pred] rf#1: per-day mse days=19 p50=1.63158 p90=13.335 p99=25.6005 max=27.8222
2025-12-16 01:21:16,643 | INFO | [pred] rf#2: n=521 R2_OS=0.08595 mse=4.5323 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.404 std=0.596 p1=-0.113 p99=2.1
2025-12-16 01:21:16,643 | INFO | [pred] rf#2: |err| q99=9.72047  tail_n=6/521  tail_share_SSE=66.87%
2025-12-16 01:21:16,645 | INFO | [pred] rf#2: per-day mse days=19 p50=1.5772 p90=12.8642 p99=26.172 max=28.523
2025-12-16 01:21:16,646 | INFO | [pred] lgbm_gbdt#1: n=521 R2_OS=0.05866 mse=4.66763 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.486 std=0.684 p1=-0.117 p99=2.23
2025-12-16 01:21:16,646 | INFO | [pred] lgbm_gbdt#1: |err| q99=9.78323  tail_n=6/521  tail_share_SSE=64.98%
2025-12-16 01:21:16,647 | INFO | [pred] lgbm_gbdt#1: per-day mse days=19 p50=1.68489 p90=13.5541 p99=24.0979 max=26.0498
2025-12-16 01:21:16,649 | INFO | [pred] lgbm_gbdt#2: n=521 R2_OS=0.03987 mse=4.76082 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.588 std=0.903 p1=-0.166 p99=3.01
2025-12-16 01:21:16,649 | INFO | [pred] lgbm_gbdt#2: |err| q99=9.28998  tail_n=6/521  tail_share_SSE=59.46%
2025-12-16 01:21:16,650 | INFO | [pred] lgbm_gbdt#2: per-day mse days=19 p50=2.23983 p90=12.4831 p99=23.8894 max=25.914
2025-12-16 01:21:16,652 | INFO | [pred] lgbm_dart#1: n=521 R2_OS=0.05265 mse=4.69744 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.463 std=0.804 p1=-0.317 p99=2.94
2025-12-16 01:21:16,652 | INFO | [pred] lgbm_dart#1: |err| q99=9.70115  tail_n=6/521  tail_share_SSE=62.47%
2025-12-16 01:21:16,654 | INFO | [pred] lgbm_dart#1: per-day mse days=19 p50=1.90116 p90=12.7458 p99=24.5093 max=26.7192
2025-12-16 01:21:16,655 | INFO | [pred] lgbm_dart#2: n=521 R2_OS=0.00886 mse=4.91454 mse0=4.95849 | y mean=0.326 std=2.2 | yhat mean=0.605 std=0.928 p1=-0.249 p99=3.39
2025-12-16 01:21:16,655 | INFO | [pred] lgbm_dart#2: |err| q99=9.66941  tail_n=6/521  tail_share_SSE=58.19%
2025-12-16 01:21:16,657 | INFO | [pred] lgbm_dart#2: per-day mse days=19 p50=2.20786 p90=12.8012 p99=23.0863 max=24.9057
