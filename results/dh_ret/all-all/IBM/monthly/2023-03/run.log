2025-12-16 09:22:34,996 | INFO | === Expanding step: train_to_2023-02__test_2023-03 ===
2025-12-16 09:22:35,004 | INFO | [guardrails] transform=none
2025-12-16 09:22:35,004 | INFO | [guardrails] winsor z: lower_q=0.0050 (-1.66476), upper_q=0.9950 (16.0882)
2025-12-16 09:22:35,514 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-16 09:22:38,662 | INFO | [keep] ridge#1 score=-0.04988 params={'max_iter': np.int64(10000), 'alpha': 92.28295957427436}
2025-12-16 09:22:38,674 | INFO | [keep] ridge#2 score=-0.05460 params={'max_iter': np.int64(10000), 'alpha': 86.26905220714896}
2025-12-16 09:22:44,940 | INFO | [keep] lasso#1 score=0.06180 params={'max_iter': np.int64(10000), 'alpha': 0.014135935551752304}
2025-12-16 09:22:44,955 | INFO | [keep] lasso#2 score=0.06180 params={'max_iter': np.int64(10000), 'alpha': 0.01276954761904551}
2025-12-16 09:22:53,729 | INFO | [keep] elasticnet#1 score=0.06202 params={'max_iter': np.int64(10000), 'alpha': 0.023358825194833552, 'l1_ratio': 0.5547471590949188}
2025-12-16 09:22:53,815 | INFO | [keep] elasticnet#2 score=0.06171 params={'max_iter': np.int64(10000), 'alpha': 0.018662266976517967, 'l1_ratio': 0.6167152904533248}
2025-12-16 09:22:54,673 | INFO | [keep] pcr#1 score=0.00496 params={'pca__n_components': 6, 'ridge__alpha': 0.0001}
2025-12-16 09:22:54,687 | INFO | [keep] pcr#2 score=0.00496 params={'pca__n_components': 6, 'ridge__alpha': 0.001}
2025-12-16 09:22:54,848 | INFO | [keep] pls#1 score=0.03423 params={'n_components': 3}
2025-12-16 09:22:54,862 | INFO | [keep] pls#2 score=0.01739 params={'n_components': 4}
2025-12-16 09:22:54,862 | INFO | Training FFN: ['ffn']
2025-12-16 10:05:39,352 | INFO | [keep] ffn#1 score=0.05620 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(64), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.47878885927286424, 'ffn__weight_decay': 0.004336485563242767}
2025-12-16 10:05:54,411 | INFO | [keep] ffn#2 score=0.05590 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(64), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.4731634167180391, 'ffn__weight_decay': 0.0014653571755444989}
2025-12-16 10:05:54,411 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-16 10:06:47,949 | INFO | [keep] rf#1 score=0.07855 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.6, 'min_samples_leaf': 20, 'n_estimators': 200}
2025-12-16 10:06:48,410 | INFO | [keep] rf#2 score=0.07832 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'log2', 'max_samples': 0.6, 'min_samples_leaf': 20, 'n_estimators': 200}
2025-12-16 10:07:01,911 | INFO | [keep] lgbm_gbdt#1 score=0.08665 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'learning_rate': np.float64(0.1), 'max_bin': np.int64(127), 'max_depth': np.int64(4), 'min_child_samples': np.int64(100), 'n_estimators': np.int64(200), 'num_leaves': np.int64(15), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.26593836708988355, 'reg_lambda': 0.2785392800820963} | n_estimators(refit)=24
2025-12-16 10:07:01,960 | INFO | [keep] lgbm_gbdt#2 score=0.08540 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'learning_rate': np.float64(0.1), 'max_bin': np.int64(63), 'max_depth': np.int64(6), 'min_child_samples': np.int64(200), 'n_estimators': np.int64(200), 'num_leaves': np.int64(15), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 2.557273434307698, 'reg_lambda': 0.15865500409725955} | n_estimators(refit)=22
2025-12-16 10:07:34,606 | INFO | [keep] lgbm_dart#1 score=0.09377 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'drop_rate': np.float64(0.3), 'learning_rate': np.float64(0.1), 'max_bin': np.int64(63), 'max_depth': np.int64(4), 'max_drop': np.int64(20), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.1), 'min_split_gain': np.float64(0.05), 'n_estimators': np.int64(100), 'num_leaves': np.int64(31), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 13.201261326847794, 'reg_lambda': 8.883879772755321}
2025-12-16 10:07:35,302 | INFO | [keep] lgbm_dart#2 score=0.09277 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'drop_rate': np.float64(0.3), 'learning_rate': np.float64(0.05), 'max_bin': np.int64(127), 'max_depth': np.int64(6), 'max_drop': np.int64(20), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.1), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'skip_drop': np.float64(0.3), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.11331543612010862, 'reg_lambda': 5.912295566997817}
2025-12-16 10:07:35,303 | INFO | [pred] ridge#1: n=682 R2_OS=0.08973 mse=11.1155 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.302 std=0.39 p1=-0.605 p99=1.32
2025-12-16 10:07:35,303 | INFO | [pred] ridge#1: |err| q99=16.7543  tail_n=7/682  tail_share_SSE=36.89%
2025-12-16 10:07:35,306 | INFO | [pred] ridge#1: per-day mse days=21 p50=0.963829 p90=46.3673 p99=64.3039 max=67.0887
2025-12-16 10:07:35,306 | INFO | [pred] ridge#2: n=682 R2_OS=0.08991 mse=11.1133 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.302 std=0.391 p1=-0.608 p99=1.33
2025-12-16 10:07:35,306 | INFO | [pred] ridge#2: |err| q99=16.7524  tail_n=7/682  tail_share_SSE=36.90%
2025-12-16 10:07:35,308 | INFO | [pred] ridge#2: per-day mse days=21 p50=0.964255 p90=46.3538 p99=64.3039 max=67.0922
2025-12-16 10:07:35,309 | INFO | [pred] lasso#1: n=682 R2_OS=0.07015 mse=11.3547 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.27 std=0.234 p1=-0.185 p99=0.743
2025-12-16 10:07:35,309 | INFO | [pred] lasso#1: |err| q99=16.8365  tail_n=7/682  tail_share_SSE=37.09%
2025-12-16 10:07:35,311 | INFO | [pred] lasso#1: per-day mse days=21 p50=0.780378 p90=47.0673 p99=65.8527 max=68.3532
2025-12-16 10:07:35,311 | INFO | [pred] lasso#2: n=682 R2_OS=0.07057 mse=11.3495 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.271 std=0.238 p1=-0.194 p99=0.755
2025-12-16 10:07:35,311 | INFO | [pred] lasso#2: |err| q99=16.8394  tail_n=7/682  tail_share_SSE=37.07%
2025-12-16 10:07:35,313 | INFO | [pred] lasso#2: per-day mse days=21 p50=0.783204 p90=47.0223 p99=65.7284 max=68.2123
2025-12-16 10:07:35,314 | INFO | [pred] elasticnet#1: n=682 R2_OS=0.06996 mse=11.357 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.268 std=0.236 p1=-0.189 p99=0.746
2025-12-16 10:07:35,314 | INFO | [pred] elasticnet#1: |err| q99=16.8426  tail_n=7/682  tail_share_SSE=37.06%
2025-12-16 10:07:35,316 | INFO | [pred] elasticnet#1: per-day mse days=21 p50=0.777437 p90=47.0812 p99=65.7947 max=68.2861
2025-12-16 10:07:35,316 | INFO | [pred] elasticnet#2: n=682 R2_OS=0.07073 mse=11.3475 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.27 std=0.241 p1=-0.196 p99=0.76
2025-12-16 10:07:35,317 | INFO | [pred] elasticnet#2: |err| q99=16.8425  tail_n=7/682  tail_share_SSE=37.04%
2025-12-16 10:07:35,319 | INFO | [pred] elasticnet#2: per-day mse days=21 p50=0.783452 p90=47.0456 p99=65.6535 max=68.1402
2025-12-16 10:07:35,319 | INFO | [pred] pcr#1: n=682 R2_OS=0.02958 mse=11.8501 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.0928 std=0.163 p1=-0.253 p99=0.487
2025-12-16 10:07:35,319 | INFO | [pred] pcr#1: |err| q99=16.9919  tail_n=7/682  tail_share_SSE=36.85%
2025-12-16 10:07:35,321 | INFO | [pred] pcr#1: per-day mse days=21 p50=0.750965 p90=50.3727 p99=70.0027 max=72.9945
2025-12-16 10:07:35,322 | INFO | [pred] pcr#2: n=682 R2_OS=0.02958 mse=11.8501 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.0928 std=0.163 p1=-0.253 p99=0.487
2025-12-16 10:07:35,322 | INFO | [pred] pcr#2: |err| q99=16.9919  tail_n=7/682  tail_share_SSE=36.85%
2025-12-16 10:07:35,324 | INFO | [pred] pcr#2: per-day mse days=21 p50=0.750965 p90=50.3727 p99=70.0027 max=72.9945
2025-12-16 10:07:35,325 | INFO | [pred] pls#1: n=682 R2_OS=0.15549 mse=10.3126 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.574 std=0.64 p1=-0.61 p99=1.89
2025-12-16 10:07:35,325 | INFO | [pred] pls#1: |err| q99=15.7193  tail_n=7/682  tail_share_SSE=37.13%
2025-12-16 10:07:35,327 | INFO | [pred] pls#1: per-day mse days=21 p50=1.73596 p90=41.1936 p99=60.0914 max=63.1003
2025-12-16 10:07:35,327 | INFO | [pred] pls#2: n=682 R2_OS=0.16340 mse=10.2159 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.597 std=0.632 p1=-0.649 p99=1.96
2025-12-16 10:07:35,327 | INFO | [pred] pls#2: |err| q99=15.6536  tail_n=7/682  tail_share_SSE=37.49%
2025-12-16 10:07:35,329 | INFO | [pred] pls#2: per-day mse days=21 p50=1.62726 p90=40.3174 p99=59.686 max=62.5839
2025-12-16 10:07:35,331 | INFO | [pred] L-En: n=682 R2_OS=0.09006 mse=11.1115 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.304 std=0.299 p1=-0.257 p99=0.902
2025-12-16 10:07:35,331 | INFO | [pred] L-En: |err| q99=16.6312  tail_n=7/682  tail_share_SSE=37.25%
2025-12-16 10:07:35,333 | INFO | [pred] L-En: per-day mse days=21 p50=0.892292 p90=46.2379 p99=65.0064 max=67.7608
2025-12-16 10:07:35,335 | INFO | [pred] ffn#1: n=682 R2_OS=0.13617 mse=10.5485 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.451 std=0.587 p1=-0.617 p99=1.93
2025-12-16 10:07:35,336 | INFO | [pred] ffn#1: |err| q99=16.0955  tail_n=7/682  tail_share_SSE=36.41%
2025-12-16 10:07:35,338 | INFO | [pred] ffn#1: per-day mse days=21 p50=1.4049 p90=43.4295 p99=58.4685 max=60.9734
2025-12-16 10:07:35,340 | INFO | [pred] ffn#2: n=682 R2_OS=0.13709 mse=10.5372 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.455 std=0.591 p1=-0.614 p99=1.94
2025-12-16 10:07:35,340 | INFO | [pred] ffn#2: |err| q99=16.0876  tail_n=7/682  tail_share_SSE=36.42%
2025-12-16 10:07:35,342 | INFO | [pred] ffn#2: per-day mse days=21 p50=1.42891 p90=43.3448 p99=58.4531 max=60.9663
2025-12-16 10:07:35,366 | INFO | [pred] rf#1: n=682 R2_OS=0.19273 mse=9.85783 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.528 std=0.627 p1=-0.0653 p99=2.48
2025-12-16 10:07:35,366 | INFO | [pred] rf#1: |err| q99=15.3639  tail_n=7/682  tail_share_SSE=38.55%
2025-12-16 10:07:35,368 | INFO | [pred] rf#1: per-day mse days=21 p50=1.14494 p90=38.0076 p99=61.6815 max=65.3273
2025-12-16 10:07:35,392 | INFO | [pred] rf#2: n=682 R2_OS=0.15553 mse=10.3121 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.481 std=0.478 p1=-0.0435 p99=1.83
2025-12-16 10:07:35,392 | INFO | [pred] rf#2: |err| q99=16.0084  tail_n=7/682  tail_share_SSE=37.92%
2025-12-16 10:07:35,394 | INFO | [pred] rf#2: per-day mse days=21 p50=1.01994 p90=40.7282 p99=63.2037 max=66.6742
2025-12-16 10:07:35,395 | INFO | [pred] lgbm_gbdt#1: n=682 R2_OS=0.18088 mse=10.0025 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.467 std=0.628 p1=-0.0967 p99=2.35
2025-12-16 10:07:35,396 | INFO | [pred] lgbm_gbdt#1: |err| q99=15.7212  tail_n=7/682  tail_share_SSE=38.31%
2025-12-16 10:07:35,398 | INFO | [pred] lgbm_gbdt#1: per-day mse days=21 p50=1.30791 p90=39.2578 p99=62.526 max=66.5057
2025-12-16 10:07:35,399 | INFO | [pred] lgbm_gbdt#2: n=682 R2_OS=0.18048 mse=10.0073 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.471 std=0.65 p1=-0.148 p99=2.21
2025-12-16 10:07:35,399 | INFO | [pred] lgbm_gbdt#2: |err| q99=15.423  tail_n=7/682  tail_share_SSE=38.31%
2025-12-16 10:07:35,401 | INFO | [pred] lgbm_gbdt#2: per-day mse days=21 p50=1.57488 p90=39.7253 p99=61.9192 max=65.2764
2025-12-16 10:07:35,402 | INFO | [pred] lgbm_dart#1: n=682 R2_OS=0.13462 mse=10.5674 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.345 std=0.454 p1=-0.0593 p99=1.57
2025-12-16 10:07:35,402 | INFO | [pred] lgbm_dart#1: |err| q99=16.2303  tail_n=7/682  tail_share_SSE=37.69%
2025-12-16 10:07:35,404 | INFO | [pred] lgbm_dart#1: per-day mse days=21 p50=1.09775 p90=43.2057 p99=63.3691 max=66.427
2025-12-16 10:07:35,406 | INFO | [pred] lgbm_dart#2: n=682 R2_OS=0.14867 mse=10.3958 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.345 std=0.47 p1=-0.14 p99=1.93
2025-12-16 10:07:35,407 | INFO | [pred] lgbm_dart#2: |err| q99=16.1204  tail_n=7/682  tail_share_SSE=38.46%
2025-12-16 10:07:35,409 | INFO | [pred] lgbm_dart#2: per-day mse days=21 p50=0.967034 p90=41.6099 p99=63.2336 max=65.8755
