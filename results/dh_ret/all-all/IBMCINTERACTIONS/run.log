2025-12-16 09:22:34,841 | INFO | Loaded data: 21203 rows, 157 cols
2025-12-16 09:22:34,862 | INFO | After contract filters: 21203 rows
2025-12-16 09:22:34,889 | WARNING | Replacing 12 +/-inf values with NaN before splits.
2025-12-16 09:22:34,979 | INFO | [expanding] enabled=True | freq=M | min_train_months=38 | months_total=44
2025-12-16 09:22:34,979 | INFO | [weighting] Sample weights enabled. Column='mid_t', Clip=[10, 5000.0]
2025-12-16 09:22:35,004 | INFO | === Expanding step: train_to_2023-02__test_2023-03 ===
2025-12-16 09:22:35,013 | INFO | [guardrails] transform=none
2025-12-16 09:22:35,013 | INFO | [guardrails] winsor z: lower_q=0.0050 (-1.66476), upper_q=0.9950 (16.0882)
2025-12-16 09:22:35,771 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-16 09:22:39,334 | INFO | [keep] ridge#1 score=-0.05072 params={'max_iter': np.int64(10000), 'alpha': 92.28295957427436}
2025-12-16 09:22:39,349 | INFO | [keep] ridge#2 score=-0.05488 params={'max_iter': np.int64(10000), 'alpha': 86.26905220714896}
2025-12-16 09:22:47,764 | INFO | [keep] lasso#1 score=0.05803 params={'max_iter': np.int64(10000), 'alpha': 0.015470958549309927}
2025-12-16 09:22:47,785 | INFO | [keep] lasso#2 score=0.05789 params={'max_iter': np.int64(10000), 'alpha': 0.017489966737814593}
2025-12-16 09:22:59,760 | INFO | [keep] elasticnet#1 score=0.05842 params={'max_iter': np.int64(10000), 'alpha': 0.049689420927313904, 'l1_ratio': 0.2466238689712629}
2025-12-16 09:22:59,881 | INFO | [keep] elasticnet#2 score=0.05798 params={'max_iter': np.int64(10000), 'alpha': 0.020304615777978822, 'l1_ratio': 0.8135386840125377}
2025-12-16 09:23:00,892 | INFO | [keep] pcr#1 score=-0.00497 params={'pca__n_components': 3, 'ridge__alpha': 0.0001}
2025-12-16 09:23:00,910 | INFO | [keep] pcr#2 score=-0.00497 params={'pca__n_components': 3, 'ridge__alpha': 0.001}
2025-12-16 09:23:01,099 | INFO | [keep] pls#1 score=0.01328 params={'n_components': 3}
2025-12-16 09:23:01,114 | INFO | [keep] pls#2 score=-0.01795 params={'n_components': 2}
2025-12-16 09:23:01,114 | INFO | Training FFN: ['ffn']
2025-12-16 10:07:00,452 | INFO | [keep] ffn#1 score=0.05617 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(64), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.4731634167180391, 'ffn__weight_decay': 0.0014653571755444989}
2025-12-16 10:07:19,338 | INFO | [keep] ffn#2 score=0.05589 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(128), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.494548816945476, 'ffn__weight_decay': 0.009051918062311641}
2025-12-16 10:07:19,339 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-16 10:08:13,372 | INFO | [keep] rf#1 score=0.07588 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'log2', 'max_samples': 0.6, 'min_samples_leaf': 20, 'n_estimators': 100}
2025-12-16 10:08:13,659 | INFO | [keep] rf#2 score=0.07362 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.6, 'min_samples_leaf': 20, 'n_estimators': 100}
2025-12-16 10:08:27,607 | INFO | [keep] lgbm_gbdt#1 score=0.08026 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.1), 'max_bin': np.int64(127), 'max_depth': np.int64(6), 'min_child_samples': np.int64(200), 'n_estimators': np.int64(200), 'num_leaves': np.int64(15), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 1.6316096531713469, 'reg_lambda': 2.549382456709141} | n_estimators(refit)=24
2025-12-16 10:08:27,711 | INFO | [keep] lgbm_gbdt#2 score=0.07929 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(63), 'max_depth': np.int64(6), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 1.2753898599202926, 'reg_lambda': 0.213737596049905} | n_estimators(refit)=74
2025-12-16 10:09:00,361 | INFO | [keep] lgbm_dart#1 score=0.08812 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'drop_rate': np.float64(0.5), 'learning_rate': np.float64(0.1), 'max_bin': np.int64(63), 'max_depth': np.int64(6), 'max_drop': np.int64(20), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.1), 'min_split_gain': np.float64(0.05), 'n_estimators': np.int64(200), 'num_leaves': np.int64(7), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 17.634565870099095, 'reg_lambda': 0.5169180860350462}
2025-12-16 10:09:00,701 | INFO | [keep] lgbm_dart#2 score=0.08340 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'drop_rate': np.float64(0.2), 'learning_rate': np.float64(0.05), 'max_bin': np.int64(63), 'max_depth': np.int64(6), 'max_drop': np.int64(10), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.01), 'min_split_gain': np.float64(0.05), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 1.007908770912927, 'reg_lambda': 0.33582746295594984}
2025-12-16 10:09:00,702 | INFO | [pred] ridge#1: n=682 R2_OS=0.06885 mse=11.3705 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.146 std=0.452 p1=-1.14 p99=1.12
2025-12-16 10:09:00,702 | INFO | [pred] ridge#1: |err| q99=16.8369  tail_n=7/682  tail_share_SSE=36.34%
2025-12-16 10:09:00,704 | INFO | [pred] ridge#1: per-day mse days=21 p50=0.953511 p90=49.2977 p99=65.9606 max=69.3014
2025-12-16 10:09:00,705 | INFO | [pred] ridge#2: n=682 R2_OS=0.06896 mse=11.3691 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.145 std=0.454 p1=-1.15 p99=1.12
2025-12-16 10:09:00,705 | INFO | [pred] ridge#2: |err| q99=16.8354  tail_n=7/682  tail_share_SSE=36.34%
2025-12-16 10:09:00,707 | INFO | [pred] ridge#2: per-day mse days=21 p50=0.953736 p90=49.2816 p99=65.9671 max=69.3125
2025-12-16 10:09:00,707 | INFO | [pred] lasso#1: n=682 R2_OS=0.06477 mse=11.4203 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.229 std=0.233 p1=-0.24 p99=0.699
2025-12-16 10:09:00,708 | INFO | [pred] lasso#1: |err| q99=16.8713  tail_n=7/682  tail_share_SSE=36.96%
2025-12-16 10:09:00,709 | INFO | [pred] lasso#1: per-day mse days=21 p50=0.845393 p90=48.4029 p99=66.4363 max=69.1302
2025-12-16 10:09:00,710 | INFO | [pred] lasso#2: n=682 R2_OS=0.06733 mse=11.389 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.245 std=0.228 p1=-0.224 p99=0.704
2025-12-16 10:09:00,710 | INFO | [pred] lasso#2: |err| q99=16.8596  tail_n=7/682  tail_share_SSE=37.03%
2025-12-16 10:09:00,712 | INFO | [pred] lasso#2: per-day mse days=21 p50=0.859028 p90=47.9881 p99=66.3911 max=69.0804
2025-12-16 10:09:00,713 | INFO | [pred] elasticnet#1: n=682 R2_OS=0.06205 mse=11.4535 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.211 std=0.24 p1=-0.27 p99=0.706
2025-12-16 10:09:00,713 | INFO | [pred] elasticnet#1: |err| q99=16.8857  tail_n=7/682  tail_share_SSE=36.85%
2025-12-16 10:09:00,715 | INFO | [pred] elasticnet#1: per-day mse days=21 p50=0.76768 p90=48.8596 p99=66.4245 max=69.1328
2025-12-16 10:09:00,715 | INFO | [pred] elasticnet#2: n=682 R2_OS=0.06586 mse=11.407 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.237 std=0.229 p1=-0.232 p99=0.697
2025-12-16 10:09:00,715 | INFO | [pred] elasticnet#2: |err| q99=16.869  tail_n=7/682  tail_share_SSE=37.00%
2025-12-16 10:09:00,717 | INFO | [pred] elasticnet#2: per-day mse days=21 p50=0.85192 p90=48.1848 p99=66.4392 max=69.1299
2025-12-16 10:09:00,718 | INFO | [pred] pcr#1: n=682 R2_OS=-0.00480 mse=12.2698 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=-0.027 std=0.0278 p1=-0.0637 p99=0.0387
2025-12-16 10:09:00,718 | INFO | [pred] pcr#1: |err| q99=17.3615  tail_n=7/682  tail_share_SSE=36.30%
2025-12-16 10:09:00,720 | INFO | [pred] pcr#1: per-day mse days=21 p50=0.636387 p90=52.5867 p99=70.4898 max=73.1015
2025-12-16 10:09:00,721 | INFO | [pred] pcr#2: n=682 R2_OS=-0.00480 mse=12.2698 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=-0.027 std=0.0278 p1=-0.0637 p99=0.0387
2025-12-16 10:09:00,721 | INFO | [pred] pcr#2: |err| q99=17.3615  tail_n=7/682  tail_share_SSE=36.30%
2025-12-16 10:09:00,723 | INFO | [pred] pcr#2: per-day mse days=21 p50=0.636387 p90=52.5867 p99=70.4898 max=73.1015
2025-12-16 10:09:00,723 | INFO | [pred] pls#1: n=682 R2_OS=0.16940 mse=10.1427 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.565 std=0.722 p1=-0.753 p99=2.39
2025-12-16 10:09:00,723 | INFO | [pred] pls#1: |err| q99=15.7128  tail_n=7/682  tail_share_SSE=36.96%
2025-12-16 10:09:00,725 | INFO | [pred] pls#1: per-day mse days=21 p50=1.77727 p90=40.8948 p99=59.7692 max=63.1163
2025-12-16 10:09:00,726 | INFO | [pred] pls#2: n=682 R2_OS=0.15921 mse=10.2671 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.51 std=0.714 p1=-0.755 p99=2.29
2025-12-16 10:09:00,726 | INFO | [pred] pls#2: |err| q99=15.7618  tail_n=7/682  tail_share_SSE=36.72%
2025-12-16 10:09:00,728 | INFO | [pred] pls#2: per-day mse days=21 p50=1.67634 p90=41.7782 p99=60.9436 max=64.6263
2025-12-16 10:09:00,729 | INFO | [pred] L-En: n=682 R2_OS=0.08076 mse=11.225 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.223 std=0.298 p1=-0.389 p99=0.927
2025-12-16 10:09:00,730 | INFO | [pred] L-En: |err| q99=16.7355  tail_n=7/682  tail_share_SSE=37.00%
2025-12-16 10:09:00,731 | INFO | [pred] L-En: per-day mse days=21 p50=1.13379 p90=47.8723 p99=65.8025 max=68.8064
2025-12-16 10:09:00,735 | INFO | [pred] ffn#1: n=682 R2_OS=0.17674 mse=10.053 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.507 std=0.772 p1=-0.613 p99=2.78
2025-12-16 10:09:00,735 | INFO | [pred] ffn#1: |err| q99=15.6563  tail_n=7/682  tail_share_SSE=36.33%
2025-12-16 10:09:00,737 | INFO | [pred] ffn#1: per-day mse days=21 p50=1.66695 p90=42.3266 p99=57.3304 max=60.6657
2025-12-16 10:09:00,740 | INFO | [pred] ffn#2: n=682 R2_OS=0.19383 mse=9.84428 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.536 std=0.895 p1=-0.673 p99=3.26
2025-12-16 10:09:00,740 | INFO | [pred] ffn#2: |err| q99=15.5231  tail_n=7/682  tail_share_SSE=35.98%
2025-12-16 10:09:00,742 | INFO | [pred] ffn#2: per-day mse days=21 p50=1.92684 p90=40.5417 p99=55.8058 max=59.3048
2025-12-16 10:09:00,755 | INFO | [pred] rf#1: n=682 R2_OS=0.15565 mse=10.3105 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.472 std=0.512 p1=-0.0495 p99=1.98
2025-12-16 10:09:00,755 | INFO | [pred] rf#1: |err| q99=15.9088  tail_n=7/682  tail_share_SSE=37.44%
2025-12-16 10:09:00,757 | INFO | [pred] rf#1: per-day mse days=21 p50=1.10855 p90=41.3068 p99=62.6039 max=66.2212
2025-12-16 10:09:00,769 | INFO | [pred] rf#2: n=682 R2_OS=0.16002 mse=10.2572 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.403 std=0.522 p1=-0.0867 p99=2.07
2025-12-16 10:09:00,770 | INFO | [pred] rf#2: |err| q99=15.8947  tail_n=7/682  tail_share_SSE=38.26%
2025-12-16 10:09:00,772 | INFO | [pred] rf#2: per-day mse days=21 p50=1.15661 p90=40.6931 p99=64.2044 max=68.0021
2025-12-16 10:09:00,773 | INFO | [pred] lgbm_gbdt#1: n=682 R2_OS=0.17301 mse=10.0986 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.379 std=0.595 p1=-0.183 p99=2.51
2025-12-16 10:09:00,773 | INFO | [pred] lgbm_gbdt#1: |err| q99=15.8993  tail_n=7/682  tail_share_SSE=38.75%
2025-12-16 10:09:00,775 | INFO | [pred] lgbm_gbdt#1: per-day mse days=21 p50=1.11907 p90=38.7284 p99=63.2448 max=66.8213
2025-12-16 10:09:00,777 | INFO | [pred] lgbm_gbdt#2: n=682 R2_OS=0.16878 mse=10.1502 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.399 std=0.605 p1=-0.104 p99=2.2
2025-12-16 10:09:00,777 | INFO | [pred] lgbm_gbdt#2: |err| q99=15.6681  tail_n=7/682  tail_share_SSE=38.03%
2025-12-16 10:09:00,779 | INFO | [pred] lgbm_gbdt#2: per-day mse days=21 p50=1.28807 p90=41.5225 p99=63.6116 max=67.5837
2025-12-16 10:09:00,780 | INFO | [pred] lgbm_dart#1: n=682 R2_OS=0.18258 mse=9.98177 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.438 std=0.609 p1=-0.126 p99=2.37
2025-12-16 10:09:00,780 | INFO | [pred] lgbm_dart#1: |err| q99=15.5683  tail_n=7/682  tail_share_SSE=38.80%
2025-12-16 10:09:00,782 | INFO | [pred] lgbm_dart#1: per-day mse days=21 p50=1.21028 p90=38.9105 p99=64.229 max=68.8132
2025-12-16 10:09:00,784 | INFO | [pred] lgbm_dart#2: n=682 R2_OS=0.19764 mse=9.79786 mse0=12.2112 | y mean=0.888 std=3.38 | yhat mean=0.454 std=0.704 p1=-0.17 p99=2.67
2025-12-16 10:09:00,784 | INFO | [pred] lgbm_dart#2: |err| q99=15.3559  tail_n=7/682  tail_share_SSE=38.87%
2025-12-16 10:09:00,786 | INFO | [pred] lgbm_dart#2: per-day mse days=21 p50=1.3648 p90=38.1778 p99=64.5028 max=69.3042
2025-12-16 10:09:31,169 | INFO | === Expanding step: train_to_2023-03__test_2023-04 ===
2025-12-16 10:09:31,178 | INFO | [guardrails] transform=none
2025-12-16 10:09:31,178 | INFO | [guardrails] winsor z: lower_q=0.0050 (-1.67141), upper_q=0.9950 (16.0871)
2025-12-16 10:09:31,968 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-16 10:09:35,615 | INFO | [keep] ridge#1 score=-0.02978 params={'max_iter': np.int64(10000), 'alpha': 92.28295957427436}
2025-12-16 10:09:35,631 | INFO | [keep] ridge#2 score=-0.03339 params={'max_iter': np.int64(10000), 'alpha': 86.26905220714896}
2025-12-16 10:09:44,610 | INFO | [keep] lasso#1 score=0.05548 params={'max_iter': np.int64(10000), 'alpha': 0.017538232373118037}
2025-12-16 10:09:44,632 | INFO | [keep] lasso#2 score=0.05548 params={'max_iter': np.int64(10000), 'alpha': 0.017489966737814593}
2025-12-16 10:09:57,817 | INFO | [keep] elasticnet#1 score=0.05535 params={'max_iter': np.int64(10000), 'alpha': 0.020304615777978822, 'l1_ratio': 0.8135386840125377}
2025-12-16 10:09:57,957 | INFO | [keep] elasticnet#2 score=0.05533 params={'max_iter': np.int64(10000), 'alpha': 0.020547625125911337, 'l1_ratio': 0.8134184006256638}
2025-12-16 10:09:59,073 | INFO | [keep] pcr#1 score=-0.00883 params={'pca__n_components': 2, 'ridge__alpha': 0.0001}
2025-12-16 10:09:59,092 | INFO | [keep] pcr#2 score=-0.00883 params={'pca__n_components': 2, 'ridge__alpha': 0.001}
2025-12-16 10:09:59,290 | INFO | [keep] pls#1 score=0.00176 params={'n_components': 3}
2025-12-16 10:09:59,306 | INFO | [keep] pls#2 score=-0.01373 params={'n_components': 2}
2025-12-16 10:09:59,308 | INFO | Training FFN: ['ffn']
