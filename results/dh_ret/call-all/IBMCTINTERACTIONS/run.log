2025-12-12 20:57:46,372 | INFO | Loaded data: 13142 rows, 162 cols
2025-12-12 20:57:46,395 | INFO | After contract filters: 6863 rows
2025-12-12 20:57:46,399 | WARNING | Replacing 15 +/-inf values with NaN before splits.
2025-12-12 20:57:46,423 | INFO | [expanding] enabled=True | freq=M | min_train_months=38 | months_total=44
2025-12-12 20:57:46,429 | INFO | === Expanding step: train_to_2023-02__test_2023-03 ===
2025-12-12 20:57:46,429 | INFO | Step out_dir: results/dh_ret/call-all/IBMCTINTERACTIONS/monthly/2023-03
2025-12-12 20:57:46,429 | INFO | train_end=2023-02 | test_month=2023-03
2025-12-12 20:57:46,429 | INFO | Split sizes: train=2455 | val=329 | test=585
2025-12-12 20:57:46,432 | INFO | [guardrails] transform=none
2025-12-12 20:57:46,432 | INFO | [guardrails] winsor z: lower_q=0.0100 (-1.592), upper_q=0.9900 (5.49589)
2025-12-12 20:57:46,653 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-12 20:57:47,771 | INFO | [keep] ridge#1 score=-0.53409 params={'max_iter': np.int64(10000), 'alpha': 1.230509689148608}
2025-12-12 20:57:47,775 | INFO | [keep] ridge#2 score=-0.54334 params={'max_iter': np.int64(10000), 'alpha': 0.8411253214777604}
2025-12-12 20:58:04,236 | INFO | [keep] lasso#1 score=0.00090 params={'max_iter': np.int64(10000), 'alpha': 0.6053082080079019}
2025-12-12 20:58:04,240 | INFO | [keep] lasso#2 score=0.00090 params={'max_iter': np.int64(10000), 'alpha': 0.35775015430826956}
2025-12-12 20:58:23,054 | INFO | [keep] elasticnet#1 score=0.00571 params={'max_iter': np.int64(10000), 'alpha': 0.8516144627787162, 'l1_ratio': 0.10204481074802807}
2025-12-12 20:58:23,058 | INFO | [keep] elasticnet#2 score=0.00090 params={'max_iter': np.int64(10000), 'alpha': 0.6053082080079019, 'l1_ratio': 0.3834415188257777}
2025-12-12 20:58:23,504 | INFO | [keep] pcr#1 score=-0.02109 params={'pca__n_components': 1, 'ridge__alpha': 1.0}
2025-12-12 20:58:23,510 | INFO | [keep] pcr#2 score=-0.02109 params={'pca__n_components': 1, 'ridge__alpha': 0.1}
2025-12-12 20:58:23,568 | INFO | [keep] pls#1 score=-0.20574 params={'n_components': 2}
2025-12-12 20:58:23,571 | INFO | [keep] pls#2 score=-0.31312 params={'n_components': 1}
2025-12-12 20:58:23,571 | INFO | Training FFN: ['ffn']
2025-12-12 21:01:21,717 | INFO | [keep] ffn#1 score=0.01037 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(512), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(0.5), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(20), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(0.5), 'ffn__dropout': 0.2428094914467595, 'ffn__weight_decay': 0.0001340004881783983}
2025-12-12 21:01:22,047 | INFO | [keep] ffn#2 score=0.00951 params={'ffn__activation': np.str_('gelu'), 'ffn__batch_size': np.int64(1024), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(32), 'ffn__huber_delta': np.float64(2.0), 'ffn__learning_rate': np.float64(0.0003), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(1.0), 'ffn__dropout': 0.010608730726647276, 'ffn__weight_decay': 1.9552726186680726e-05}
2025-12-12 21:01:22,047 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-12 21:05:13,138 | INFO | [keep] rf#1 score=0.01443 params={'bootstrap': True, 'max_depth': 12, 'max_features': 'log2', 'max_samples': 0.9, 'min_samples_leaf': 50, 'min_samples_split': 2, 'n_estimators': 1000}
2025-12-12 21:05:13,681 | INFO | [keep] rf#2 score=0.01430 params={'bootstrap': True, 'max_depth': 12, 'max_features': 'sqrt', 'max_samples': 0.5, 'min_samples_leaf': 20, 'min_samples_split': 2, 'n_estimators': 600}
2025-12-12 21:05:21,731 | INFO | [keep] lgbm_gbdt#1 score=0.01618 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(3000), 'num_leaves': np.int64(127), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 0.3967995692179589, 'reg_lambda': 3.456966164947344e-06} | n_estimators(refit)=21
2025-12-12 21:05:21,825 | INFO | [keep] lgbm_gbdt#2 score=0.01346 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.01), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(2000), 'num_leaves': np.int64(127), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 3.144350681997742, 'reg_lambda': 0.01394969264149467} | n_estimators(refit)=66
2025-12-12 21:10:46,894 | INFO | [keep] lgbm_dart#1 score=0.00922 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.05), 'learning_rate': np.float64(0.005), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'max_drop': np.int64(10), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.001), 'min_split_gain': np.float64(0.0), 'n_estimators': np.int64(800), 'num_leaves': np.int64(127), 'skip_drop': np.float64(0.1), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.0076298396411680946, 'reg_lambda': 0.6138061299749898}
2025-12-12 21:10:48,549 | INFO | [keep] lgbm_dart#2 score=0.00819 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'drop_rate': np.float64(0.1), 'learning_rate': np.float64(0.01), 'max_bin': np.int64(63), 'max_depth': np.int64(-1), 'max_drop': np.int64(50), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.001), 'min_split_gain': np.float64(0.05), 'n_estimators': np.int64(800), 'num_leaves': np.int64(127), 'skip_drop': np.float64(0.1), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 0.006732778263253583, 'reg_lambda': 8.390058501916997e-05}
2025-12-12 21:11:09,638 | INFO | === Expanding step: train_to_2023-03__test_2023-04 ===
2025-12-12 21:11:09,638 | INFO | Step out_dir: results/dh_ret/call-all/IBMCTINTERACTIONS/monthly/2023-04
2025-12-12 21:11:09,638 | INFO | train_end=2023-03 | test_month=2023-04
2025-12-12 21:11:09,638 | INFO | Split sizes: train=2531 | val=306 | test=542
2025-12-12 21:11:09,642 | INFO | [guardrails] transform=none
2025-12-12 21:11:09,643 | INFO | [guardrails] winsor z: lower_q=0.0100 (-1.58805), upper_q=0.9900 (5.50331)
2025-12-12 21:11:09,873 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-12 21:11:11,161 | INFO | [keep] ridge#1 score=-0.62351 params={'max_iter': np.int64(10000), 'alpha': 0.07645719685939689}
2025-12-12 21:11:11,165 | INFO | [keep] ridge#2 score=-0.62355 params={'max_iter': np.int64(10000), 'alpha': 0.07876892658750602}
2025-12-12 21:11:30,296 | INFO | [keep] lasso#1 score=0.00386 params={'max_iter': np.int64(10000), 'alpha': 0.6053082080079019}
2025-12-12 21:11:30,300 | INFO | [keep] lasso#2 score=0.00386 params={'max_iter': np.int64(10000), 'alpha': 0.35775015430826956}
2025-12-12 21:11:51,875 | INFO | [keep] elasticnet#1 score=0.00875 params={'max_iter': np.int64(10000), 'alpha': 0.8516144627787162, 'l1_ratio': 0.10204481074802807}
2025-12-12 21:11:51,879 | INFO | [keep] elasticnet#2 score=0.00386 params={'max_iter': np.int64(10000), 'alpha': 0.7442349368719798, 'l1_ratio': 0.7991585642167236}
2025-12-12 21:11:52,281 | INFO | [keep] pcr#1 score=-0.00474 params={'pca__n_components': 1, 'ridge__alpha': 1.0}
2025-12-12 21:11:52,287 | INFO | [keep] pcr#2 score=-0.00475 params={'pca__n_components': 1, 'ridge__alpha': 0.1}
2025-12-12 21:11:52,347 | INFO | [keep] pls#1 score=-0.21998 params={'n_components': 2}
2025-12-12 21:11:52,351 | INFO | [keep] pls#2 score=-0.34735 params={'n_components': 1}
2025-12-12 21:11:52,351 | INFO | Training FFN: ['ffn']
2025-12-12 21:14:20,992 | INFO | [keep] ffn#1 score=0.01585 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(512), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(128), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0003), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(5), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(0.5), 'ffn__dropout': 0.2776789914877983, 'ffn__weight_decay': 1.6334587611069488e-06}
2025-12-12 21:14:21,789 | INFO | [keep] ffn#2 score=0.01562 params={'ffn__activation': np.str_('gelu'), 'ffn__batch_size': np.int64(1024), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(20), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(0.5), 'ffn__dropout': 0.1374777035499947, 'ffn__weight_decay': 5.079120681160787e-06}
2025-12-12 21:14:21,789 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-12 21:18:14,098 | INFO | [keep] rf#1 score=0.01783 params={'bootstrap': True, 'max_depth': 12, 'max_features': 'log2', 'max_samples': 0.9, 'min_samples_leaf': 50, 'min_samples_split': 5, 'n_estimators': 600}
2025-12-12 21:18:14,886 | INFO | [keep] rf#2 score=0.01757 params={'bootstrap': True, 'max_depth': 12, 'max_features': 'log2', 'max_samples': 0.9, 'min_samples_leaf': 50, 'min_samples_split': 2, 'n_estimators': 1000}
2025-12-12 21:18:23,922 | INFO | [keep] lgbm_gbdt#1 score=0.02391 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.003), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(2000), 'num_leaves': np.int64(63), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 1.0830805002539181e-05, 'reg_lambda': 0.06230760683094162} | n_estimators(refit)=119
2025-12-12 21:18:24,017 | INFO | [keep] lgbm_gbdt#2 score=0.02219 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.005), 'max_bin': np.int64(127), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(3000), 'num_leaves': np.int64(63), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 1.4098254038960654, 'reg_lambda': 5.248600420017575e-06} | n_estimators(refit)=99
2025-12-12 21:23:30,777 | INFO | [keep] lgbm_dart#1 score=0.01256 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.05), 'learning_rate': np.float64(0.003), 'max_bin': np.int64(127), 'max_depth': np.int64(-1), 'max_drop': np.int64(50), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.1), 'min_split_gain': np.float64(0.0), 'n_estimators': np.int64(1200), 'num_leaves': np.int64(63), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 3.093731730342483, 'reg_lambda': 1.5946590546637215e-06}
2025-12-12 21:23:32,107 | INFO | [keep] lgbm_dart#2 score=0.01139 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.05), 'learning_rate': np.float64(0.005), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'max_drop': np.int64(10), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.001), 'min_split_gain': np.float64(0.0), 'n_estimators': np.int64(800), 'num_leaves': np.int64(127), 'skip_drop': np.float64(0.1), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.0076298396411680946, 'reg_lambda': 0.6138061299749898}
2025-12-12 21:23:50,507 | INFO | === Expanding step: train_to_2023-04__test_2023-05 ===
2025-12-12 21:23:50,507 | INFO | Step out_dir: results/dh_ret/call-all/IBMCTINTERACTIONS/monthly/2023-05
2025-12-12 21:23:50,507 | INFO | train_end=2023-04 | test_month=2023-05
2025-12-12 21:23:50,507 | INFO | Split sizes: train=2571 | val=313 | test=630
2025-12-12 21:23:50,510 | INFO | [guardrails] transform=none
2025-12-12 21:23:50,511 | INFO | [guardrails] winsor z: lower_q=0.0100 (-1.58798), upper_q=0.9900 (5.56465)
2025-12-12 21:23:50,727 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-12 21:23:52,004 | INFO | [keep] ridge#1 score=-0.60721 params={'max_iter': np.int64(10000), 'alpha': 0.07645719685939689}
2025-12-12 21:23:52,008 | INFO | [keep] ridge#2 score=-0.60725 params={'max_iter': np.int64(10000), 'alpha': 0.07876892658750602}
2025-12-12 21:24:12,752 | INFO | [keep] lasso#1 score=0.00520 params={'max_iter': np.int64(10000), 'alpha': 0.6053082080079019}
2025-12-12 21:24:12,756 | INFO | [keep] lasso#2 score=0.00520 params={'max_iter': np.int64(10000), 'alpha': 0.35775015430826956}
2025-12-12 21:24:36,871 | INFO | [keep] elasticnet#1 score=0.00984 params={'max_iter': np.int64(10000), 'alpha': 0.8516144627787162, 'l1_ratio': 0.10204481074802807}
2025-12-12 21:24:36,876 | INFO | [keep] elasticnet#2 score=0.00520 params={'max_iter': np.int64(10000), 'alpha': 0.6053082080079019, 'l1_ratio': 0.3834415188257777}
2025-12-12 21:24:37,299 | INFO | [keep] pcr#1 score=-0.00066 params={'pca__n_components': 1, 'ridge__alpha': 1.0}
2025-12-12 21:24:37,305 | INFO | [keep] pcr#2 score=-0.00067 params={'pca__n_components': 1, 'ridge__alpha': 0.1}
2025-12-12 21:24:37,368 | INFO | [keep] pls#1 score=-0.20660 params={'n_components': 2}
2025-12-12 21:24:37,372 | INFO | [keep] pls#2 score=-0.30579 params={'n_components': 1}
2025-12-12 21:24:37,372 | INFO | Training FFN: ['ffn']
2025-12-12 21:27:50,049 | INFO | [keep] ffn#1 score=0.01161 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(512), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(0.5), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(20), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(0.5), 'ffn__dropout': 0.2428094914467595, 'ffn__weight_decay': 0.0001340004881783983}
2025-12-12 21:27:51,180 | INFO | [keep] ffn#2 score=0.01051 params={'ffn__activation': np.str_('gelu'), 'ffn__batch_size': np.int64(1024), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(32), 'ffn__huber_delta': np.float64(2.0), 'ffn__learning_rate': np.float64(0.0003), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(1.0), 'ffn__dropout': 0.010608730726647276, 'ffn__weight_decay': 1.9552726186680726e-05}
2025-12-12 21:27:51,181 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-12 21:32:22,867 | INFO | [keep] rf#1 score=0.02114 params={'bootstrap': True, 'max_depth': 12, 'max_features': 'log2', 'max_samples': 0.5, 'min_samples_leaf': 20, 'min_samples_split': 10, 'n_estimators': 600}
2025-12-12 21:32:23,847 | INFO | [keep] rf#2 score=0.02071 params={'bootstrap': True, 'max_depth': 12, 'max_features': 'sqrt', 'max_samples': 0.7, 'min_samples_leaf': 20, 'min_samples_split': 5, 'n_estimators': 1000}
2025-12-12 21:32:32,723 | INFO | [keep] lgbm_gbdt#1 score=0.02896 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.01), 'max_bin': np.int64(127), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(800), 'num_leaves': np.int64(127), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 0.042444613236089244, 'reg_lambda': 0.0012073863726279688} | n_estimators(refit)=73
2025-12-12 21:32:32,947 | INFO | [keep] lgbm_gbdt#2 score=0.02386 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.003), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(2000), 'num_leaves': np.int64(63), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 1.0830805002539181e-05, 'reg_lambda': 0.06230760683094162} | n_estimators(refit)=173
2025-12-12 21:36:55,178 | INFO | [keep] lgbm_dart#1 score=0.01719 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.2), 'learning_rate': np.float64(0.005), 'max_bin': np.int64(127), 'max_depth': np.int64(-1), 'max_drop': np.int64(10), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.01), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(800), 'num_leaves': np.int64(127), 'skip_drop': np.float64(0.1), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 4.28761970568318e-05, 'reg_lambda': 3.7119492609215278e-06}
2025-12-12 21:36:57,136 | INFO | [keep] lgbm_dart#2 score=0.01546 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.05), 'learning_rate': np.float64(0.003), 'max_bin': np.int64(127), 'max_depth': np.int64(-1), 'max_drop': np.int64(50), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.1), 'min_split_gain': np.float64(0.0), 'n_estimators': np.int64(1200), 'num_leaves': np.int64(63), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 3.093731730342483, 'reg_lambda': 1.5946590546637215e-06}
2025-12-12 21:37:14,635 | INFO | === Expanding step: train_to_2023-05__test_2023-06 ===
2025-12-12 21:37:14,635 | INFO | Step out_dir: results/dh_ret/call-all/IBMCTINTERACTIONS/monthly/2023-06
2025-12-12 21:37:14,635 | INFO | train_end=2023-05 | test_month=2023-06
2025-12-12 21:37:14,635 | INFO | Split sizes: train=2609 | val=344 | test=579
2025-12-12 21:37:14,638 | INFO | [guardrails] transform=none
2025-12-12 21:37:14,639 | INFO | [guardrails] winsor z: lower_q=0.0100 (-1.58647), upper_q=0.9900 (5.67226)
2025-12-12 21:37:14,871 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-12 21:37:16,258 | INFO | [keep] ridge#1 score=-0.58094 params={'max_iter': np.int64(10000), 'alpha': 0.2628063327422689}
2025-12-12 21:37:16,262 | INFO | [keep] ridge#2 score=-0.58194 params={'max_iter': np.int64(10000), 'alpha': 0.2799608198487091}
2025-12-12 21:37:36,598 | INFO | [keep] lasso#1 score=0.00615 params={'max_iter': np.int64(10000), 'alpha': 0.6053082080079019}
2025-12-12 21:37:36,602 | INFO | [keep] lasso#2 score=0.00615 params={'max_iter': np.int64(10000), 'alpha': 0.35775015430826956}
2025-12-12 21:37:59,156 | INFO | [keep] elasticnet#1 score=0.01260 params={'max_iter': np.int64(10000), 'alpha': 0.8516144627787162, 'l1_ratio': 0.10204481074802807}
2025-12-12 21:37:59,160 | INFO | [keep] elasticnet#2 score=0.00615 params={'max_iter': np.int64(10000), 'alpha': 0.6053082080079019, 'l1_ratio': 0.3834415188257777}
2025-12-12 21:37:59,584 | INFO | [keep] pcr#1 score=-0.00413 params={'pca__n_components': 1, 'ridge__alpha': 1.0}
2025-12-12 21:37:59,590 | INFO | [keep] pcr#2 score=-0.00413 params={'pca__n_components': 1, 'ridge__alpha': 0.1}
2025-12-12 21:37:59,652 | INFO | [keep] pls#1 score=-0.16077 params={'n_components': 2}
2025-12-12 21:37:59,656 | INFO | [keep] pls#2 score=-0.26114 params={'n_components': 1}
2025-12-12 21:37:59,656 | INFO | Training FFN: ['ffn']
2025-12-12 21:40:55,239 | INFO | [keep] ffn#1 score=0.01738 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(512), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(0.5), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(20), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(0.5), 'ffn__dropout': 0.2428094914467595, 'ffn__weight_decay': 0.0001340004881783983}
2025-12-12 21:40:56,451 | INFO | [keep] ffn#2 score=0.01710 params={'ffn__activation': np.str_('gelu'), 'ffn__batch_size': np.int64(1024), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(0.5), 'ffn__learning_rate': np.float64(0.0003), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(0.5), 'ffn__dropout': 0.22894950226268457, 'ffn__weight_decay': 8.599203080926289e-06}
2025-12-12 21:40:56,451 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-12 21:45:23,809 | INFO | [keep] rf#1 score=0.02551 params={'bootstrap': True, 'max_depth': 12, 'max_features': 'log2', 'max_samples': 0.5, 'min_samples_leaf': 20, 'min_samples_split': 10, 'n_estimators': 600}
2025-12-12 21:45:24,320 | INFO | [keep] rf#2 score=0.02482 params={'bootstrap': True, 'max_depth': 12, 'max_features': 'sqrt', 'max_samples': 0.5, 'min_samples_leaf': 20, 'min_samples_split': 2, 'n_estimators': 600}
2025-12-12 21:45:34,588 | INFO | [keep] lgbm_gbdt#1 score=0.03273 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.01), 'max_bin': np.int64(127), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(800), 'num_leaves': np.int64(127), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 0.042444613236089244, 'reg_lambda': 0.0012073863726279688} | n_estimators(refit)=75
2025-12-12 21:45:34,897 | INFO | [keep] lgbm_gbdt#2 score=0.03105 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(1.0), 'learning_rate': np.float64(0.003), 'max_bin': np.int64(127), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(3000), 'num_leaves': np.int64(127), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 0.020030597244341114, 'reg_lambda': 3.0923976246969617e-06} | n_estimators(refit)=248
2025-12-12 21:51:07,969 | INFO | [keep] lgbm_dart#1 score=0.02140 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.1), 'learning_rate': np.float64(0.003), 'max_bin': np.int64(127), 'max_depth': np.int64(3), 'max_drop': np.int64(10), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.1), 'min_split_gain': np.float64(0.0), 'n_estimators': np.int64(800), 'num_leaves': np.int64(31), 'skip_drop': np.float64(0.5), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 0.3483976898071592, 'reg_lambda': 0.005038072794440212}
2025-12-12 21:51:08,750 | INFO | [keep] lgbm_dart#2 score=0.02083 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.15), 'learning_rate': np.float64(0.003), 'max_bin': np.int64(127), 'max_depth': np.int64(3), 'max_drop': np.int64(50), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.001), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(1200), 'num_leaves': np.int64(127), 'skip_drop': np.float64(0.5), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 5.610854171574414e-06, 'reg_lambda': 0.013423416359865182}
2025-12-12 21:51:24,433 | INFO | === Expanding step: train_to_2023-06__test_2023-07 ===
2025-12-12 21:51:24,434 | INFO | Step out_dir: results/dh_ret/call-all/IBMCTINTERACTIONS/monthly/2023-07
2025-12-12 21:51:24,434 | INFO | train_end=2023-06 | test_month=2023-07
2025-12-12 21:51:24,434 | INFO | Split sizes: train=2664 | val=448 | test=402
2025-12-12 21:51:24,437 | INFO | [guardrails] transform=none
2025-12-12 21:51:24,437 | INFO | [guardrails] winsor z: lower_q=0.0100 (-1.57646), upper_q=0.9900 (5.5768)
2025-12-12 21:51:24,667 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-12 21:51:25,807 | INFO | [keep] ridge#1 score=-0.35180 params={'max_iter': np.int64(10000), 'alpha': 4.0990424822804545}
2025-12-12 21:51:25,811 | INFO | [keep] ridge#2 score=-0.35187 params={'max_iter': np.int64(10000), 'alpha': 4.038653086453454}
2025-12-12 21:51:45,348 | INFO | [keep] lasso#1 score=0.00432 params={'max_iter': np.int64(10000), 'alpha': 0.6053082080079019}
2025-12-12 21:51:45,352 | INFO | [keep] lasso#2 score=0.00432 params={'max_iter': np.int64(10000), 'alpha': 0.35775015430826956}
2025-12-12 21:52:07,834 | INFO | [keep] elasticnet#1 score=0.01197 params={'max_iter': np.int64(10000), 'alpha': 0.8516144627787162, 'l1_ratio': 0.10204481074802807}
2025-12-12 21:52:07,838 | INFO | [keep] elasticnet#2 score=0.00432 params={'max_iter': np.int64(10000), 'alpha': 0.6053082080079019, 'l1_ratio': 0.3834415188257777}
2025-12-12 21:52:08,332 | INFO | [keep] pcr#1 score=-0.01056 params={'pca__n_components': 1, 'ridge__alpha': 1.0}
2025-12-12 21:52:08,338 | INFO | [keep] pcr#2 score=-0.01056 params={'pca__n_components': 1, 'ridge__alpha': 0.1}
2025-12-12 21:52:08,402 | INFO | [keep] pls#1 score=-0.04567 params={'n_components': 2}
2025-12-12 21:52:08,406 | INFO | [keep] pls#2 score=-0.10267 params={'n_components': 1}
2025-12-12 21:52:08,406 | INFO | Training FFN: ['ffn']
2025-12-12 21:54:31,484 | INFO | [keep] ffn#1 score=0.02298 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(1024), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(0.5), 'ffn__learning_rate': np.float64(0.0005), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(5), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(0.5), 'ffn__dropout': 0.16406547050082665, 'ffn__weight_decay': 6.6752987880661055e-06}
2025-12-12 21:54:32,182 | INFO | [keep] ffn#2 score=0.02276 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(512), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(2.0), 'ffn__learning_rate': np.float64(0.001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(20), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(0.5), 'ffn__dropout': 0.12468247828057727, 'ffn__weight_decay': 0.0006454332349976913}
2025-12-12 21:54:32,183 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-12 21:58:28,826 | INFO | [keep] rf#1 score=0.02746 params={'bootstrap': True, 'max_depth': 12, 'max_features': 'sqrt', 'max_samples': 0.5, 'min_samples_leaf': 20, 'min_samples_split': 2, 'n_estimators': 600}
2025-12-12 21:58:30,168 | INFO | [keep] rf#2 score=0.02683 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.5, 'min_samples_leaf': 20, 'min_samples_split': 10, 'n_estimators': 1500}
2025-12-12 21:58:45,259 | INFO | [keep] lgbm_gbdt#1 score=0.03111 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.003), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(2000), 'num_leaves': np.int64(63), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 1.0830805002539181e-05, 'reg_lambda': 0.06230760683094162} | n_estimators(refit)=190
2025-12-12 21:58:45,353 | INFO | [keep] lgbm_gbdt#2 score=0.02969 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(1.0), 'learning_rate': np.float64(0.01), 'max_bin': np.int64(127), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(3000), 'num_leaves': np.int64(31), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 3.225178379652067e-05, 'reg_lambda': 4.281482107464621} | n_estimators(refit)=83
2025-12-12 22:04:22,473 | INFO | [keep] lgbm_dart#1 score=0.02146 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(0.8), 'drop_rate': np.float64(0.2), 'learning_rate': np.float64(0.003), 'max_bin': np.int64(63), 'max_depth': np.int64(4), 'max_drop': np.int64(50), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.01), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(800), 'num_leaves': np.int64(127), 'skip_drop': np.float64(0.5), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 5.963451201423944e-05, 'reg_lambda': 0.001327237331282108}
2025-12-12 22:04:23,344 | INFO | [keep] lgbm_dart#2 score=0.02130 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'drop_rate': np.float64(0.1), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(63), 'max_depth': np.int64(4), 'max_drop': np.int64(50), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.001), 'min_split_gain': np.float64(0.05), 'n_estimators': np.int64(800), 'num_leaves': np.int64(127), 'skip_drop': np.float64(0.1), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 7.021590988467245e-06, 'reg_lambda': 0.058194329761482866}
2025-12-12 22:04:39,233 | INFO | === Expanding step: train_to_2023-07__test_2023-08 ===
2025-12-12 22:04:39,233 | INFO | Step out_dir: results/dh_ret/call-all/IBMCTINTERACTIONS/monthly/2023-08
2025-12-12 22:04:39,233 | INFO | train_end=2023-07 | test_month=2023-08
2025-12-12 22:04:39,234 | INFO | Split sizes: train=2733 | val=623 | test=487
2025-12-12 22:04:39,238 | INFO | [guardrails] transform=none
2025-12-12 22:04:39,238 | INFO | [guardrails] winsor z: lower_q=0.0100 (-1.5663), upper_q=0.9900 (5.63061)
2025-12-12 22:04:39,499 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-12 22:04:40,832 | INFO | [keep] ridge#1 score=-0.29145 params={'max_iter': np.int64(10000), 'alpha': 8.291189979207587}
2025-12-12 22:04:40,837 | INFO | [keep] ridge#2 score=-0.29482 params={'max_iter': np.int64(10000), 'alpha': 7.08481306320402}
2025-12-12 22:04:57,061 | INFO | [keep] lasso#1 score=0.00548 params={'max_iter': np.int64(10000), 'alpha': 0.6053082080079019}
2025-12-12 22:04:57,066 | INFO | [keep] lasso#2 score=0.00548 params={'max_iter': np.int64(10000), 'alpha': 0.35775015430826956}
2025-12-12 22:05:17,086 | INFO | [keep] elasticnet#1 score=0.00901 params={'max_iter': np.int64(10000), 'alpha': 0.8516144627787162, 'l1_ratio': 0.10204481074802807}
2025-12-12 22:05:17,090 | INFO | [keep] elasticnet#2 score=0.00548 params={'max_iter': np.int64(10000), 'alpha': 0.7442349368719798, 'l1_ratio': 0.7991585642167236}
2025-12-12 22:05:17,471 | INFO | [keep] pcr#1 score=-0.02476 params={'pca__n_components': 1, 'ridge__alpha': 1.0}
2025-12-12 22:05:17,477 | INFO | [keep] pcr#2 score=-0.02476 params={'pca__n_components': 1, 'ridge__alpha': 0.1}
2025-12-12 22:05:17,541 | INFO | [keep] pls#1 score=-0.05460 params={'n_components': 2}
2025-12-12 22:05:17,545 | INFO | [keep] pls#2 score=-0.07732 params={'n_components': 1}
2025-12-12 22:05:17,546 | INFO | Training FFN: ['ffn']
2025-12-12 22:08:30,454 | INFO | [keep] ffn#1 score=0.02003 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(512), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(0.5), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(20), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(0.5), 'ffn__dropout': 0.2428094914467595, 'ffn__weight_decay': 0.0001340004881783983}
2025-12-12 22:08:31,160 | INFO | [keep] ffn#2 score=0.01876 params={'ffn__activation': np.str_('gelu'), 'ffn__batch_size': np.int64(1024), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(0.5), 'ffn__learning_rate': np.float64(0.0003), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(3), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__width_shrink': np.float64(0.5), 'ffn__dropout': 0.22894950226268457, 'ffn__weight_decay': 8.599203080926289e-06}
2025-12-12 22:08:31,161 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-12 22:12:20,183 | INFO | [keep] rf#1 score=0.02372 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.7, 'min_samples_leaf': 50, 'min_samples_split': 2, 'n_estimators': 1000}
2025-12-12 22:12:21,021 | INFO | [keep] rf#2 score=0.02372 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.7, 'min_samples_leaf': 50, 'min_samples_split': 5, 'n_estimators': 1000}
2025-12-12 22:12:35,325 | INFO | [keep] lgbm_gbdt#1 score=0.02885 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.003), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(2000), 'num_leaves': np.int64(63), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 1.0830805002539181e-05, 'reg_lambda': 0.06230760683094162} | n_estimators(refit)=186
2025-12-12 22:12:35,354 | INFO | [keep] lgbm_gbdt#2 score=0.02871 params={'bagging_freq': np.int64(10), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(255), 'max_depth': np.int64(4), 'min_child_samples': np.int64(100), 'n_estimators': np.int64(3000), 'num_leaves': np.int64(63), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 0.0006756243999378094, 'reg_lambda': 0.0046696789478462555} | n_estimators(refit)=51
2025-12-12 22:18:12,031 | INFO | [keep] lgbm_dart#1 score=0.02074 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'drop_rate': np.float64(0.15), 'learning_rate': np.float64(0.003), 'max_bin': np.int64(255), 'max_depth': np.int64(4), 'max_drop': np.int64(10), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.01), 'min_split_gain': np.float64(0.05), 'n_estimators': np.int64(800), 'num_leaves': np.int64(63), 'skip_drop': np.float64(0.5), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 0.003008868725622777, 'reg_lambda': 1.6046116904152766e-05}
2025-12-12 22:18:13,273 | INFO | [keep] lgbm_dart#2 score=0.01994 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(1.0), 'drop_rate': np.float64(0.2), 'learning_rate': np.float64(0.005), 'max_bin': np.int64(255), 'max_depth': np.int64(-1), 'max_drop': np.int64(10), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.01), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(800), 'num_leaves': np.int64(127), 'skip_drop': np.float64(0.5), 'subsample': np.float64(1.0), 'verbosity': np.int64(-1), 'reg_alpha': 0.05486707083399466, 'reg_lambda': 0.0014682254745165147}
2025-12-12 22:18:30,288 | INFO | Wrote expanding predictions: results/dh_ret/call-all/IBMCTINTERACTIONS/predictions_expanding.csv
2025-12-12 22:18:30,288 | INFO | Wrote steps summary: results/dh_ret/call-all/IBMCTINTERACTIONS/steps_summary.json
2025-12-12 22:18:50,102 | INFO | Variant complete (expanding monthly). Yay! :)
