2025-12-16 01:21:33,993 | INFO | === Expanding step: train_to_2023-04__test_2023-05 ===
2025-12-16 01:21:33,999 | INFO | [guardrails] transform=none
2025-12-16 01:21:34,000 | INFO | [guardrails] winsor z: lower_q=0.0050 (-1.7037), upper_q=0.9950 (16.0556)
2025-12-16 01:21:34,818 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-16 01:21:38,530 | INFO | [keep] ridge#1 score=0.01055 params={'max_iter': np.int64(10000), 'alpha': 92.28295957427436}
2025-12-16 01:21:38,545 | INFO | [keep] ridge#2 score=0.00775 params={'max_iter': np.int64(10000), 'alpha': 86.26905220714896}
2025-12-16 01:21:48,519 | INFO | [keep] lasso#1 score=0.06771 params={'max_iter': np.int64(10000), 'alpha': 0.017489966737814593}
2025-12-16 01:21:48,547 | INFO | [keep] lasso#2 score=0.06771 params={'max_iter': np.int64(10000), 'alpha': 0.014135935551752304}
2025-12-16 01:22:03,664 | INFO | [keep] elasticnet#1 score=0.06747 params={'max_iter': np.int64(10000), 'alpha': 0.020547625125911337, 'l1_ratio': 0.8134184006256638}
2025-12-16 01:22:03,795 | INFO | [keep] elasticnet#2 score=0.06746 params={'max_iter': np.int64(10000), 'alpha': 0.020304615777978822, 'l1_ratio': 0.8135386840125377}
2025-12-16 01:22:04,929 | INFO | [keep] pcr#1 score=-0.00055 params={'pca__n_components': 2, 'ridge__alpha': 0.0001}
2025-12-16 01:22:04,948 | INFO | [keep] pcr#2 score=-0.00055 params={'pca__n_components': 2, 'ridge__alpha': 0.001}
2025-12-16 01:22:05,145 | INFO | [keep] pls#1 score=0.03293 params={'n_components': 1}
2025-12-16 01:22:05,164 | INFO | [keep] pls#2 score=0.02962 params={'n_components': 4}
2025-12-16 01:22:05,164 | INFO | Training FFN: ['ffn']
2025-12-16 01:56:06,229 | INFO | [keep] ffn#1 score=0.06950 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(128), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.494548816945476, 'ffn__weight_decay': 0.009051918062311641}
2025-12-16 01:56:23,446 | INFO | [keep] ffn#2 score=0.06387 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(128), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.4119724118818937, 'ffn__weight_decay': 0.006756374881665133}
2025-12-16 01:56:23,446 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-16 01:57:18,934 | INFO | [keep] rf#1 score=0.08442 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.6, 'min_samples_leaf': 50, 'n_estimators': 200}
2025-12-16 01:57:19,189 | INFO | [keep] rf#2 score=0.08396 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.6, 'min_samples_leaf': 100, 'n_estimators': 100}
2025-12-16 01:57:32,967 | INFO | [keep] lgbm_gbdt#1 score=0.09008 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(63), 'max_depth': np.int64(6), 'min_child_samples': np.int64(100), 'n_estimators': np.int64(200), 'num_leaves': np.int64(15), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 0.16026087769806036, 'reg_lambda': 0.2054786471612724} | n_estimators(refit)=102
2025-12-16 01:57:33,080 | INFO | [keep] lgbm_gbdt#2 score=0.08887 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(127), 'max_depth': np.int64(6), 'min_child_samples': np.int64(200), 'n_estimators': np.int64(200), 'num_leaves': np.int64(15), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 0.6304117221520666, 'reg_lambda': 2.2017446885911998} | n_estimators(refit)=72
2025-12-16 01:58:02,147 | INFO | [keep] lgbm_dart#1 score=0.10252 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'drop_rate': np.float64(0.2), 'learning_rate': np.float64(0.05), 'max_bin': np.int64(63), 'max_depth': np.int64(6), 'max_drop': np.int64(10), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.01), 'min_split_gain': np.float64(0.05), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 1.007908770912927, 'reg_lambda': 0.33582746295594984}
2025-12-16 01:58:02,470 | INFO | [keep] lgbm_dart#2 score=0.10239 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'drop_rate': np.float64(0.5), 'learning_rate': np.float64(0.05), 'max_bin': np.int64(63), 'max_depth': np.int64(6), 'max_drop': np.int64(10), 'min_child_samples': np.int64(200), 'min_child_weight': np.float64(0.01), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 14.084210996912105, 'reg_lambda': 0.12056103129408201}
2025-12-16 01:58:02,470 | INFO | [pred] ridge#1: n=597 R2_OS=0.02447 mse=5.24625 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.204 std=0.463 p1=-0.606 p99=1.53
2025-12-16 01:58:02,471 | INFO | [pred] ridge#1: |err| q99=13.332  tail_n=6/597  tail_share_SSE=51.77%
2025-12-16 01:58:02,473 | INFO | [pred] ridge#1: per-day mse days=19 p50=0.933261 p90=18.7716 p99=85.7941 max=95.7224
2025-12-16 01:58:02,473 | INFO | [pred] ridge#2: n=597 R2_OS=0.02389 mse=5.24936 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.204 std=0.466 p1=-0.608 p99=1.54
2025-12-16 01:58:02,473 | INFO | [pred] ridge#2: |err| q99=13.3353  tail_n=6/597  tail_share_SSE=51.76%
2025-12-16 01:58:02,475 | INFO | [pred] ridge#2: per-day mse days=19 p50=0.934563 p90=18.7762 p99=85.8417 max=95.773
2025-12-16 01:58:02,476 | INFO | [pred] lasso#1: n=597 R2_OS=0.06429 mse=5.03211 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.263 std=0.257 p1=-0.199 p99=0.761
2025-12-16 01:58:02,476 | INFO | [pred] lasso#1: |err| q99=13.1512  tail_n=6/597  tail_share_SSE=53.11%
2025-12-16 01:58:02,478 | INFO | [pred] lasso#1: per-day mse days=19 p50=0.817464 p90=18.2286 p99=83.1854 max=92.866
2025-12-16 01:58:02,478 | INFO | [pred] lasso#2: n=597 R2_OS=0.06283 mse=5.03993 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.253 std=0.27 p1=-0.239 p99=0.783
2025-12-16 01:58:02,478 | INFO | [pred] lasso#2: |err| q99=13.1779  tail_n=6/597  tail_share_SSE=53.11%
2025-12-16 01:58:02,480 | INFO | [pred] lasso#2: per-day mse days=19 p50=0.827727 p90=18.2494 p99=83.5151 max=93.2411
2025-12-16 01:58:02,480 | INFO | [pred] elasticnet#1: n=597 R2_OS=0.06388 mse=5.0343 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.263 std=0.258 p1=-0.2 p99=0.768
2025-12-16 01:58:02,481 | INFO | [pred] elasticnet#1: |err| q99=13.1574  tail_n=6/597  tail_share_SSE=53.11%
2025-12-16 01:58:02,482 | INFO | [pred] elasticnet#1: per-day mse days=19 p50=0.818863 p90=18.2362 p99=83.2643 max=92.9546
2025-12-16 01:58:02,483 | INFO | [pred] elasticnet#2: n=597 R2_OS=0.06381 mse=5.03465 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.262 std=0.258 p1=-0.201 p99=0.77
2025-12-16 01:58:02,483 | INFO | [pred] elasticnet#2: |err| q99=13.1588  tail_n=6/597  tail_share_SSE=53.11%
2025-12-16 01:58:02,485 | INFO | [pred] elasticnet#2: per-day mse days=19 p50=0.819706 p90=18.2373 p99=83.2814 max=92.9739
2025-12-16 01:58:02,486 | INFO | [pred] pcr#1: n=597 R2_OS=-0.00746 mse=5.41798 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=-0.0335 std=0.0153 p1=-0.0591 p99=0.0117
2025-12-16 01:58:02,486 | INFO | [pred] pcr#1: |err| q99=13.6793  tail_n=6/597  tail_share_SSE=52.57%
2025-12-16 01:58:02,487 | INFO | [pred] pcr#1: per-day mse days=19 p50=0.943982 p90=20.016 p99=89.1408 max=99.7938
2025-12-16 01:58:02,488 | INFO | [pred] pcr#2: n=597 R2_OS=-0.00746 mse=5.41798 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=-0.0335 std=0.0153 p1=-0.0591 p99=0.0117
2025-12-16 01:58:02,488 | INFO | [pred] pcr#2: |err| q99=13.6793  tail_n=6/597  tail_share_SSE=52.57%
2025-12-16 01:58:02,490 | INFO | [pred] pcr#2: per-day mse days=19 p50=0.943982 p90=20.016 p99=89.1408 max=99.7938
2025-12-16 01:58:02,491 | INFO | [pred] pls#1: n=597 R2_OS=0.09285 mse=4.87848 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.733 std=0.431 p1=0.00262 p99=1.59
2025-12-16 01:58:02,491 | INFO | [pred] pls#1: |err| q99=12.1753  tail_n=6/597  tail_share_SSE=48.39%
2025-12-16 01:58:02,493 | INFO | [pred] pls#1: per-day mse days=19 p50=2.09313 p90=16.1414 p99=71.5509 max=79.5216
2025-12-16 01:58:02,493 | INFO | [pred] pls#2: n=597 R2_OS=0.10191 mse=4.8298 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.62 std=0.737 p1=-0.72 p99=2.31
2025-12-16 01:58:02,493 | INFO | [pred] pls#2: |err| q99=12.336  tail_n=6/597  tail_share_SSE=47.50%
2025-12-16 01:58:02,495 | INFO | [pred] pls#2: per-day mse days=19 p50=1.48394 p90=15.7496 p99=72.1515 max=80.117
2025-12-16 01:58:02,497 | INFO | [pred] L-En: n=597 R2_OS=0.06937 mse=5.00476 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.274 std=0.288 p1=-0.26 p99=0.906
2025-12-16 01:58:02,497 | INFO | [pred] L-En: |err| q99=13.1182  tail_n=6/597  tail_share_SSE=52.85%
2025-12-16 01:58:02,498 | INFO | [pred] L-En: per-day mse days=19 p50=0.802788 p90=18.1267 p99=82.4547 max=92.0395
2025-12-16 01:58:02,502 | INFO | [pred] ffn#1: n=597 R2_OS=-0.01005 mse=5.43189 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.885 std=0.977 p1=-0.543 p99=3.58
2025-12-16 01:58:02,502 | INFO | [pred] ffn#1: |err| q99=12.2527  tail_n=6/597  tail_share_SSE=41.86%
2025-12-16 01:58:02,504 | INFO | [pred] ffn#1: per-day mse days=19 p50=2.17405 p90=15.1096 p99=74.7636 max=82.9775
2025-12-16 01:58:02,507 | INFO | [pred] ffn#2: n=597 R2_OS=-0.01726 mse=5.47066 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.89 std=0.982 p1=-0.543 p99=3.64
2025-12-16 01:58:02,507 | INFO | [pred] ffn#2: |err| q99=12.2777  tail_n=6/597  tail_share_SSE=41.59%
2025-12-16 01:58:02,509 | INFO | [pred] ffn#2: per-day mse days=19 p50=2.27882 p90=15.2086 p99=75.1242 max=83.4104
2025-12-16 01:58:02,532 | INFO | [pred] rf#1: n=597 R2_OS=0.10544 mse=4.81081 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.563 std=0.664 p1=-0.0942 p99=1.99
2025-12-16 01:58:02,532 | INFO | [pred] rf#1: |err| q99=12.2088  tail_n=6/597  tail_share_SSE=49.72%
2025-12-16 01:58:02,534 | INFO | [pred] rf#1: per-day mse days=19 p50=1.80668 p90=15.9803 p99=72.5736 max=80.3918
2025-12-16 01:58:02,546 | INFO | [pred] rf#2: n=597 R2_OS=0.10331 mse=4.82226 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.508 std=0.589 p1=-0.0997 p99=1.77
2025-12-16 01:58:02,546 | INFO | [pred] rf#2: |err| q99=12.5224  tail_n=6/597  tail_share_SSE=51.09%
2025-12-16 01:58:02,548 | INFO | [pred] rf#2: per-day mse days=19 p50=1.14935 p90=16.41 p99=75.9995 max=84.4373
2025-12-16 01:58:02,549 | INFO | [pred] lgbm_gbdt#1: n=597 R2_OS=0.11475 mse=4.76071 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.73 std=0.902 p1=-0.11 p99=2.82
2025-12-16 01:58:02,549 | INFO | [pred] lgbm_gbdt#1: |err| q99=11.1876  tail_n=6/597  tail_share_SSE=46.24%
2025-12-16 01:58:02,551 | INFO | [pred] lgbm_gbdt#1: per-day mse days=19 p50=1.93393 p90=15.0674 p99=63.6029 max=69.5375
2025-12-16 01:58:02,552 | INFO | [pred] lgbm_gbdt#2: n=597 R2_OS=0.11498 mse=4.75947 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.623 std=0.802 p1=-0.108 p99=2.25
2025-12-16 01:58:02,552 | INFO | [pred] lgbm_gbdt#2: |err| q99=11.5931  tail_n=6/597  tail_share_SSE=48.27%
2025-12-16 01:58:02,554 | INFO | [pred] lgbm_gbdt#2: per-day mse days=19 p50=1.54427 p90=15.4337 p99=67.7889 max=74.6034
2025-12-16 01:58:02,556 | INFO | [pred] lgbm_dart#1: n=597 R2_OS=0.08952 mse=4.89639 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.796 std=1.09 p1=-0.198 p99=3.45
2025-12-16 01:58:02,556 | INFO | [pred] lgbm_dart#1: |err| q99=10.8639  tail_n=6/597  tail_share_SSE=43.84%
2025-12-16 01:58:02,557 | INFO | [pred] lgbm_dart#1: per-day mse days=19 p50=2.74682 p90=14.6825 p99=62.3067 max=67.6367
2025-12-16 01:58:02,559 | INFO | [pred] lgbm_dart#2: n=597 R2_OS=0.11324 mse=4.76887 mse0=5.37783 | y mean=0.416 std=2.28 | yhat mean=0.627 std=0.688 p1=-0.154 p99=2.16
2025-12-16 01:58:02,559 | INFO | [pred] lgbm_dart#2: |err| q99=11.8284  tail_n=6/597  tail_share_SSE=49.06%
2025-12-16 01:58:02,561 | INFO | [pred] lgbm_dart#2: per-day mse days=19 p50=1.55672 p90=15.797 p99=69.5612 max=76.8921
