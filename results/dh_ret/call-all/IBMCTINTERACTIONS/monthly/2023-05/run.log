2025-12-16 00:34:50,185 | INFO | === Expanding step: train_to_2023-04__test_2023-05 ===
2025-12-16 00:34:50,189 | INFO | [guardrails] transform=none
2025-12-16 00:34:50,189 | INFO | [guardrails] winsor z: lower_q=0.0050 (-1.76144), upper_q=0.9950 (17.3731)
2025-12-16 00:34:50,578 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-16 00:34:52,512 | INFO | [keep] ridge#1 score=0.00623 params={'max_iter': np.int64(10000), 'alpha': 92.28295957427436}
2025-12-16 00:34:52,520 | INFO | [keep] ridge#2 score=0.00212 params={'max_iter': np.int64(10000), 'alpha': 86.26905220714896}
2025-12-16 00:34:58,414 | INFO | [keep] lasso#1 score=0.07826 params={'max_iter': np.int64(10000), 'alpha': 0.03191340515246818}
2025-12-16 00:34:58,423 | INFO | [keep] lasso#2 score=0.07817 params={'max_iter': np.int64(10000), 'alpha': 0.0431171005868549}
2025-12-16 00:35:05,649 | INFO | [keep] elasticnet#1 score=0.07967 params={'max_iter': np.int64(10000), 'alpha': 0.09105944026265275, 'l1_ratio': 0.3026332820318257}
2025-12-16 00:35:05,661 | INFO | [keep] elasticnet#2 score=0.07952 params={'max_iter': np.int64(10000), 'alpha': 0.0975516477088793, 'l1_ratio': 0.3106579013897205}
2025-12-16 00:35:06,221 | INFO | [keep] pcr#1 score=0.05850 params={'pca__n_components': 6, 'ridge__alpha': 0.0001}
2025-12-16 00:35:06,232 | INFO | [keep] pcr#2 score=0.05850 params={'pca__n_components': 6, 'ridge__alpha': 0.001}
2025-12-16 00:35:06,453 | INFO | [keep] pls#1 score=0.10820 params={'n_components': 1}
2025-12-16 00:35:06,461 | INFO | [keep] pls#2 score=0.01575 params={'n_components': 2}
2025-12-16 00:35:06,461 | INFO | Training FFN: ['ffn']
2025-12-16 00:51:50,520 | INFO | [keep] ffn#1 score=0.09182 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(128), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.494548816945476, 'ffn__weight_decay': 0.009051918062311641}
2025-12-16 00:51:58,349 | INFO | [keep] ffn#2 score=0.08775 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(64), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(64), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(50), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.4731634167180391, 'ffn__weight_decay': 0.0014653571755444989}
2025-12-16 00:51:58,350 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-16 00:52:43,388 | INFO | [keep] rf#1 score=0.12906 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.6, 'min_samples_leaf': 50, 'n_estimators': 100}
2025-12-16 00:52:43,664 | INFO | [keep] rf#2 score=0.12537 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.6, 'min_samples_leaf': 50, 'n_estimators': 200}
2025-12-16 00:52:50,789 | INFO | [keep] lgbm_gbdt#1 score=0.11053 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'learning_rate': np.float64(0.1), 'max_bin': np.int64(63), 'max_depth': np.int64(6), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(50), 'num_leaves': np.int64(31), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 0.6838687356454339, 'reg_lambda': 0.1830537612851116} | n_estimators(refit)=6
2025-12-16 00:52:50,814 | INFO | [keep] lgbm_gbdt#2 score=0.10219 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'learning_rate': np.float64(0.1), 'max_bin': np.int64(63), 'max_depth': np.int64(6), 'min_child_samples': np.int64(200), 'n_estimators': np.int64(200), 'num_leaves': np.int64(15), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 2.557273434307698, 'reg_lambda': 0.15865500409725955} | n_estimators(refit)=17
2025-12-16 00:53:08,492 | INFO | [keep] lgbm_dart#1 score=0.12386 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'drop_rate': np.float64(0.3), 'learning_rate': np.float64(0.05), 'max_bin': np.int64(127), 'max_depth': np.int64(6), 'max_drop': np.int64(20), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.1), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'skip_drop': np.float64(0.3), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 0.11331543612010862, 'reg_lambda': 5.912295566997817}
2025-12-16 00:53:08,676 | INFO | [keep] lgbm_dart#2 score=0.11723 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.6), 'drop_rate': np.float64(0.2), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(127), 'max_depth': np.int64(6), 'max_drop': np.int64(10), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.01), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.8), 'verbosity': np.int64(-1), 'reg_alpha': 1.994638447276318, 'reg_lambda': 18.54898207761947}
2025-12-16 00:53:08,676 | INFO | [pred] ridge#1: n=314 R2_OS=0.08726 mse=4.08689 mse0=4.47762 | y mean=0.362 std=2.09 | yhat mean=0.574 std=0.683 p1=-0.559 p99=2.47
2025-12-16 00:53:08,676 | INFO | [pred] ridge#1: |err| q99=9.29506  tail_n=4/314  tail_share_SSE=61.64%
2025-12-16 00:53:08,678 | INFO | [pred] ridge#1: per-day mse days=19 p50=0.798039 p90=9.26481 p99=82.9199 max=97.907
2025-12-16 00:53:08,679 | INFO | [pred] ridge#2: n=314 R2_OS=0.08685 mse=4.08875 mse0=4.47762 | y mean=0.362 std=2.09 | yhat mean=0.575 std=0.689 p1=-0.565 p99=2.49
2025-12-16 00:53:08,679 | INFO | [pred] ridge#2: |err| q99=9.2807  tail_n=4/314  tail_share_SSE=61.53%
2025-12-16 00:53:08,681 | INFO | [pred] ridge#2: per-day mse days=19 p50=0.806879 p90=9.25326 p99=82.9303 max=97.9258
2025-12-16 00:53:08,681 | INFO | [pred] lasso#1: n=314 R2_OS=0.09826 mse=4.03764 mse0=4.47762 | y mean=0.362 std=2.09 | yhat mean=0.418 std=0.357 p1=-0.146 p99=1.36
2025-12-16 00:53:08,681 | INFO | [pred] lasso#1: |err| q99=10.0407  tail_n=4/314  tail_share_SSE=66.96%
2025-12-16 00:53:08,683 | INFO | [pred] lasso#1: per-day mse days=19 p50=0.540333 p90=9.72262 p99=83.7918 max=98.6556
2025-12-16 00:53:08,684 | INFO | [pred] lasso#2: n=314 R2_OS=0.08744 mse=4.08611 mse0=4.47762 | y mean=0.362 std=2.09 | yhat mean=0.368 std=0.29 p1=-0.105 p99=1.11
2025-12-16 00:53:08,684 | INFO | [pred] lasso#2: |err| q99=10.2683  tail_n=4/314  tail_share_SSE=67.78%
2025-12-16 00:53:08,685 | INFO | [pred] lasso#2: per-day mse days=19 p50=0.488117 p90=9.94882 p99=84.8873 max=99.8919
2025-12-16 00:53:08,686 | INFO | [pred] elasticnet#1: n=314 R2_OS=0.09775 mse=4.03995 mse0=4.47762 | y mean=0.362 std=2.09 | yhat mean=0.39 std=0.351 p1=-0.148 p99=1.32
2025-12-16 00:53:08,686 | INFO | [pred] elasticnet#1: |err| q99=10.0839  tail_n=4/314  tail_share_SSE=67.27%
2025-12-16 00:53:08,688 | INFO | [pred] elasticnet#1: per-day mse days=19 p50=0.495954 p90=9.7947 p99=84.1709 max=99.102
2025-12-16 00:53:08,688 | INFO | [pred] elasticnet#2: n=314 R2_OS=0.09597 mse=4.04792 mse0=4.47762 | y mean=0.362 std=2.09 | yhat mean=0.384 std=0.336 p1=-0.136 p99=1.27
2025-12-16 00:53:08,688 | INFO | [pred] elasticnet#2: |err| q99=10.1274  tail_n=4/314  tail_share_SSE=67.42%
2025-12-16 00:53:08,690 | INFO | [pred] elasticnet#2: per-day mse days=19 p50=0.49197 p90=9.82981 p99=84.284 max=99.2203
2025-12-16 00:53:08,691 | INFO | [pred] pcr#1: n=314 R2_OS=0.07582 mse=4.13813 mse0=4.47762 | y mean=0.362 std=2.09 | yhat mean=0.291 std=0.217 p1=-0.101 p99=0.728
2025-12-16 00:53:08,691 | INFO | [pred] pcr#1: |err| q99=10.6556  tail_n=4/314  tail_share_SSE=69.01%
2025-12-16 00:53:08,692 | INFO | [pred] pcr#1: per-day mse days=19 p50=0.61004 p90=10.1166 p99=85.807 max=100.82
2025-12-16 00:53:08,693 | INFO | [pred] pcr#2: n=314 R2_OS=0.07582 mse=4.13813 mse0=4.47762 | y mean=0.362 std=2.09 | yhat mean=0.291 std=0.217 p1=-0.101 p99=0.728
2025-12-16 00:53:08,693 | INFO | [pred] pcr#2: |err| q99=10.6556  tail_n=4/314  tail_share_SSE=69.01%
2025-12-16 00:53:08,695 | INFO | [pred] pcr#2: per-day mse days=19 p50=0.61004 p90=10.1166 p99=85.807 max=100.82
2025-12-16 00:53:08,695 | INFO | [pred] pls#1: n=314 R2_OS=0.07711 mse=4.13234 mse0=4.47762 | y mean=0.362 std=2.09 | yhat mean=0.844 std=0.63 p1=-0.322 p99=2.15
2025-12-16 00:53:08,696 | INFO | [pred] pls#1: |err| q99=9.08529  tail_n=4/314  tail_share_SSE=57.39%
2025-12-16 00:53:08,697 | INFO | [pred] pls#1: per-day mse days=19 p50=1.43735 p90=8.52579 p99=73.9123 max=86.8902
2025-12-16 00:53:08,698 | INFO | [pred] pls#2: n=314 R2_OS=0.11341 mse=3.96983 mse0=4.47762 | y mean=0.362 std=2.09 | yhat mean=0.525 std=0.923 p1=-1.16 p99=2.56
2025-12-16 00:53:08,698 | INFO | [pred] pls#2: |err| q99=8.6469  tail_n=4/314  tail_share_SSE=58.38%
2025-12-16 00:53:08,699 | INFO | [pred] pls#2: per-day mse days=19 p50=1.23183 p90=7.97746 p99=75.1336 max=88.5931
2025-12-16 00:53:08,701 | INFO | [pred] L-En: n=314 R2_OS=0.11269 mse=3.97303 mse0=4.47762 | y mean=0.362 std=2.09 | yhat mean=0.466 std=0.441 p1=-0.22 p99=1.55
2025-12-16 00:53:08,701 | INFO | [pred] L-En: |err| q99=9.81393  tail_n=4/314  tail_share_SSE=66.24%
2025-12-16 00:53:08,703 | INFO | [pred] L-En: per-day mse days=19 p50=0.623723 p90=9.30797 p99=82.2155 max=96.8306
2025-12-16 00:53:08,705 | INFO | [pred] ffn#1: n=314 R2_OS=0.03826 mse=4.30632 mse0=4.47762 | y mean=0.362 std=2.09 | yhat mean=0.919 std=1 p1=-0.513 p99=3.5
2025-12-16 00:53:08,706 | INFO | [pred] ffn#1: |err| q99=7.6735  tail_n=4/314  tail_share_SSE=50.25%
2025-12-16 00:53:08,707 | INFO | [pred] ffn#1: per-day mse days=19 p50=1.86092 p90=7.73526 p99=74.4264 max=87.8138
2025-12-16 00:53:08,710 | INFO | [pred] ffn#2: n=314 R2_OS=0.09673 mse=4.04452 mse0=4.47762 | y mean=0.362 std=2.09 | yhat mean=0.698 std=0.834 p1=-0.534 p99=2.83
2025-12-16 00:53:08,710 | INFO | [pred] ffn#2: |err| q99=8.40216  tail_n=4/314  tail_share_SSE=57.80%
2025-12-16 00:53:08,712 | INFO | [pred] ffn#2: per-day mse days=19 p50=1.3431 p90=7.96286 p99=77.4152 max=91.3878
2025-12-16 00:53:08,724 | INFO | [pred] rf#1: n=314 R2_OS=0.01898 mse=4.39263 mse0=4.47762 | y mean=0.362 std=2.09 | yhat mean=0.898 std=0.928 p1=-0.135 p99=2.96
2025-12-16 00:53:08,724 | INFO | [pred] rf#1: |err| q99=8.81605  tail_n=4/314  tail_share_SSE=52.60%
2025-12-16 00:53:08,726 | INFO | [pred] rf#1: per-day mse days=19 p50=1.99431 p90=8.09789 p99=75.4807 max=88.8583
2025-12-16 00:53:08,748 | INFO | [pred] rf#2: n=314 R2_OS=0.03737 mse=4.31031 mse0=4.47762 | y mean=0.362 std=2.09 | yhat mean=0.846 std=0.909 p1=-0.113 p99=2.77
2025-12-16 00:53:08,749 | INFO | [pred] rf#2: |err| q99=8.8973  tail_n=4/314  tail_share_SSE=53.78%
2025-12-16 00:53:08,751 | INFO | [pred] rf#2: per-day mse days=19 p50=1.75165 p90=8.09454 p99=74.2202 max=87.3131
2025-12-16 00:53:08,751 | INFO | [pred] lgbm_gbdt#1: n=314 R2_OS=0.11946 mse=3.94271 mse0=4.47762 | y mean=0.362 std=2.09 | yhat mean=0.388 std=0.454 p1=-0.0643 p99=1.59
2025-12-16 00:53:08,752 | INFO | [pred] lgbm_gbdt#1: |err| q99=10.3511  tail_n=4/314  tail_share_SSE=66.80%
2025-12-16 00:53:08,753 | INFO | [pred] lgbm_gbdt#1: per-day mse days=19 p50=0.685577 p90=9.51668 p99=75.2053 max=88.0444
2025-12-16 00:53:08,754 | INFO | [pred] lgbm_gbdt#2: n=314 R2_OS=0.10711 mse=3.99803 mse0=4.47762 | y mean=0.362 std=2.09 | yhat mean=0.502 std=0.669 p1=-0.19 p99=2.26
2025-12-16 00:53:08,754 | INFO | [pred] lgbm_gbdt#2: |err| q99=9.57652  tail_n=4/314  tail_share_SSE=63.71%
2025-12-16 00:53:08,756 | INFO | [pred] lgbm_gbdt#2: per-day mse days=19 p50=0.733938 p90=9.1818 p99=81.6568 max=96.2722
2025-12-16 00:53:08,757 | INFO | [pred] lgbm_dart#1: n=314 R2_OS=0.09665 mse=4.04486 mse0=4.47762 | y mean=0.362 std=2.09 | yhat mean=0.617 std=0.637 p1=-0.166 p99=2.45
2025-12-16 00:53:08,757 | INFO | [pred] lgbm_dart#1: |err| q99=9.55419  tail_n=4/314  tail_share_SSE=61.13%
2025-12-16 00:53:08,759 | INFO | [pred] lgbm_dart#1: per-day mse days=19 p50=1.07606 p90=9.26633 p99=74.9399 max=88.0253
2025-12-16 00:53:08,760 | INFO | [pred] lgbm_dart#2: n=314 R2_OS=0.10626 mse=4.00182 mse0=4.47762 | y mean=0.362 std=2.09 | yhat mean=0.414 std=0.469 p1=-0.126 p99=1.61
2025-12-16 00:53:08,760 | INFO | [pred] lgbm_dart#2: |err| q99=10.1198  tail_n=4/314  tail_share_SSE=66.67%
2025-12-16 00:53:08,762 | INFO | [pred] lgbm_dart#2: per-day mse days=19 p50=0.656178 p90=9.74182 p99=79.9638 max=93.9526
