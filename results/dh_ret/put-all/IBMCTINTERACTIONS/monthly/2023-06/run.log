2025-12-16 01:05:25,341 | INFO | === Expanding step: train_to_2023-05__test_2023-06 ===
2025-12-16 01:05:25,346 | INFO | [guardrails] transform=none
2025-12-16 01:05:25,346 | INFO | [guardrails] winsor z: lower_q=0.0050 (-1.66977), upper_q=0.9950 (13.7347)
2025-12-16 01:05:25,859 | INFO | Training linear: ['ridge', 'lasso', 'elasticnet', 'pcr', 'pls']
2025-12-16 01:05:28,296 | INFO | [keep] ridge#1 score=-0.00231 params={'max_iter': np.int64(10000), 'alpha': 92.28295957427436}
2025-12-16 01:05:28,307 | INFO | [keep] ridge#2 score=-0.00353 params={'max_iter': np.int64(10000), 'alpha': 86.26905220714896}
2025-12-16 01:05:36,419 | INFO | [keep] lasso#1 score=0.06243 params={'max_iter': np.int64(10000), 'alpha': 0.025465581928924362}
2025-12-16 01:05:36,436 | INFO | [keep] lasso#2 score=0.06207 params={'max_iter': np.int64(10000), 'alpha': 0.02505718725747767}
2025-12-16 01:05:46,518 | INFO | [keep] elasticnet#1 score=0.06592 params={'max_iter': np.int64(10000), 'alpha': 0.16511660035531794, 'l1_ratio': 0.13135023380345656}
2025-12-16 01:05:46,537 | INFO | [keep] elasticnet#2 score=0.06399 params={'max_iter': np.int64(10000), 'alpha': 0.09105944026265275, 'l1_ratio': 0.3026332820318257}
2025-12-16 01:05:47,229 | INFO | [keep] pcr#1 score=0.06893 params={'pca__n_components': 5, 'ridge__alpha': 0.0001}
2025-12-16 01:05:47,242 | INFO | [keep] pcr#2 score=0.06893 params={'pca__n_components': 5, 'ridge__alpha': 0.001}
2025-12-16 01:05:47,374 | INFO | [keep] pls#1 score=0.07569 params={'n_components': 1}
2025-12-16 01:05:47,384 | INFO | [keep] pls#2 score=0.06313 params={'n_components': 2}
2025-12-16 01:05:47,384 | INFO | Training FFN: ['ffn']
2025-12-16 01:27:48,015 | INFO | [keep] ffn#1 score=0.09964 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(64), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(32), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.49651215141776783, 'ffn__weight_decay': 0.0015998881492631496}
2025-12-16 01:28:07,909 | INFO | [keep] ffn#2 score=0.09607 params={'ffn__activation': np.str_('relu'), 'ffn__batch_size': np.int64(64), 'ffn__device': np.str_('auto'), 'ffn__hidden_width': np.int64(32), 'ffn__huber_delta': np.float64(1.0), 'ffn__learning_rate': np.float64(0.0001), 'ffn__loss': np.str_('mse'), 'ffn__max_epochs': np.int64(100), 'ffn__n_hidden_layers': np.int64(1), 'ffn__patience': np.int64(10), 'ffn__seed': np.int64(0), 'ffn__val_split': np.float64(0.1), 'ffn__dropout': 0.4311742245508329, 'ffn__weight_decay': 0.0019674028256453594}
2025-12-16 01:28:07,909 | INFO | Training trees: ['rf', 'lgbm_gbdt', 'lgbm_dart']
2025-12-16 01:28:55,328 | INFO | [keep] rf#1 score=0.12648 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.8, 'min_samples_leaf': 20, 'n_estimators': 100}
2025-12-16 01:28:55,532 | INFO | [keep] rf#2 score=0.12646 params={'bootstrap': True, 'max_depth': 8, 'max_features': 'sqrt', 'max_samples': 0.6, 'min_samples_leaf': 20, 'n_estimators': 100}
2025-12-16 01:29:06,691 | INFO | [keep] lgbm_gbdt#1 score=0.13666 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(63), 'max_depth': np.int64(6), 'min_child_samples': np.int64(50), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 1.2753898599202926, 'reg_lambda': 0.213737596049905} | n_estimators(refit)=79
2025-12-16 01:29:06,732 | INFO | [keep] lgbm_gbdt#2 score=0.13383 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'learning_rate': np.float64(0.1), 'max_bin': np.int64(127), 'max_depth': np.int64(6), 'min_child_samples': np.int64(100), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 6.637246930843269, 'reg_lambda': 5.71459224805273} | n_estimators(refit)=23
2025-12-16 01:29:32,137 | INFO | [keep] lgbm_dart#1 score=0.13014 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'drop_rate': np.float64(0.5), 'learning_rate': np.float64(0.05), 'max_bin': np.int64(127), 'max_depth': np.int64(6), 'max_drop': np.int64(20), 'min_child_samples': np.int64(50), 'min_child_weight': np.float64(0.01), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(200), 'num_leaves': np.int64(15), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 0.8301335256974502, 'reg_lambda': 92.5224254754638}
2025-12-16 01:29:32,410 | INFO | [keep] lgbm_dart#2 score=0.12987 params={'bagging_freq': np.int64(1), 'colsample_bytree': np.float64(0.8), 'drop_rate': np.float64(0.2), 'learning_rate': np.float64(0.02), 'max_bin': np.int64(63), 'max_depth': np.int64(6), 'max_drop': np.int64(10), 'min_child_samples': np.int64(100), 'min_child_weight': np.float64(0.01), 'min_split_gain': np.float64(0.1), 'n_estimators': np.int64(200), 'num_leaves': np.int64(31), 'skip_drop': np.float64(0.5), 'subsample': np.float64(0.6), 'verbosity': np.int64(-1), 'reg_alpha': 5.2520858151667795, 'reg_lambda': 2.372669804709427}
2025-12-16 01:29:32,410 | INFO | [pred] ridge#1: n=253 R2_OS=0.10191 mse=8.75243 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=-0.0986 std=0.522 p1=-0.882 p99=1.37
2025-12-16 01:29:32,411 | INFO | [pred] ridge#1: |err| q99=16.6899  tail_n=3/253  tail_share_SSE=48.48%
2025-12-16 01:29:32,413 | INFO | [pred] ridge#1: per-day mse days=19 p50=0.56085 p90=25.3 p99=56.8907 max=63.1537
2025-12-16 01:29:32,413 | INFO | [pred] ridge#2: n=253 R2_OS=0.10332 mse=8.73872 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=-0.0965 std=0.529 p1=-0.885 p99=1.4
2025-12-16 01:29:32,413 | INFO | [pred] ridge#2: |err| q99=16.6836  tail_n=3/253  tail_share_SSE=48.49%
2025-12-16 01:29:32,415 | INFO | [pred] ridge#2: per-day mse days=19 p50=0.562726 p90=25.2856 p99=56.8459 max=63.1059
2025-12-16 01:29:32,416 | INFO | [pred] lasso#1: n=253 R2_OS=0.08780 mse=8.88998 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.226 std=0.254 p1=-0.219 p99=0.898
2025-12-16 01:29:32,416 | INFO | [pred] lasso#1: |err| q99=16.6481  tail_n=3/253  tail_share_SSE=48.94%
2025-12-16 01:29:32,417 | INFO | [pred] lasso#1: per-day mse days=19 p50=0.606575 p90=24.1867 p99=57.6252 max=64.2231
2025-12-16 01:29:32,418 | INFO | [pred] lasso#2: n=253 R2_OS=0.08809 mse=8.8872 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.226 std=0.256 p1=-0.223 p99=0.899
2025-12-16 01:29:32,418 | INFO | [pred] lasso#2: |err| q99=16.6482  tail_n=3/253  tail_share_SSE=48.94%
2025-12-16 01:29:32,420 | INFO | [pred] lasso#2: per-day mse days=19 p50=0.603934 p90=24.1771 p99=57.6022 max=64.1954
2025-12-16 01:29:32,420 | INFO | [pred] elasticnet#1: n=253 R2_OS=0.08868 mse=8.88145 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.227 std=0.267 p1=-0.236 p99=0.888
2025-12-16 01:29:32,420 | INFO | [pred] elasticnet#1: |err| q99=16.6515  tail_n=3/253  tail_share_SSE=48.92%
2025-12-16 01:29:32,422 | INFO | [pred] elasticnet#1: per-day mse days=19 p50=0.663082 p90=24.3599 p99=57.787 max=64.3815
2025-12-16 01:29:32,422 | INFO | [pred] elasticnet#2: n=253 R2_OS=0.08553 mse=8.9121 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.235 std=0.246 p1=-0.193 p99=0.863
2025-12-16 01:29:32,422 | INFO | [pred] elasticnet#2: |err| q99=16.6507  tail_n=3/253  tail_share_SSE=48.93%
2025-12-16 01:29:32,424 | INFO | [pred] elasticnet#2: per-day mse days=19 p50=0.664439 p90=24.3693 p99=57.9523 max=64.586
2025-12-16 01:29:32,425 | INFO | [pred] pcr#1: n=253 R2_OS=0.08180 mse=8.94845 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.231 std=0.247 p1=-0.213 p99=0.895
2025-12-16 01:29:32,425 | INFO | [pred] pcr#1: |err| q99=16.6901  tail_n=3/253  tail_share_SSE=48.94%
2025-12-16 01:29:32,426 | INFO | [pred] pcr#1: per-day mse days=19 p50=0.703335 p90=24.8619 p99=58.4905 max=65.0802
2025-12-16 01:29:32,427 | INFO | [pred] pcr#2: n=253 R2_OS=0.08180 mse=8.94845 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.231 std=0.247 p1=-0.213 p99=0.895
2025-12-16 01:29:32,427 | INFO | [pred] pcr#2: |err| q99=16.6901  tail_n=3/253  tail_share_SSE=48.94%
2025-12-16 01:29:32,429 | INFO | [pred] pcr#2: per-day mse days=19 p50=0.703335 p90=24.8619 p99=58.4905 max=65.0802
2025-12-16 01:29:32,429 | INFO | [pred] pls#1: n=253 R2_OS=0.15759 mse=8.20986 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.628 std=0.565 p1=-0.369 p99=2.08
2025-12-16 01:29:32,429 | INFO | [pred] pls#1: |err| q99=15.8379  tail_n=3/253  tail_share_SSE=49.36%
2025-12-16 01:29:32,431 | INFO | [pred] pls#1: per-day mse days=19 p50=1.6129 p90=21.7856 p99=54.0661 max=60.3244
2025-12-16 01:29:32,432 | INFO | [pred] pls#2: n=253 R2_OS=0.16271 mse=8.15995 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.542 std=0.647 p1=-0.627 p99=2.17
2025-12-16 01:29:32,432 | INFO | [pred] pls#2: |err| q99=15.8037  tail_n=3/253  tail_share_SSE=49.74%
2025-12-16 01:29:32,433 | INFO | [pred] pls#2: per-day mse days=19 p50=1.41998 p90=22.1595 p99=54.6583 max=61.0956
2025-12-16 01:29:32,435 | INFO | [pred] L-En: n=253 R2_OS=0.11200 mse=8.6541 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.235 std=0.368 p1=-0.386 p99=1.19
2025-12-16 01:29:32,435 | INFO | [pred] L-En: |err| q99=16.4994  tail_n=3/253  tail_share_SSE=49.39%
2025-12-16 01:29:32,436 | INFO | [pred] L-En: per-day mse days=19 p50=0.794056 p90=24.0755 p99=56.9997 max=63.4859
2025-12-16 01:29:32,439 | INFO | [pred] ffn#1: n=253 R2_OS=0.19071 mse=7.88702 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.236 std=0.761 p1=-0.669 p99=2.53
2025-12-16 01:29:32,439 | INFO | [pred] ffn#1: |err| q99=16.1548  tail_n=3/253  tail_share_SSE=49.81%
2025-12-16 01:29:32,441 | INFO | [pred] ffn#1: per-day mse days=19 p50=0.839664 p90=22.3334 p99=53.6733 max=59.8984
2025-12-16 01:29:32,443 | INFO | [pred] ffn#2: n=253 R2_OS=0.19204 mse=7.87409 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.223 std=0.776 p1=-0.722 p99=2.57
2025-12-16 01:29:32,443 | INFO | [pred] ffn#2: |err| q99=16.1129  tail_n=3/253  tail_share_SSE=49.74%
2025-12-16 01:29:32,445 | INFO | [pred] ffn#2: per-day mse days=19 p50=0.860775 p90=22.2911 p99=53.5204 max=59.7385
2025-12-16 01:29:32,457 | INFO | [pred] rf#1: n=253 R2_OS=0.20581 mse=7.73991 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.599 std=0.784 p1=-0.155 p99=2.72
2025-12-16 01:29:32,458 | INFO | [pred] rf#1: |err| q99=15.535  tail_n=3/253  tail_share_SSE=47.40%
2025-12-16 01:29:32,459 | INFO | [pred] rf#1: per-day mse days=19 p50=1.25027 p90=20.4054 p99=49.2935 max=55.4151
2025-12-16 01:29:32,472 | INFO | [pred] rf#2: n=253 R2_OS=0.19850 mse=7.81118 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.595 std=0.764 p1=-0.177 p99=2.7
2025-12-16 01:29:32,472 | INFO | [pred] rf#2: |err| q99=15.6545  tail_n=3/253  tail_share_SSE=48.92%
2025-12-16 01:29:32,474 | INFO | [pred] rf#2: per-day mse days=19 p50=1.42801 p90=20.8402 p99=50.8778 max=57.2504
2025-12-16 01:29:32,475 | INFO | [pred] lgbm_gbdt#1: n=253 R2_OS=0.21626 mse=7.63805 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.593 std=0.855 p1=-0.229 p99=2.99
2025-12-16 01:29:32,475 | INFO | [pred] lgbm_gbdt#1: |err| q99=15.1159  tail_n=3/253  tail_share_SSE=48.41%
2025-12-16 01:29:32,477 | INFO | [pred] lgbm_gbdt#1: per-day mse days=19 p50=1.38717 p90=21.2184 p99=49.5118 max=55.1608
2025-12-16 01:29:32,477 | INFO | [pred] lgbm_gbdt#2: n=253 R2_OS=0.18460 mse=7.94658 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.481 std=0.705 p1=-0.312 p99=2.03
2025-12-16 01:29:32,478 | INFO | [pred] lgbm_gbdt#2: |err| q99=15.3655  tail_n=3/253  tail_share_SSE=48.31%
2025-12-16 01:29:32,479 | INFO | [pred] lgbm_gbdt#2: per-day mse days=19 p50=1.42482 p90=20.0368 p99=51.1977 max=57.0339
2025-12-16 01:29:32,480 | INFO | [pred] lgbm_dart#1: n=253 R2_OS=0.15388 mse=8.246 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.345 std=0.502 p1=-0.287 p99=1.67
2025-12-16 01:29:32,481 | INFO | [pred] lgbm_dart#1: |err| q99=15.8315  tail_n=3/253  tail_share_SSE=48.10%
2025-12-16 01:29:32,482 | INFO | [pred] lgbm_dart#1: per-day mse days=19 p50=0.826744 p90=21.0938 p99=52.3392 max=58.0576
2025-12-16 01:29:32,483 | INFO | [pred] lgbm_dart#2: n=253 R2_OS=0.16644 mse=8.12354 mse0=9.74565 | y mean=0.73 std=3.04 | yhat mean=0.391 std=0.546 p1=-0.205 p99=1.78
2025-12-16 01:29:32,483 | INFO | [pred] lgbm_dart#2: |err| q99=15.7967  tail_n=3/253  tail_share_SSE=49.33%
2025-12-16 01:29:32,485 | INFO | [pred] lgbm_dart#2: per-day mse days=19 p50=1.1264 p90=21.835 p99=52.5266 max=58.8105
